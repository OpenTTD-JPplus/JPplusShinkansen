# 1 "JPplusShinkansen.pnml"
/*---HEADER--*/

//Define the GRF
# 1 "src/header.pnml" 1
grf {
	grfid: 					"KR03";
	name: 					string(STR_GRF_NAME);
	desc:					string(STR_GRF_DESC);
	version:				65;	// v0.6.5
	min_compatible_version: 65;	// v0.6.5
		// Hide logo
		param 3 {
        	param_hide_logo {
				type: bool;
				name: string(STR_PARAM_HIDE_LOGO);
				desc: string(STR_PARAM_HIDE_LOGO);
				bit: 0;
				def_value: 1;
            }
        }
		//pax capacity
		param 2 {
				param_basecapacity {
						type: int;
						name: string(STR_PARAM_NAME_BASECAPACITY);
						desc: string(STR_PARAM_DESC_BASECAPACITY);
						min_value: 0;
						max_value: 3;
						def_value: 0;
						names: {
												0: string(STR_PARAM_REAL);
												1: string(STR_PARAM_1_25);
												2: string(STR_PARAM_1_50);
												3: string(STR_PARAM_DOUBLE);
						};
				}
		}
		// Doctor Yellow Usage
		param 8 {
				param_dryellow {
						type: int;
						name: string(STR_PARAM_NAME_DRYELLOW);
						desc: string(STR_PARAM_DESC_DRYELLOW);
						min_value: 0;
						max_value: 2;
						def_value: 0;
						names: {
												0: string(STR_PARAM_GIMMICK);
												1: string(STR_PARAM_MAIL);
												2: string(STR_PARAM_PASSENGERS);
						};
				}
		}
		//basecosts
		param 0 {
				param_basecostbuy {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODBUY);
						desc: string(STR_PARAM_DESC_BASECOSTMODBUY);
						min_value: 0;
						max_value: 2;
						def_value: 1;
						names: {
												0: string(STR_PARAM_LOW);
												1: string(STR_PARAM_NORMAL);
												2: string(STR_PARAM_HIGH);
						};
				}
		}
		//runningcosts
		param 1 {
				param_basecostrun {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODRUN);
						desc: string(STR_PARAM_DESC_BASECOSTMODRUN);
						min_value: 0;
						max_value: 4;
						def_value: 2;
						names: {
												0: string(STR_PARAM_VLOW);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_NORMAL);
												3: string(STR_PARAM_HIGH);
												4: string(STR_PARAM_VHIGH);
						};
				}
		}
		//cargo decay
		param 5 {
			 param_cargodecay {
						type: int;
						name: string(STR_PARAM_NAME_DECAY);
						desc: string(STR_PARAM_DESC_DECAY);
						min_value: 0;
						max_value: 2;
						def_value: 0;
						names: {
												0: string(STR_PARAM_NORMAL);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_VLOW);
				};
			 
			}	
		}
}

// Cargo table
cargotable {
	PASS,
	MAIL
}
# 1 "JPplusShinkansen.pnml" 4

// Templates
# 1 "src/template.pnml" 1
// Begin template

/* Dummy Template */

template template_dummy (x, y) {
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
}

/* Purchase Templates */

template template_purchase (x, y) {
		[]
	 	[]
	 	[]
	 	[]
	 	[]
	 	[]
    	[x, y, 75, 15, -28, -10]
		[]
}

/* EMU Templates */

template tmpl_10_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,		8,		30,		-3,		    -14]
    [ x+17,		y,		26,		26,		-18,		-15]
    [ x+44,		y,		40,		16,		-28,		-12]
    [ x+85, 	y,		26,		26,		-12,		-18]
    [ x+120,	y,		8,		30,		-3,			-20]
    [ x+137,	y,		26,		26,		-14,		-17]
    [ x+164,	y,		40,		16,		-20,		-12]
    [ x+205,	y,		26,		26,		-10,		-17]
}

template tmpl_10_cab_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y,		8,		30,		-3,		    -14]
    [ x+137,	y,		26,		26,		-18,		-15]
    [ x+164,	y,		40,		16,		-28,		-12]
    [ x+205, 	y,		26,		26,		-12,		-18]
    [ x,	    y,		8,		30,		-3,			-18]
    [ x+17,	    y,		26,		26,		-14,		-17]
    [ x+44,	    y,		40,		16,		-20,		-12]
    [ x+85,	    y,		26,		26,		-10,		-17]
}

template tmpl_10_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y,		8,		30,		-3,			-14]
    [ x+137,	y,		26,		26,		-18,		-15]
    [ x+164,	y,		40,		16,		-28,		-12]
    [ x+205, 	y,		26,		26,		-12,		-18]
    [ x,	    y,		8,		30,		-3,			-20]
    [ x+17,	    y,		26,		26,		-14,		-17]
    [ x+44,	    y,		40,		16,		-20,		-12]
    [ x+85,	    y,		26,		26,		-8,		    -16]
}

template tmpl_10_cab_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,	    y,		8,		30,		-3,			-14]
    [ x+17,	    y,		26,		26,		-18,		-15]
    [ x+44,	    y,		40,		16,		-28,		-12]
    [ x+85, 	y,		26,		26,		-12,		-18]
    [ x+120,	y,		8,		30,		-3,			-20]
    [ x+137,	y,		26,		26,		-14,		-17]
    [ x+164,	y,		40,		16,		-20,		-12]
    [ x+205,	y,		26,		26,		-8,		    -16]
}

// END PARTS

template tmpl_frt_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,	    8,		12,		-3,			-12]
    [ x+43,		y+27,	8,		14,		-2,		    -11]
    [ x+80,		y,		4,		16,		4,		    -12]
    [ x+111, 	y+35,	8,		14,		4,		    -7]
    [ x+120,	y+18,	8,		12,		-3,			-4]
    [ x+129,	y+35,	8,		14,		-12,		-6]
    [ x+164,	y,		4,		16,		-16,		-12]
    [ x+197,	y+27,	8,		14,		-6,		    -12]
}

template tmpl_cab_frt_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y+18,   8,		12,		-3,			-12]
    [ x+129,	y+35,	8,		14,	    -2,		    -11]
    [ x+164,	y,		4,		16,		4,		    -12]
    [ x+197, 	y+27,	8,		14,		4,		    -7]
    [ x,	    y,	    8,		12,		-3,			-4]
    [ x+43,	    y+27,	8,		14,		-12,		-6]
    [ x+80,	    y,		4,		16,		-16,		-12]
    [ x+111,	y+35,	8,		14,		-6,		    -12]
}

template tmpl_mid_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y+2,	8,		26,		-3,			-12]
    [ x+19,		y+27,	22,		22,		-16,		-12]
    [ x+48,		y,		32,		16,		-24,		-12]
    [ x+87, 	y+27,	22,		22,		-10,		-15]
    [ x+120,	y+2,	8,		26,		-3,			-18]
    [ x+139,	y+27,	22,		22,		-12,		-14]
    [ x+168,	y,		32,		16,		-16,		-12]
    [ x+207,	y+27,	22,		22,		-6,		    -13]
}

template tmpl_cab_mid_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y+2,	8,		26,		-3,			-12]
    [ x+139,	y+27,	22,		22,		-16,		-12]
    [ x+168,	y,		32,		16,		-24,		-12]
    [ x+207, 	y+27,	22,		22,		-10,		-15]
    [ x,	    y+2,	8,		26,		-3,			-18]
    [ x+19,	    y+27,	22,		22,		-12,		-14]
    [ x+48,	    y,		32,		16,		-16,		-12]
    [ x+87,	    y+27,	22,		22,		-6,		    -13]
}

template tmpl_bck_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y+18,	8,		12,		-3,			-12]
    [ x+9,		y+35,	8,		14,		-2,		    -11]
    [ x+44,		y,		4,		16,		4,		    -12]
    [ x+77, 	y+27,	8,		14,		4,		    -7]
    [ x+120,	y,		8,		12,		-3,			-4]
    [ x+163,	y+27,	8,		14,		-12,		-6]
    [ x+200,	y,		4,		16,		-16,		-12]
    [ x+231,	y+35,	8,		14,		-6,	        -12]
}

template tmpl_cab_bck_std(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y,	    8,		12,		-3,			-12]
    [ x+163,	y+27,	8,		14,		-2,		    -11]
    [ x+200,	y,		4,		16,		4,		    -12]
    [ x+231, 	y+35,	8,		14,		4,		    -7]
    [ x,	    y+18,	8,		12,		-3,			-4]
    [ x+9,	    y+35,	8,		14,		-12,		-6]
    [ x+44,	    y,		4,		16,		-16,		-12]
    [ x+77,     y+27,	8,		14,		-6,		    -12]
}

template tmpl_frt_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y+18,	8,		12,		-3,			-12]
    [ x+129,	y+35,	8,		14,		-2,		    -11]
    [ x+164,	y,		4,		16,		4,		    -12]
    [ x+197,	y+27,	8,		14,		4,		    -7]
    [ x,		y,	    8,		12,		-3,			-4]
    [ x+43,		y+27,	8,		14,		-12,		-6]
    [ x+80,		y,		4,		16,		-16,		-12]
    [ x+111, 	y+35,	8,		14,		-6,		    -12]
}

template tmpl_cab_frt_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,	    y,	    8,		12,		-3,			-12]
    [ x+43,	    y+27,	8,		14,		-2,		    -11]
    [ x+80,	    y,		4,		16,		4,		    -12]
    [ x+111,	y+35,	8,		14,		4,		    -7]
    [ x+120,	y+18,	8,		12,		-3,			-4]
    [ x+129,	y+35,	8,		14,		-12,		-6]
    [ x+164,	y,		4,		16,		-16,		-12]
    [ x+197, 	y+27,	8,		14,		-6,		    -12]
}

template tmpl_mid_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y+2,	8,		26,		-3,			-12]
    [ x+139,	y+27,	22,		22,		-16,		-12]
    [ x+168,	y,		32,		16,		-24,		-12]
    [ x+207,	y+27,	22,		22,		-10,		-15]
    [ x,		y+2,	8,		26,		-3,			-18]
    [ x+19,		y+27,	22,		22,		-12,		-14]
    [ x+48,		y,		32,		16,		-16,		-12]
    [ x+87, 	y+27,	22,		22,		-6,		    -13]
}

template tmpl_cab_mid_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,	    y+2,	8,		26,		-3,			-12]
    [ x+19,	    y+27,	22,		22,		-16,		-12]
    [ x+48,	    y,		32,		16,		-24,		-12]
    [ x+87,	    y+27,	22,		22,		-10,		-15]
    [ x+120,	y+2,	8,		26,		-3,			-18]
    [ x+139,	y+27,	22,		22,		-12,		-14]
    [ x+168,	y,		32,		16,		-16,		-12]
    [ x+207, 	y+27,	22,		22,		-6,		    -13]
}

template tmpl_bck_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+120,	y,		8,		12,		-3,			-12]
    [ x+163,	y+27,	8,		14,		-2,		    -11]
    [ x+200,	y,		4,		16,		4,		    -12]
    [ x+231,	y+35,	8,		14,		4,		    -7]
    [ x,		y+18,	8,		12,		-3,			-4]
    [ x+9,		y+35,	8,		14,		-12,		-6]
    [ x+44,		y,		4,		16,		-16,		-12]
    [ x+77, 	y+27,	8,		14,		-6,		    -12]
}

template tmpl_cab_bck_rev(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,	    y+18,	8,		12,		-3,			-12]
    [ x+9,	    y+35,	8,		14,		-2,		    -11]
    [ x+44,	    y,		4,		16,		4,		    -12]
    [ x+77,	    y+27,	8,		14,		4,		    -7]
    [ x+120,	y,	    8,		12,		-3,			-4]
    [ x+163,	y+27,	8,		14,		-12,		-6]
    [ x+200,	y,		4,		16,		-16,		-12]
    [ x+231, 	y+35,	8,		14,		-6,		    -12]
}
# 1 "JPplusShinkansen.pnml" 4

//Helpers
# 1 "src/basecosts.pnml" 1
basecost {
	PR_BUILD_VEHICLE_TRAIN : 	param_basecostbuy -1;
	PR_BUILD_VEHICLE_WAGON: 	param_basecostbuy +3;
	PR_RUNNING_TRAIN_STEAM: 	param_basecostrun +1;
	PR_RUNNING_TRAIN_DIESEL:	param_basecostrun +1;
	PR_RUNNING_TRAIN_ELECTRIC:	param_basecostrun +1;
}
# 1 "JPplusShinkansen.pnml" 4
//#include "src/tracks.pnml"
# 1 "src/railtypetable.pnml" 1

// https://newgrf-specs.tt-wiki.net/wiki/TracktypeLabels

railtypetable {
	RAIL,
	ELRL,
	SHINKANSEN: [SGAA, SAAE, ELRL],
	MINI_SHINKANSEN: [SGAA, SAAE, ELRL],
	SC_MAGLEV: [LCAI, LCAE, MGLV],
}
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/functions.pnml" 1

switch (FEAT_TRAINS, PARENT, func_is_reversed, vehicle_is_reversed) {return;}

switch (FEAT_TRAINS, PARENT, NumberCarsInConsist, num_vehs_in_consist / 3) {return;}

switch (FEAT_TRAINS, SELF, RunningCostFactor, current_speed) {
        0: return 1/10 ;        	// Stopped
        1..15: return 1/4 ;        	// Moving below ~33.5 mph
        return 1; 				    // Track speed
    }

switch (FEAT_TRAINS, SELF, CapacityFactor, param_basecapacity) {
        1: return 5/4;       		// 1.25x Real World Capacity
        2: return 3/2;       		// 1.5x Real World Capacity
        3: return 2;                // 2x Real World Capacity 
        return 1;          		    // 1x Real World Capacity
    }

switch (FEAT_TRAINS, SELF, sw_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

/*	CARGO DECAY	*/
if (param_cargodecay == 0) {
	param_decay_express = 256;
}
if (param_cargodecay == 1) {
	param_decay_express = 384;
}
if (param_cargodecay >= 2) {
	param_decay_express = 512;
}

/*	LOADING SPEEDS	*/
if (param_basecapacity == 0) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}
if (param_basecapacity == 1) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}
if (param_basecapacity == 2) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}

/* LENGTHS */

// Standard 1-8-1 Length
    switch (FEAT_TRAINS, SELF, sw_length_1_8_1, position_in_articulated_veh % 3) {
        1: return 8;
        return 1;
    }
    
// Return 1 if a cab
    switch(FEAT_TRAINS, SELF, IsCab, 
            position_in_consist == 0 || 
            position_in_consist == 1 || 
            position_in_consist == 2 || 
            position_in_vehid_chain_from_end == 0 ||
            position_in_vehid_chain_from_end == 1 ||
            position_in_vehid_chain_from_end == 2
        ) {return;}

// Return Car Number
    switch(FEAT_TRAINS, SELF, CarNumber, ( position_in_consist  + 3 ) / 3 ) {return;}
    switch(FEAT_TRAINS, SELF, CarNumberFromEnd, ( position_in_vehid_chain_from_end + 3 ) / 3 ) {return;}

// Min Length Check
    switch (FEAT_TRAINS, SELF, sw_stop_start_full_length_4, num_vehs_in_consist < 12) {				
		1:  return string(STR_LENGTH_ERROR); 				
		return CB_RESULT_NO_TEXT; 
	}

// Attach Mucar Full
    switch(FEAT_TRAINS, SELF, sw_attach_mu_car_full, [vehicle_type_id == mu_car_full]) {
        0: return string(ONLY_ADD_MUCAR_FULL);
    }

    switch(FEAT_TRAINS, SELF, sw_attach_mu_car_ms, [vehicle_type_id == mu_car_ms]) {
        0: return string(ONLY_ADD_MUCAR_MINI);
    }

    switch(FEAT_TRAINS, SELF, sw_attach_mu_car_mail, [vehicle_type_id == mu_car_mail]) {
		0: return string(ONLY_ADD_MUCAR);
	}

    switch(FEAT_TRAINS, SELF, sw_attach_mu_car_maglev, [vehicle_type_id == mu_car_maglev]) {
        0: return string(ONLY_ADD_MUCAR);
    }


// Mid Check
    switch(FEAT_TRAINS, SELF, HideLongSprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {return;}

// Front Check
    switch(FEAT_TRAINS, SELF, NextPartSame, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(2) == 0 ) {return;}
    switch(FEAT_TRAINS, SELF, PrevPartSame, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {return;}

// Pantos on Evens
    switch(FEAT_TRAINS, SELF, PantoOnCabEvenConsist, num_vehs_in_consist % 2 == 0 ) {return;}
    switch(FEAT_TRAINS, SELF, EvenCarForward, CarNumber() % 2 == 0 ) {return;}
    switch(FEAT_TRAINS, SELF, EvenCarBackward, CarNumberFromEnd() % 2 == 0 ) {return;}
# 1 "JPplusShinkansen.pnml" 4

//IDs
# 1 "src/vehicleid.pnml" 1
// Assign IDs

// Mucars
item(FEAT_TRAINS, mu_car_ms, 1111) {}
item(FEAT_TRAINS, mu_car_full, 1112) {}
item(FEAT_TRAINS, mu_car_mail, 1113) {}

item(FEAT_TRAINS, series_0, 123) {}
item(FEAT_TRAINS, series_922, 922) {}
item(FEAT_TRAINS, series_100, 124) {}
// 200 Series Shinkansen
item(FEAT_TRAINS, series_200, 200) {}
item(FEAT_TRAINS, series_200_sharknose, 201) {}
item(FEAT_TRAINS, series_200_275, 202) {}
item(FEAT_TRAINS, series_200400, 204) {}
item(FEAT_TRAINS, series_200e3, 203) {}

item(FEAT_TRAINS, series_300, 300) {}
item(FEAT_TRAINS, series_301, 301) {}
item(FEAT_TRAINS, series_400, 400) {}
item(FEAT_TRAINS, series_500, 500) {}
item(FEAT_TRAINS, series_700, 700) {}
item(FEAT_TRAINS, series_923, 923) {}
// N700 Series Shinkansen
item(FEAT_TRAINS, series_n700, 707) {}
item(FEAT_TRAINS, series_n700a, 708) {}
item(FEAT_TRAINS, series_n700s, 709) {}
item(FEAT_TRAINS, series_n700_kyushu, 778) {}

item(FEAT_TRAINS, series_800, 800) {}
item(FEAT_TRAINS, series_e1, 1551) {}
item(FEAT_TRAINS, series_e2, 1552) {}
item(FEAT_TRAINS, series_e2e3, 1553) {}
item(FEAT_TRAINS, series_e3, 2003) {}
item(FEAT_TRAINS, series_e4, 2004) {}
item(FEAT_TRAINS, series_e4e3, 2043) {}
item(FEAT_TRAINS, series_e4400, 2044) {}
item(FEAT_TRAINS, series_e5, 2005) {} 
item(FEAT_TRAINS, series_e6, 2006) {}
item(FEAT_TRAINS, series_e5e3, 2053) {}
item(FEAT_TRAINS, series_e5e6, 2056) {}
item(FEAT_TRAINS, series_e5e8, 2058) {}
item(FEAT_TRAINS, series_e7, 2007) {}
item(FEAT_TRAINS, series_e8, 2008) {}
item(FEAT_TRAINS, series_e10, 2010) {}

item(FEAT_TRAINS, series_l0, 125) {}

item(FEAT_TRAINS, series_test_700, 707) {}

// Sort the Order in the Purchase Menu below
sort(FEAT_TRAINS, [

/* Not JR East */
125,    // L0 Series Shinkansen
123,    // 0 Series Shinkansen
922,    // 922 Series Shinkansen
124,    // 100 Series Shinkansen
300,    // 300 Series Shinkansen
500,    // 500 Series Shinkansen
700,    // 700 Series Shinkansen
923,    // 923 Series Shinkansen
707,    // N700 Series Shinkansen
708,    // N700A Series Shinkansen
709,    // N700S Series Shinkansen
800,    // 800 Series Shinkansen

/* JR East */
200,    // 200 Series Shinkansen
201,    // 200 Series Sharknose Shinkansen
202,    // 200 Series Modified 275 Shinkansen
204,    // 200/400 Series Shinkansen
203,    // 200/E3 Series Shinkansen
400,    // 400 Series Shinkansen
1551,   // E1 Series Shinkansen (Max)
1552,   // E2 Series Shinkansen
1553,   // E2 & E3 Series Shinkansen
2003,   // E3 Series Shinkansen
2004,   // E4 Series Shinkansen (Max)
2044,   // E4/400 Series Shinkansen
2043,   // E4/E3 Series Shinkansen
2005,   // E5 Series Shinkansen
2053,   // E5/E3 Shinakansen
2056,   // E5/E6 Shinakansen
2058,   // E5/E8 Shinakansen
2006,   // E6 Series Shinkansen
2007,   // E7/W7 Series Shinkansen
2008,   // E8 Series Shinkansen
2010,   // E10 Series Shinkansen

/*MU Cars*/
mu_car_full,
mu_car_mail,
mu_car_ms,

]);
# 1 "JPplusShinkansen.pnml" 4

// Dummy
# 1 "src/dummy.pnml" 1
 // begin dummy

 // https://www.tt-forums.net/viewtopic.php?f=68&t=53511

spriteset (dummy_sprites, "src/trains/dummy/empty.png")
{
  [0, 0, 2, 2, 0, 0, CROP]
}

 // end dummy
# 1 "JPplusShinkansen.pnml" 4
// Logos
# 1 "src/logos/logos.pnml" 1

// JR Central
spriteset (sprite_logo_jrcentral, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jrcentral.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jrcentral, param_hide_logo) {1:sprite_logo_jrcentral;}

// JR West & JR Central
spriteset (sprite_logo_jrwestcentral, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jrwestcentral.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jrwestcentral, param_hide_logo) {1:sprite_logo_jrwestcentral;}

// JR West
spriteset (sprite_logo_jrwest, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jrwest.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jrwest, param_hide_logo) {1:sprite_logo_jrwest;}

// JR East
spriteset (sprite_logo_jreast, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jreast.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jreast, param_hide_logo) {1:sprite_logo_jreast;}

// JR Kyushu
spriteset (sprite_logo_jrkyushu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jrkyushu.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jrkyushu, param_hide_logo) {1:sprite_logo_jrkyushu;}

// JNR
spriteset (sprite_logo_jnr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jnr.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jnr, param_hide_logo) {1:sprite_logo_jnr;}

// JP+ SHS for Mucars
spriteset (sprite_logo_jppsks, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/logos/jppsks.png") { template_purchase(0,0) }
switch(FEAT_TRAINS, SELF, logo_jppsks, param_hide_logo) {1:sprite_logo_jppsks;}
# 1 "JPplusShinkansen.pnml" 4
// Mucar
# 1 "src/mucar.pnml" 1

/* MINI-SHINKANSEN */

    spriteset(ss_mucar_mini_buy,            "src/trains/mucar/gfx/mucar.png") {template_purchase(233, 51)}
    spriteset(set_mu_car_base,              "src/trains/mucar/gfx/mucar.png") {tmpl_mid_std(1,51)}

    switch(FEAT_TRAINS, SELF, sw_mucar_mini_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jppsks; 
                1: ss_mucar_mini_buy;
            }

    item(FEAT_TRAINS, mu_car_ms) {
        /* Define properties first, make sure to set all of them */
        property {
            name:                         string(MUCAR_MINI);
            misc_flags:                   bitmask(TRAIN_FLAG_2CC,TRAIN_FLAG_SPRITE_STACK);
            introduction_date:            date(1800,1,1);
            climates_available:           ALL_CLIMATES;
            model_life:                   VEHICLE_NEVER_EXPIRES;
            vehicle_life:                 60;
            loading_speed:                0;
            cost_factor:                  189;
            running_cost_factor:          6;
            speed:                        0 km/h;
            power:                        0 hp;
            cargo_capacity:               1;
            weight:                       0 ton;
            tractive_effort_coefficient:  0.3;
            air_drag_coefficient:         0;
            reliability_decay:            20;
            refittable_cargo_classes:     bitmask(CC_PASSENGERS);
            cargo_age_period:             185;
            refit_cost:                   0;
            track_type:                   MINI_SHINKANSEN;
            ai_special_flag:              AI_FLAG_PASSENGER;
            running_cost_base:            RUNNING_COST_ELECTRIC;
            engine_class:                 ENGINE_CLASS_ELECTRIC;
            visual_effect_and_powered:    visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
            sprite_id:                    SPRITE_ID_NEW_TRAIN;
            dual_headed:                  0;
            length:                       8;
            extra_power_per_wagon:        0;
            bitmask_vehicle_info:         0;
        }
        /* Define graphics and callbacks
        * Setting all callbacks is not needed, only define what is used */
        graphics {
            purchase:                     sw_mucar_mini_purchase;
            additional_text:			  return string(MUCAR_MINI_DESC);
            set_mu_car_base;
        }
    }

/* FULL SHINKANSEN */

    spriteset(ss_mucar_full_buy,            "src/trains/mucar/gfx/mucar.png") {template_purchase(233, 1)}
    spriteset(ss_mucar_full_10,             "src/trains/mucar/gfx/mucar.png") {tmpl_10_std(1,1)}

    switch(FEAT_TRAINS, SELF, sw_mucar_full_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jppsks; 
                1: ss_mucar_full_buy;
            }

    switch (FEAT_TRAINS, SELF, sw_mucar_full_graphics, position_in_articulated_veh) {				
            1:  ss_mucar_full_10; 				
            dummy_sprites;
        }

    /* --- Articulated part callback  --- */
    switch(FEAT_TRAINS, SELF, sw_mucar_full_articulated_part, getbits(extra_callback_info1, 0, 8)) {
        1: return mu_car_full;
        2: return mu_car_full;
        return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    item(FEAT_TRAINS, mu_car_full) {
        /* Define properties first, make sure to set all of them */
        property {
            name:                           string(MUCAR_FULL);
            misc_flags:                     bitmask(TRAIN_FLAG_2CC,TRAIN_FLAG_SPRITE_STACK);
            introduction_date:              date(1800,1,1);
            climates_available:             ALL_CLIMATES;
            model_life:                     VEHICLE_NEVER_EXPIRES;
            vehicle_life:                   60;
            loading_speed:                  0;
            cost_factor:                    189;
            running_cost_factor:            18;
            speed:                          0 km/h;
            power:                          0 hp;
            cargo_capacity:                 1;
            weight:                         0 ton;
            tractive_effort_coefficient:    0.3;
            air_drag_coefficient:           0;
            reliability_decay:              20;
            refittable_cargo_classes:       bitmask(CC_PASSENGERS);
            cargo_age_period:               185;
            refit_cost:                     0;
            track_type:                     SHINKANSEN;
            ai_special_flag:                AI_FLAG_PASSENGER;
            running_cost_base:              RUNNING_COST_ELECTRIC;
            engine_class:                   ENGINE_CLASS_ELECTRIC;
            visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
            sprite_id:                      SPRITE_ID_NEW_TRAIN;
            dual_headed:                    0;
            //length:                       8;
            extra_power_per_wagon:          0;
            bitmask_vehicle_info:           0;
        }
        /* Define graphics and callbacks
        * Setting all callbacks is not needed, only define what is used */
        graphics {
            default:                        sw_mucar_full_graphics;                     
            purchase:                       sw_mucar_full_purchase;
            additional_text:			    return string(MUCAR_FULL_DESC);
            articulated_part:               sw_mucar_full_articulated_part;
            length:                         sw_length_1_8_1; 
            cargo_capacity:                 0;
        }
    }

// MAGLEV

    spriteset(ss_mucar_maglev_buy,          "src/trains/mucar/gfx/mucar.png") {template_purchase(233, 101)}
    spriteset(ss_mucar_maglev_10,           "src/trains/mucar/gfx/mucar.png") {tmpl_10_std(1,101)}

    switch(FEAT_TRAINS, SELF, sw_mucar_maglev_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jppsks; 
                1: ss_mucar_maglev_buy;
            }

    switch (FEAT_TRAINS, SELF, sw_mucar_maglev_graphics, position_in_articulated_veh) {				
            1:  ss_mucar_maglev_10; 				
            dummy_sprites;
        }

    /* --- Articulated part callback  --- */
    switch(FEAT_TRAINS, SELF, sw_mucar_maglev_articulated_part, getbits(extra_callback_info1, 0, 8)) {
        1: return mu_car_maglev;
        2: return mu_car_maglev;
        return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    item(FEAT_TRAINS, mu_car_maglev) {
        /* Define properties first, make sure to set all of them */
        property {
            name:                           string(MUCAR_MAGLEV);
            misc_flags:                     bitmask(TRAIN_FLAG_2CC,TRAIN_FLAG_SPRITE_STACK);
            introduction_date:              date(2027,1,1);
            climates_available:             ALL_CLIMATES;
            model_life:                     VEHICLE_NEVER_EXPIRES;
            vehicle_life:                   60;
            loading_speed:                  0;
            cost_factor:                    189;
            running_cost_factor:            18;
            speed:                          0 km/h;
            power:                          0 hp;
            cargo_capacity:                 1;
            weight:                         0 ton;
            tractive_effort_coefficient:    0.3;
            air_drag_coefficient:           0;
            reliability_decay:              20;
            refittable_cargo_classes:       bitmask(CC_PASSENGERS);
            cargo_age_period:               185;
            refit_cost:                     0;
            track_type:                     SC_MAGLEV;
            ai_special_flag:                AI_FLAG_PASSENGER;
            running_cost_base:              RUNNING_COST_ELECTRIC;
            engine_class:                   ENGINE_CLASS_ELECTRIC;
            visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
            sprite_id:                      SPRITE_ID_NEW_TRAIN;
            dual_headed:                    0;
            //length:                       8;
            extra_power_per_wagon:          0;
            bitmask_vehicle_info:           0;
        }
        /* Define graphics and callbacks
        * Setting all callbacks is not needed, only define what is used */
        graphics {
            default:                        sw_mucar_maglev_graphics;                     
            purchase:                       sw_mucar_maglev_purchase;
            additional_text:			    return string(MUCAR_MAGLEV_DESC);
            articulated_part:               sw_mucar_maglev_articulated_part;
            length:                         sw_length_1_8_1; 
            cargo_capacity:                 0;
        }
    }

// MAIL

    spriteset(ss_mucar_mail_buy,            "src/trains/mucar/gfx/mucar.png") {template_purchase(233, 151)}
    spriteset(ss_mucar_mail_10,            "src/trains/mucar/gfx/mucar.png") {tmpl_10_std(1,151)}

    switch(FEAT_TRAINS, SELF, sw_mucar_mail_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jppsks; 
                1: ss_mucar_mail_buy;
            }

    switch (FEAT_TRAINS, SELF, sw_mucar_mail_graphics, position_in_articulated_veh) {				
            1:  ss_mucar_mail_10; 				
            dummy_sprites;
        }

    /* --- Articulated part callback  --- */
    switch(FEAT_TRAINS, SELF, sw_mucar_mail_articulated_part, getbits(extra_callback_info1, 0, 8)) {
        1: return mu_car_mail;
        2: return mu_car_mail;
        return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    if (param_dryellow == 1) {

    item(FEAT_TRAINS, mu_car_mail) {
        /* Define properties first, make sure to set all of them */
        property {
            name:                         string(MUCAR_MAIL);
            introduction_date:            date(1800,1,1);
            climates_available:           ALL_CLIMATES;
            model_life:                   VEHICLE_NEVER_EXPIRES;
            vehicle_life:                 60;
            loading_speed:                0;
            cost_factor:                  189;
            running_cost_factor:          18;
            speed:                        0 km/h;
            power:                        0 hp;
            cargo_capacity:               1;
            weight:                       0 ton;
            tractive_effort_coefficient:  0.3;
            air_drag_coefficient:         0;
            reliability_decay:            20;
            refittable_cargo_classes:     bitmask(CC_MAIL);
            cargo_age_period:             185;
            refit_cost:                   0;
            track_type:                   SHINKANSEN;
            ai_special_flag:              AI_FLAG_PASSENGER;
            running_cost_base:            RUNNING_COST_ELECTRIC;
            engine_class:                 ENGINE_CLASS_ELECTRIC;
            visual_effect_and_powered:    visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
            sprite_id:                    SPRITE_ID_NEW_TRAIN;
            dual_headed:                  0;
            //length:                       8;
            extra_power_per_wagon:        0;
            bitmask_vehicle_info:         0;
        }
        /* Define graphics and callbacks
        * Setting all callbacks is not needed, only define what is used */
        graphics {
            default:                        sw_mucar_mail_graphics;                     
            purchase:                       sw_mucar_mail_purchase;
            additional_text:			    return string(MUCAR_MAIL_DESC);
            articulated_part:               sw_mucar_mail_articulated_part;
            length:                         sw_length_1_8_1;  
        }
    }
    }
# 1 "JPplusShinkansen.pnml" 4

// Pantos
# 1 "src/pantos.pnml" 1

// N700 Series

    spriteset(ss_std_n700_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_n700_f, HideLongSprite() ) { 0: ss_std_n700_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_n700_b, HideLongSprite() ) { 0: ss_std_n700_series_pantob_ptg; }

	spriteset(panto_midsprite_n700_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_n700_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_pantos.png") {tmpl_mid_rev(1,101)}

// 800 Series

	spriteset(ss_std_800_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_800_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_800_f, HideLongSprite() ) { 0: ss_std_800_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_800_b, HideLongSprite() ) { 0: ss_std_800_series_pantob_ptg; }

	spriteset(panto_midsprite_800_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_800_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series_pantos.png") {tmpl_mid_rev(1,101)}

// 500 Series

	spriteset(ss_std_500_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_500_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_500_f, HideLongSprite() ) { 0: ss_std_500_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_500_b, HideLongSprite() ) { 0: ss_std_500_series_pantob_ptg; }

	spriteset(panto_midsprite_500_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_500_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_pantos.png") {tmpl_mid_rev(1,101)}

// 200 Series

	spriteset(ss_std_200_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_200_f, HideLongSprite() ) { 0: ss_std_200_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_200_b, HideLongSprite() ) { 0: ss_std_200_series_pantob_ptg; }

	spriteset(panto_midsprite_200_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_200_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_pantos.png") {tmpl_mid_rev(1,101)}

// 400 Series

	spriteset(panto_midsprite_400_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_400_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_pantos.png") {tmpl_mid_rev(1,101)}

// E1 Series

	spriteset(ss_std_e1_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e1_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_e1_f, HideLongSprite() ) { 0: ss_std_e1_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_e1_b, HideLongSprite() ) { 0: ss_std_e1_series_pantob_ptg; }

	spriteset(panto_midsprite_e1_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e1_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_pantos.png") {tmpl_mid_rev(1,101)}

// E2 Series

	spriteset(ss_std_e2_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_e2_f, HideLongSprite() ) { 0: ss_std_e2_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_e2_b, HideLongSprite() ) { 0: ss_std_e2_series_pantob_ptg; }

	spriteset(panto_midsprite_e2_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e2_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pantos.png") {tmpl_mid_rev(1,101)}

// E5 Series

	spriteset(ss_std_e5_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_e5_f, HideLongSprite() ) { 0: ss_std_e5_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_e5_b, HideLongSprite() ) { 0: ss_std_e5_series_pantob_ptg; }

	spriteset(panto_midsprite_e5_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e5_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pantos.png") {tmpl_mid_rev(1,101)}

// E7 Series

	spriteset(ss_std_e7_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e7_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_e7_f, HideLongSprite() ) { 0: ss_std_e7_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_e7_b, HideLongSprite() ) { 0: ss_std_e7_series_pantob_ptg; }

	spriteset(panto_midsprite_e7_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e7_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series_pantos.png") {tmpl_mid_rev(1,101)}

// E8 Series

	spriteset(panto_midsprite_e8_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e8_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series_pantos.png") {tmpl_mid_rev(1,101)}

// E510Series

	spriteset(ss_std_e10_series_pantof_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_pantos.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e10_series_pantob_ptg, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_pantos.png") {tmpl_10_rev(1,101)}

	switch(FEAT_TRAINS, SELF, panto_longsprite_e10_f, HideLongSprite() ) { 0: ss_std_e10_series_pantof_ptg; }
	switch(FEAT_TRAINS, SELF, panto_longsprite_e10_b, HideLongSprite() ) { 0: ss_std_e10_series_pantob_ptg; }

	spriteset(panto_midsprite_e10_f, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_pantos.png") {tmpl_mid_std(1,101)}
	spriteset(panto_midsprite_e10_b, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_pantos.png") {tmpl_mid_rev(1,101)}
# 1 "JPplusShinkansen.pnml" 4

//Final Settings
# 1 "src/grfintegration.pnml" 1
// Begin grfintegration

//set depot vehicle width to 32px to avoid overlap
train_width_32_px = 1;
//align train properly in depot window
traininfo_y_offset = 2;

// TTD check //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, REQUIRES_OPENTTD, string(GRF_OTTDVER));
}

// 8bpp //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, string(GRF_OTTDVER));
}

// Warn if "JapanSet3: Trains isn't optimal" //
/*
if (((grf_current_status("SZ\0D\00") == 0) && (grf_current_status("DP\30\00") == 0)) || ((grf_future_status("SZ\0D\00") == 0) && (grf_future_status("DP\30\00") == 0)) || ((grf_order_behind("SZ\0D\00") == 0) && (grf_order_behind("DP\30\00") == 0))) {
	error( WARNING, string(GRF_JAPANSET));
}

if (grf_order_behind("BS\42\13") == 0) {
	error(FATAL, string(GRF_JPPLUSSET));
}

if (((grf_order_behind("EN\21\01") == 0) && (grf_order_behind("BS\07\20") != 0)) || ((grf_future_status("EN\21\01") == 0) && (grf_future_status("BS\07\20") == 0)) || ((grf_current_status("EN\21\01") != 0) && (grf_current_status("BS\07\20") == 0))) {
	error(WARNING, string(GRF_NATSSET));
}

if (grf_order_behind("SZ\0D\00") == 0) {
	error(WARNING, string(GRF_JAPANSETTRAINS));
}

if (grf_order_behind("JD\A1\E1") == 0) {
	error(WARNING, string(GRF_JAPANSECRETORDER));
}
*/
// End grfintegration
# 1 "JPplusShinkansen.pnml" 4

/*---NON-JR EAST TRAINS---*/
# 1 "src/trains/0_series/0_series.pnml" 1

# 1 "src/trains/0_series/0_series_menu.pnml" 1

/* SUBTYPES */

    // From 1964 to 2002
    switch(FEAT_TRAINS, SELF, sw_0_series_1964_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
	    1: return string(LV_0_SERIES_ORIGINAL);
        2: return string(LV_0_SERIES_NOSE);
        3: return string(LV_0_SERIES_ORIGINAL_2CC);
        4: return string(LV_0_SERIES_NOSE_2CC);
        return CB_RESULT_NO_TEXT;
        }

    // Note - there is a purchase sprite change in 1987 (JNR -> JR)
    
    // From 2002 onwards - introduction of Kodama Livery
    switch(FEAT_TRAINS, SELF, sw_0_series_2002_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
	    1: return string(LV_0_SERIES_ORIGINAL);
        2: return string(LV_0_SERIES_NOSE);
        3: return string(LV_0_SERIES_ORIGINAL_2CC);
        4: return string(LV_0_SERIES_NOSE_2CC);
        5: return string(LV_0_SERIES_KODAMA);
        return CB_RESULT_NO_TEXT;
        }
    
    // Cargo Subtype List
    switch(FEAT_TRAINS, SELF, sw_0_series_year_dep_subtype_text, current_year) {
        0..2001: sw_0_series_1964_subtype_text;
        sw_0_series_2002_subtype_text;
    }

/* Purchase Menu */

    spriteset (ss_0_series_irl_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {template_purchase(233, 1)}
    spriteset (ss_922_series_irl_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, logo_0_series_year_dep, current_year) {
			0..1986: logo_jnr;                  // JNR (Original Livery)
			logo_jrwestcentral;                 // JR Central & West (Kodama Livery)
		}

    switch(FEAT_TRAINS, SELF, sw_0_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_0_series_year_dep; 
            1: ss_0_series_irl_buy;
        }

    switch(FEAT_TRAINS, SELF, sw_922_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_0_series_year_dep; 
            1: ss_922_series_irl_buy;
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_0_series_cab01f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_0_series_cab01b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_0_series_cab01f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_0_series_cab01b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_0_series_cab01f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_0_series_cab01b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_0_series_cab01f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_0_series_cab01b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_rev(1,51)}

    // Nose

    // 10/8
	spriteset(ss_std_0_series_cab01f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_0_series_cab01b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_0_series_cab01f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_0_series_cab01b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_0_series_cab01f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_0_series_cab01b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_0_series_cab01f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_0_series_cab01b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_bck_rev(1,51)}

    // Kodama

    // 10/8
	spriteset(ss_std_0_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_0_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_0_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_0_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_0_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_0_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_0_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_0_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_rev(1,51)}

	// 922 Series Dr Yellow

    // 10/8
	spriteset(ss_std_0_series_cab01f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_0_series_cab01b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_0_series_cab01f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_0_series_cab01b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_0_series_cab01f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_0_series_cab01b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_0_series_cab01f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_0_series_cab01b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_cab01f_ydp, current_year) {2002..9999: ss_frt_0_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab01f_2cc_mask, cargo_subtype) {0:sw_frt_0_series_cab01f_ydp; 3:ss_frt_0_series_cab01f_2cc; 4:ss_frt_0_series_cab01f_2cc; 5:ss_frt_0_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab01f_nos_mask, cargo_subtype) {2:ss_frt_0_series_cab01f_nos; 4:ss_frt_0_series_cab01f_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_0_series_cab01f_2cc_mask;		    // Mask for Front
                2: ss_frt_0_series_cab01f_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_0_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_cab01f_ydp, current_year) {2002..9999: ss_mid_0_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab01f_2cc_mask, cargo_subtype) {0:sw_mid_0_series_cab01f_ydp; 3:ss_mid_0_series_cab01f_2cc; 4:ss_mid_0_series_cab01f_2cc; 5:ss_mid_0_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab01f_nos_mask, cargo_subtype) {2:ss_mid_0_series_cab01f_nos; 4:ss_mid_0_series_cab01f_nos;}

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_0_series_cab01f_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_cab01f_ydp, current_year) {2002..9999: ss_std_0_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab01f_2cc_mask, cargo_subtype) {0:sw_std_0_series_cab01f_ydp; 3:ss_std_0_series_cab01f_2cc; 4:ss_std_0_series_cab01f_2cc; 5:ss_std_0_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab01f_nos_mask, cargo_subtype) {2:ss_std_0_series_cab01f_nos; 4:ss_std_0_series_cab01f_nos;}
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01f_2cc, HideLongSprite() ) { 0: sw_std_0_series_cab01f_2cc_mask; }
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01f_nos, HideLongSprite() ) { 0: sw_std_0_series_cab01f_nos_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab01f_irl;       	    // Base for Mid
				1: ss_mid_0_series_cab01f_2cc_mask;		    // Mask for Mid
                2: ss_mid_0_series_cab01f_nos_mask;		    // Nose for Mid
                // Long Sprite
				3: longsprite_0_series_cab01f_irl;	        // Base for LongSprite
                4: longsprite_0_series_cab01f_2cc;          // Mask for LongSprite
                5: longsprite_0_series_cab01f_nos;          // Nose for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_cab01f_ydp, current_year) {2002..9999: ss_bck_0_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab01f_2cc_mask, cargo_subtype) {0:sw_bck_0_series_cab01f_ydp; 3:ss_bck_0_series_cab01f_2cc; 4:ss_bck_0_series_cab01f_2cc; 5:ss_bck_0_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab01f_nos_mask, cargo_subtype) {2:ss_bck_0_series_cab01f_nos; 4:ss_bck_0_series_cab01f_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_cab01f_irl;       	    // Base for Front
				1: ss_bck_0_series_cab01f_2cc_mask;		    // Mask for Front
                2: ss_bck_0_series_cab01f_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_0_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_cab01f, position_in_consist % 3 ) {				
            0: sw_0_series_cab01f_frt_longsprite;
            1: sw_0_series_cab01f_mid_stack;
            2: sw_0_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_cab01b_ydp, current_year) {2002..9999: ss_frt_0_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab01b_2cc_mask, cargo_subtype) {0:sw_frt_0_series_cab01b_ydp; 3:ss_frt_0_series_cab01b_2cc; 4:ss_frt_0_series_cab01b_2cc; 5:ss_frt_0_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab01b_nos_mask, cargo_subtype) {2:ss_frt_0_series_cab01b_nos; 4:ss_frt_0_series_cab01b_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_0_series_cab01b_2cc_mask;		    // Mask for Front
                2: ss_frt_0_series_cab01b_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_0_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_cab01b_ydp, current_year) {2002..9999: ss_mid_0_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab01b_2cc_mask, cargo_subtype) {0:sw_mid_0_series_cab01b_ydp; 3:ss_mid_0_series_cab01b_2cc; 4:ss_mid_0_series_cab01b_2cc; 5:ss_mid_0_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab01b_nos_mask, cargo_subtype) {2:ss_mid_0_series_cab01b_nos; 4:ss_mid_0_series_cab01b_nos;}

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_0_series_cab01b_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_cab01b_ydp, current_year) {2002..9999: ss_std_0_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab01b_2cc_mask, cargo_subtype) {0:sw_std_0_series_cab01b_ydp; 3:ss_std_0_series_cab01b_2cc; 4:ss_std_0_series_cab01b_2cc; 5:ss_std_0_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab01b_nos_mask, cargo_subtype) {2:ss_std_0_series_cab01b_nos; 4:ss_std_0_series_cab01b_nos;}
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01b_2cc, HideLongSprite() ) { 0: sw_std_0_series_cab01b_2cc_mask; }
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01b_nos, HideLongSprite() ) { 0: sw_std_0_series_cab01b_nos_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab01b_irl;       	    // Base for Mid
				1: ss_mid_0_series_cab01b_2cc_mask;		    // Mask for Mid
                2: ss_mid_0_series_cab01b_nos_mask;		    // Nose for Mid
                // Long Sprite
				3: longsprite_0_series_cab01b_irl;	        // Base for LongSprite
                4: longsprite_0_series_cab01b_2cc;          // Mask for LongSprite
                5: longsprite_0_series_cab01b_nos;          // Nose for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_cab01b_ydp, current_year) {2002..9999: ss_bck_0_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab01b_2cc_mask, cargo_subtype) {0:sw_bck_0_series_cab01b_ydp; 3:ss_bck_0_series_cab01b_2cc; 4:ss_bck_0_series_cab01b_2cc; 5:ss_bck_0_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab01b_nos_mask, cargo_subtype) {2:ss_bck_0_series_cab01b_nos; 4:ss_bck_0_series_cab01b_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_cab01b_irl;       	    // Base for Front
				1: ss_bck_0_series_cab01b_2cc_mask;		    // Mask for Front
                2: ss_bck_0_series_cab01b_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_0_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_0_series_cab01b_frt_longsprite;
            1: sw_0_series_cab01b_mid_stack;
            2: sw_0_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_0_series_cab02f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_0_series_cab02b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_0_series_cab02f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_0_series_cab02b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_0_series_cab02f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_0_series_cab02b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_0_series_cab02f_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_0_series_cab02b_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Nose

    // 10/8
	spriteset(ss_std_0_series_cab02f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_0_series_cab02b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_0_series_cab02f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_0_series_cab02b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_0_series_cab02f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_0_series_cab02b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_0_series_cab02f_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_0_series_cab02b_nos, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_nose.png") {tmpl_cab_bck_rev(1,1)}

    // Kodama

    // 10/8
	spriteset(ss_std_0_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_0_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_0_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_0_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_0_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_0_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_0_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_0_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_cab_bck_rev(1,1)}

	// 922 Dr Yellow

    // 10/8
	spriteset(ss_std_0_series_cab02f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_0_series_cab02b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_0_series_cab02f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_0_series_cab02b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_0_series_cab02f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_0_series_cab02b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_0_series_cab02f_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_0_series_cab02b_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_cab02f_ydp, current_year) {2002..9999: ss_frt_0_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab02f_2cc_mask, cargo_subtype) {0:sw_frt_0_series_cab02f_ydp; 3:ss_frt_0_series_cab02f_2cc; 4:ss_frt_0_series_cab02f_2cc; 5:ss_frt_0_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab02f_nos_mask, cargo_subtype) {2:ss_frt_0_series_cab02f_nos; 4:ss_frt_0_series_cab02f_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_cab02f_irl;       	    // Base for Front
				1: ss_frt_0_series_cab02f_2cc_mask;		    // Mask for Front
                2: ss_frt_0_series_cab02f_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_0_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_cab02f_ydp, current_year) {2002..9999: ss_mid_0_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab02f_2cc_mask, cargo_subtype) {0:sw_mid_0_series_cab02f_ydp; 3:ss_mid_0_series_cab02f_2cc; 4:ss_mid_0_series_cab02f_2cc; 5:ss_mid_0_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab02f_nos_mask, cargo_subtype) {2:ss_mid_0_series_cab02f_nos; 4:ss_mid_0_series_cab02f_nos;}

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_0_series_cab02f_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_cab02f_ydp, current_year) {2002..9999: ss_std_0_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab02f_2cc_mask, cargo_subtype) {0:sw_std_0_series_cab02f_ydp; 3:ss_std_0_series_cab02f_2cc; 4:ss_std_0_series_cab02f_2cc; 5:ss_std_0_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab02f_nos_mask, cargo_subtype) {2:ss_std_0_series_cab02f_nos; 4:ss_std_0_series_cab02f_nos;}
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02f_2cc, HideLongSprite() ) { 0: sw_std_0_series_cab02f_2cc_mask; }
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02f_nos, HideLongSprite() ) { 0: sw_std_0_series_cab02f_nos_mask; }

            // Panto Decision
                switch(FEAT_TRAINS, SELF, panto_midsprite_0_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_f; }
                switch(FEAT_TRAINS, SELF, panto_longsprite_0_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_f; }

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab02f_irl;       	    // Base for Mid
				1: ss_mid_0_series_cab02f_2cc_mask;		    // Mask for Mid
                2: ss_mid_0_series_cab02f_nos_mask;		    // Nose for Mid
                // Long Sprite
				3: longsprite_0_series_cab02f_irl;	        // Base for LongSprite
                4: longsprite_0_series_cab02f_2cc;          // Mask for LongSprite
                5: longsprite_0_series_cab02f_nos;          // Nose for LongSprite
                // Pantos
                6: panto_midsprite_0_series_cab02f;         // Panto for Mid
                7: panto_longsprite_0_series_cab02f;        // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_cab02f_ydp, current_year) {2002..9999: ss_bck_0_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab02f_2cc_mask, cargo_subtype) {0:sw_bck_0_series_cab02f_ydp; 3:ss_bck_0_series_cab02f_2cc; 4:ss_bck_0_series_cab02f_2cc; 5:ss_bck_0_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab02f_nos_mask, cargo_subtype) {2:ss_bck_0_series_cab02f_nos; 4:ss_bck_0_series_cab02f_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_cab02f_irl;       	    // Base for Front
				1: ss_bck_0_series_cab02f_2cc_mask;		    // Mask for Front
                2: ss_bck_0_series_cab02f_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_0_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_0_series_cab02f_frt_longsprite;
            1: sw_0_series_cab02f_mid_stack;
            2: sw_0_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_cab02b_ydp, current_year) {2002..9999: ss_frt_0_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab02b_2cc_mask, cargo_subtype) {0:sw_frt_0_series_cab02b_ydp; 3:ss_frt_0_series_cab02b_2cc; 4:ss_frt_0_series_cab02b_2cc; 5:ss_frt_0_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_frt_0_series_cab02b_nos_mask, cargo_subtype) {2:ss_frt_0_series_cab02b_nos; 4:ss_frt_0_series_cab02b_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_cab02b_irl;       	    // Base for Front
				1: ss_frt_0_series_cab02b_2cc_mask;		    // Mask for Front
                2: ss_frt_0_series_cab02b_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_0_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_cab02b_ydp, current_year) {2002..9999: ss_mid_0_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab02b_2cc_mask, cargo_subtype) {0:sw_mid_0_series_cab02b_ydp; 3:ss_mid_0_series_cab02b_2cc; 4:ss_mid_0_series_cab02b_2cc; 5:ss_mid_0_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_mid_0_series_cab02b_nos_mask, cargo_subtype) {2:ss_mid_0_series_cab02b_nos; 4:ss_mid_0_series_cab02b_nos;}

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_0_series_cab02b_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_cab02b_ydp, current_year) {2002..9999: ss_std_0_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab02b_2cc_mask, cargo_subtype) {0:sw_std_0_series_cab02b_ydp; 3:ss_std_0_series_cab02b_2cc; 4:ss_std_0_series_cab02b_2cc; 5:ss_std_0_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_cab02b_nos_mask, cargo_subtype) {2:ss_std_0_series_cab02b_nos; 4:ss_std_0_series_cab02b_nos;}
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02b_2cc, HideLongSprite() ) { 0: sw_std_0_series_cab02b_2cc_mask; }
                switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02b_nos, HideLongSprite() ) { 0: sw_std_0_series_cab02b_nos_mask; }

            // Panto Decision
                switch(FEAT_TRAINS, SELF, panto_midsprite_0_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_b; }
                switch(FEAT_TRAINS, SELF, panto_longsprite_0_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_b; }

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab02b_irl;       	    // Base for Mid
				1: ss_mid_0_series_cab02b_2cc_mask;		    // Mask for Mid
                2: ss_mid_0_series_cab02b_nos_mask;		    // Nose for Mid
                // Long Sprite
				3: longsprite_0_series_cab02b_irl;	        // Base for LongSprite
                4: longsprite_0_series_cab02b_2cc;          // Mask for LongSprite
                5: longsprite_0_series_cab02b_nos;          // Nose for LongSprite
                // Pantos
                6: panto_midsprite_0_series_cab02b;         // Panto for Mid
                7: panto_longsprite_0_series_cab02b;        // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_cab02b_ydp, current_year) {2002..9999: ss_bck_0_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab02b_2cc_mask, cargo_subtype) {0:sw_bck_0_series_cab02b_ydp; 3:ss_bck_0_series_cab02b_2cc; 4:ss_bck_0_series_cab02b_2cc; 5:ss_bck_0_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, ss_bck_0_series_cab02b_nos_mask, cargo_subtype) {2:ss_bck_0_series_cab02b_nos; 4:ss_bck_0_series_cab02b_nos;}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_cab02b_irl;       	    // Base for Front
				1: ss_bck_0_series_cab02b_2cc_mask;		    // Mask for Front
                2: ss_bck_0_series_cab02b_nos_mask;         // Nose for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_0_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_cab02b, position_in_consist % 3 ) {				
            0: sw_0_series_cab02b_frt_longsprite;
            1: sw_0_series_cab02b_mid_stack;
            2: sw_0_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_0_series_coachf_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_coachb_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_coachf_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_coachb_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_coachf_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_coachb_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_coachf_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_coachb_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Kodama

    // 10/8
	spriteset(ss_std_0_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_rev(1,101)}

	// 922 Series Dr Yellow

    // 10/8
	spriteset(ss_std_0_series_coachf_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_coachb_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_coachf_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_coachb_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_coachf_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_coachb_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_coachf_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_coachb_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_coachf_ydp, current_year) {2002..9999: ss_frt_0_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_coachf_2cc_mask, cargo_subtype) {0:sw_frt_0_series_coachf_ydp; 3:ss_frt_0_series_coachf_2cc; 4:ss_frt_0_series_coachf_2cc; 5:ss_frt_0_series_coachf_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_coachf_irl;       	    // Base for Front
				1: ss_frt_0_series_coachf_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_0_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_coachf_ydp, current_year) {2002..9999: ss_mid_0_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_coachf_2cc_mask, cargo_subtype) {0:sw_mid_0_series_coachf_ydp; 3:ss_mid_0_series_coachf_2cc; 4:ss_mid_0_series_coachf_2cc; 5:ss_mid_0_series_coachf_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_coachf_irl, HideLongSprite() ) { 0: ss_std_0_series_coachf_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_coachf_ydp, current_year) {2002..9999: ss_std_0_series_coachf_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_coachf_2cc_mask, cargo_subtype) {0:sw_std_0_series_coachf_ydp; 3:ss_std_0_series_coachf_2cc; 4:ss_std_0_series_coachf_2cc; 5:ss_std_0_series_coachf_kdm; }
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_coachf_2cc, HideLongSprite() ) { 0: sw_std_0_series_coachf_2cc_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_coachf_irl;       	    // Base for Mid
				1: ss_mid_0_series_coachf_2cc_mask;		    // Mask for Mid
                // Long Sprite
				2: longsprite_0_series_coachf_irl;	        // Base for LongSprite
                3: longsprite_0_series_coachf_2cc;          // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_coachf_ydp, current_year) {2002..9999: ss_bck_0_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_coachf_2cc_mask, cargo_subtype) {0:sw_bck_0_series_coachf_ydp; 3:ss_bck_0_series_coachf_2cc; 4:ss_bck_0_series_coachf_2cc; 5:ss_bck_0_series_coachf_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_coachf_irl;       	    // Base for Front
				1: ss_bck_0_series_coachf_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_0_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_coachf, position_in_consist % 3 ) {				
            0: sw_0_series_coachf_frt_longsprite;
            1: sw_0_series_coachf_mid_stack;
            2: sw_0_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_coachb_ydp, current_year) {2002..9999: ss_frt_0_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_coachb_2cc_mask, cargo_subtype) {0:sw_frt_0_series_coachb_ydp; 3:ss_frt_0_series_coachb_2cc; 4:ss_frt_0_series_coachb_2cc; 5:ss_frt_0_series_coachb_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_coachb_irl;       	    // Base for Front
				1: ss_frt_0_series_coachb_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_0_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_coachb_ydp, current_year) {2002..9999: ss_mid_0_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_coachb_2cc_mask, cargo_subtype) {0:sw_mid_0_series_coachb_ydp; 3:ss_mid_0_series_coachb_2cc; 4:ss_mid_0_series_coachb_2cc; 5:ss_mid_0_series_coachb_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_coachb_irl, HideLongSprite() ) { 0: ss_std_0_series_coachb_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_coachb_ydp, current_year) {2002..9999: ss_std_0_series_coachb_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_coachb_2cc_mask, cargo_subtype) {0:sw_std_0_series_coachb_ydp; 3:ss_std_0_series_coachb_2cc; 4:ss_std_0_series_coachb_2cc; 5:ss_std_0_series_coachb_kdm; }
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_coachb_2cc, HideLongSprite() ) { 0: sw_std_0_series_coachb_2cc_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_coachb_irl;       	    // Base for Mid
				1: ss_mid_0_series_coachb_2cc_mask;		    // Mask for Mid
                // Long Sprite
				2: longsprite_0_series_coachb_irl;	        // Base for LongSprite
                3: longsprite_0_series_coachb_2cc;          // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_coachb_ydp, current_year) {2002..9999: ss_bck_0_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_coachb_2cc_mask, cargo_subtype) {0:sw_bck_0_series_coachb_ydp; 3:ss_bck_0_series_coachb_2cc; 4:ss_bck_0_series_coachb_2cc; 5:ss_bck_0_series_coachb_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_coachb_irl;       	    // Base for Front
				1: ss_bck_0_series_coachb_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_0_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_0_series_coachb_frt_longsprite;
            1: sw_0_series_coachb_mid_stack;
            2: sw_0_series_coachb_bck_longsprite;
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_0_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_irl.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_0_series_pantof_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_pantob_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_pantof_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_pantob_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_pantof_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_pantob_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_pantof_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_pantob_2cc, "src/trains/0_series/gfx/0_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Kodama

    // 10/8
	spriteset(ss_std_0_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/0_series_kodama.png") {tmpl_bck_rev(1,101)}

	// 922 Series Dr Yellow

    // 10/8
	spriteset(ss_std_0_series_pantof_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_0_series_pantob_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_0_series_pantof_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_0_series_pantob_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_0_series_pantof_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_0_series_pantob_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_0_series_pantof_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_0_series_pantob_922, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/0_series/gfx/922_series.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_pantof_ydp, current_year) {2002..9999: ss_frt_0_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_pantof_2cc_mask, cargo_subtype) {0:sw_frt_0_series_pantof_ydp; 3:ss_frt_0_series_pantof_2cc; 4:ss_frt_0_series_pantof_2cc; 5:ss_frt_0_series_pantof_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_pantof_irl;       	    // Base for Front
				1: ss_frt_0_series_pantof_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_0_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_pantof_ydp, current_year) {2002..9999: ss_mid_0_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_pantof_2cc_mask, cargo_subtype) {0:sw_mid_0_series_pantof_ydp; 3:ss_mid_0_series_pantof_2cc; 4:ss_mid_0_series_pantof_2cc; 5:ss_mid_0_series_pantof_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_pantof_irl, HideLongSprite() ) { 0: ss_std_0_series_pantof_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_pantof_ydp, current_year) {2002..9999: ss_std_0_series_pantof_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_pantof_2cc_mask, cargo_subtype) {0:sw_std_0_series_pantof_ydp; 3:ss_std_0_series_pantof_2cc; 4:ss_std_0_series_pantof_2cc; 5:ss_std_0_series_pantof_kdm; }
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_pantof_2cc, HideLongSprite() ) { 0: sw_std_0_series_pantof_2cc_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_pantof_irl;       	    // Base for Mid
				1: ss_mid_0_series_pantof_2cc_mask;		    // Mask for Mid
                // Long Sprite
				2: longsprite_0_series_pantof_irl;	        // Base for LongSprite
                3: longsprite_0_series_pantof_2cc;          // Mask for LongSprite
				// Pantos
                4: panto_midsprite_200_f;                  	// Panto for Mid
                5: panto_longsprite_200_f;                 	// Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_pantof_ydp, current_year) {2002..9999: ss_bck_0_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_pantof_2cc_mask, cargo_subtype) {0:sw_bck_0_series_pantof_ydp; 3:ss_bck_0_series_pantof_2cc; 4:ss_bck_0_series_pantof_2cc; 5:ss_bck_0_series_pantof_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_pantof_irl;       	    // Base for Front
				1: ss_bck_0_series_pantof_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_0_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_pantof, position_in_consist % 3 ) {				
            0: sw_0_series_pantof_frt_longsprite;
            1: sw_0_series_pantof_mid_stack;
            2: sw_0_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_0_series_pantob_ydp, current_year) {2002..9999: ss_frt_0_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_0_series_pantob_2cc_mask, cargo_subtype) {0:sw_frt_0_series_pantob_ydp; 3:ss_frt_0_series_pantob_2cc; 4:ss_frt_0_series_pantob_2cc; 5:ss_frt_0_series_pantob_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_0_series_pantob_irl;       	    // Base for Front
				1: ss_frt_0_series_pantob_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_0_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_0_series_pantob_ydp, current_year) {2002..9999: ss_mid_0_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_0_series_pantob_2cc_mask, cargo_subtype) {0:sw_mid_0_series_pantob_ydp; 3:ss_mid_0_series_pantob_2cc; 4:ss_mid_0_series_pantob_2cc; 5:ss_mid_0_series_pantob_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_0_series_pantob_irl, HideLongSprite() ) { 0: ss_std_0_series_pantob_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_0_series_pantob_ydp, current_year) {2002..9999: ss_std_0_series_pantob_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_0_series_pantob_2cc_mask, cargo_subtype) {0:sw_std_0_series_pantob_ydp; 3:ss_std_0_series_pantob_2cc; 4:ss_std_0_series_pantob_2cc; 5:ss_std_0_series_pantob_kdm; }
                
                switch(FEAT_TRAINS, SELF, longsprite_0_series_pantob_2cc, HideLongSprite() ) { 0: sw_std_0_series_pantob_2cc_mask; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_pantob_irl;       	    // Base for Mid
				1: ss_mid_0_series_pantob_2cc_mask;		    // Mask for Mid
                // Long Sprite
				2: longsprite_0_series_pantob_irl;	        // Base for LongSprite
                3: longsprite_0_series_pantob_2cc;          // Mask for LongSprite
				// Pantos
                4: panto_midsprite_200_b;                  	// Panto for Mid
                5: panto_longsprite_200_b;                 	// Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_0_series_pantob_ydp, current_year) {2002..9999: ss_bck_0_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_0_series_pantob_2cc_mask, cargo_subtype) {0:sw_bck_0_series_pantob_ydp; 3:ss_bck_0_series_pantob_2cc; 4:ss_bck_0_series_pantob_2cc; 5:ss_bck_0_series_pantob_kdm; }

		switch(FEAT_TRAINS, SELF, sw_0_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_0_series_pantob_irl;       	    // Base for Front
				1: ss_bck_0_series_pantob_2cc_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_0_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_0_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_0_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_0_series_pantob_frt_longsprite;
            1: sw_0_series_pantob_mid_stack;
            2: sw_0_series_pantob_bck_longsprite;
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_formations.pnml" 1

/* Midcars */

    switch (FEAT_TRAINS, SELF, sw_0_series_backwards, EvenCarBackward() ) {				
            1:  sw_0_series_pantob;
            sw_0_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_0_series_forwards, EvenCarForward() ) {				
            1:  sw_0_series_pantof;
            sw_0_series_coachf;				
        }

    switch (FEAT_TRAINS, PARENT, sw_0_series_midcars, vehicle_is_reversed) {				
            0:  sw_0_series_forwards;
            sw_0_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_0_series_rear, vehicle_is_reversed) {				
            1: sw_0_series_cab01b;
            sw_0_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_0_series_lead, vehicle_is_reversed) {				
            1: sw_0_series_cab02b;
            sw_0_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_0_series_cabs, position_in_consist) {				
            0..2: sw_0_series_lead;
            sw_0_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_0_series_graphics, IsCab() ) {				
            1:  sw_0_series_cabs;
            sw_0_series_midcars;	
        }
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "src/trains/0_series/0_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_0_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_0;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/* SPEED */
    switch (FEAT_TRAINS, SELF, sw_0_series_speed, current_year) {
	    0..1986: return 210;                        // Until 1986, Speed = 210 km/h
	    return 220;                                 // After 1986, Speed = 220 km/h
    }

item(FEAT_TRAINS, series_0) {
	property {
		/* Menu */
        name: 							string(STR_NAME_0_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     1987 - 1964;		        // Constructed until 1986, in service to 2008
		vehicle_life:                   30;							// Same as JapanSet
        track_type:                     SHINKANSEN;
		/* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;                         // Changed by callback						
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
        power:                          8050 kW;	                // Changed by callback				
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_0_SERIES);
        cargo_subtype_text:             sw_0_series_year_dep_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                61;
        purchase_power:                 248 * 4;
        /* Graphics */
        default:                        sw_0_series_graphics;
		purchase:                       sw_0_series_purchase;
		articulated_part:               sw_0_series_articulated_part;
        visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
        length:                        	sw_length_1_8_1;
        speed:							sw_0_series_speed;
		weight:                         NumberCarsInConsist() * 61;
        power:                          NumberCarsInConsist() * 248 * 4;	// 185 kW
        cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
        cost_factor:                    125;
		running_cost_factor:            (300 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_0_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_0_series_running_costs;
      }
}
# 1 "src/trains/0_series/0_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/0_series/922_series.pnml" 1
// cab01

	// Forwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_cab01f_frt_longsprite, NextPartSame() ) {1:ss_frt_0_series_cab01f_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01f_922, HideLongSprite() ) { 0: ss_std_0_series_cab01f_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab01f_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_cab01f_922;	        // Base for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_cab01f_bck_longsprite, PrevPartSame() ) { 1:ss_bck_0_series_cab01f_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_cab01f, position_in_consist % 3 ) {				
            0: sw_922_series_cab01f_frt_longsprite;
            1: sw_922_series_cab01f_mid_stack;
            2: sw_922_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_cab01b_frt_longsprite, PrevPartSame() ) {1:ss_frt_0_series_cab01b_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_cab01b_922, HideLongSprite() ) { 0: ss_std_0_series_cab01b_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab01b_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_cab01b_922;	        // Base for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_cab01b_bck_longsprite, NextPartSame() ) { 1:ss_bck_0_series_cab01b_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_922_series_cab01b_frt_longsprite;
            1: sw_922_series_cab01b_mid_stack;
            2: sw_922_series_cab01b_bck_longsprite;
        }

// cab02

	// Forwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_cab02f_frt_longsprite, PrevPartSame() ) {1:ss_frt_0_series_cab02f_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02f_922, HideLongSprite() ) { 0: ss_std_0_series_cab02f_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab02f_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_cab02f_922;	        // Base for LongSprite
				// Pantos
                2: panto_midsprite_0_series_cab02f;         // Panto for Mid
                3: panto_longsprite_0_series_cab02f;        // Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_cab02f_bck_longsprite, NextPartSame() ) { 1:ss_bck_0_series_cab02f_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_922_series_cab02f_frt_longsprite;
            1: sw_922_series_cab02f_mid_stack;
            2: sw_922_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_cab02b_frt_longsprite, NextPartSame() ) {1:ss_frt_0_series_cab02b_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_cab02b_922, HideLongSprite() ) { 0: ss_std_0_series_cab02b_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_cab02b_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_cab02b_922;	        // Base for LongSprite
				// Pantos
                2: panto_midsprite_0_series_cab02b;         // Panto for Mid
                3: panto_longsprite_0_series_cab02b;        // Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_cab02b_bck_longsprite, PrevPartSame() ) { 1:ss_bck_0_series_cab02b_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_cab02b, position_in_consist % 3 ) {				
            0: sw_922_series_cab02b_frt_longsprite;
            1: sw_922_series_cab02b_mid_stack;
            2: sw_922_series_cab02b_bck_longsprite;
        }		

// coach

	// Forwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_coachf_frt_longsprite, NextPartSame() ) {1:ss_frt_0_series_coachf_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_coachf_922, HideLongSprite() ) { 0: ss_std_0_series_coachf_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_coachf_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_coachf_922;	        // Base for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_coachf_bck_longsprite, PrevPartSame() ) { 1:ss_bck_0_series_coachf_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_coachf, position_in_consist % 3 ) {				
            0: sw_922_series_coachf_frt_longsprite;
            1: sw_922_series_coachf_mid_stack;
            2: sw_922_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_coachb_frt_longsprite, PrevPartSame() ) {1:ss_frt_0_series_coachb_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_coachb_922, HideLongSprite() ) { 0: ss_std_0_series_coachb_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_coachb_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_coachb_922;	        // Base for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_coachb_bck_longsprite, NextPartSame() ) { 1:ss_bck_0_series_coachb_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_922_series_coachb_frt_longsprite;
            1: sw_922_series_coachb_mid_stack;
            2: sw_922_series_coachb_bck_longsprite;
        }

// panto

	// Forwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_pantof_frt_longsprite, NextPartSame() ) {1:ss_frt_0_series_pantof_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_pantof_922, HideLongSprite() ) { 0: ss_std_0_series_pantof_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_pantof_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_pantof_922;	        // Base for LongSprite
				// Pantos
                2: panto_midsprite_200_f;                  	// Panto for Mid
                3: panto_longsprite_200_f;                 	// Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_pantof_bck_longsprite, PrevPartSame() ) { 1:ss_bck_0_series_pantof_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_pantof, position_in_consist % 3 ) {				
            0: sw_922_series_pantof_frt_longsprite;
            1: sw_922_series_pantof_mid_stack;
            2: sw_922_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_922_series_pantob_frt_longsprite, PrevPartSame() ) {1:ss_frt_0_series_pantob_922; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, SELF, longsprite_0_series_pantob_922, HideLongSprite() ) { 0: ss_std_0_series_pantob_922; }   

		switch(FEAT_TRAINS, SELF, sw_922_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_0_series_pantob_922;       	    // Base for Mid
                // Long Sprite
				1: longsprite_0_series_pantob_922;	        // Base for LongSprite
				// Pantos
                2: panto_midsprite_200_b;                  	// Panto for Mid
                3: panto_longsprite_200_b;                 	// Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_922_series_pantob_bck_longsprite, NextPartSame() ) { 1:ss_bck_0_series_pantob_922; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_922_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_922_series_pantob_frt_longsprite;
            1: sw_922_series_pantob_mid_stack;
            2: sw_922_series_pantob_bck_longsprite;
        }

/* FORMATIONS */

	switch (FEAT_TRAINS, SELF, sw_922_series_backwards, EvenCarBackward() ) {				
			1:  sw_922_series_pantob;
			sw_922_series_coachb;				
		}

	switch (FEAT_TRAINS, SELF, sw_922_series_forwards, EvenCarForward() ) {				
			1:  sw_922_series_pantof;
			sw_922_series_coachf;				
		}

	switch (FEAT_TRAINS, PARENT, sw_922_series_midcars, vehicle_is_reversed) {				
			0:  sw_922_series_forwards;
			sw_922_series_backwards;				
		}

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_922_series_rear, vehicle_is_reversed) {				
            1: sw_922_series_cab01b;
            sw_922_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_922_series_lead, vehicle_is_reversed) {				
            1: sw_922_series_cab02b;
            sw_922_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_922_series_cabs, position_in_consist) {				
            0..2: sw_922_series_lead;
            sw_922_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_922_series_graphics, IsCab() ) {				
            1:  sw_922_series_cabs;
            sw_922_series_midcars;	
        }

switch (FEAT_TRAINS, SELF, sw_922_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_922;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Running Cost Factor---*/
switch (FEAT_TRAINS, PARENT, sw_922_series_running_cost_factor, param_dryellow ) {				
		1: (150 + 60 * NumberCarsInConsist() ) * RunningCostFactor();		// Mail
		2: (300 + 125 * NumberCarsInConsist() ) * RunningCostFactor();		// Passengers
		return 0;			
	}

/* SPEED */
    switch (FEAT_TRAINS, SELF, sw_922_series_speed, current_year) {
	    0..1986: return 210;                        // Until 1986, Speed = 210 km/h
	    return 220;                                 // After 1986, Speed = 220 km/h
    }

if (param_dryellow == 0) { // GIMMICK

item(FEAT_TRAINS, series_922) {
	property {
		/* Menu */
        name: 							string(STR_NAME_922_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        variant_group:					123;
        /* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     1987 - 1964;		        // Constructed until 1986, in service to 2008
		vehicle_life:                   30;							// Same as JapanSet
        track_type:                     SHINKANSEN;
        extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
		/* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;                         // Changed by callback						
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
        power:                          8050 kW;	                // Changed by callback				
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_922_SERIES_GIMMICK);
        //cargo_subtype_text:             sw_922_series_year_dep_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                61;
        purchase_power:                 248 * 4;
        /* Graphics */
        default:                        sw_922_series_graphics;
		purchase:                       sw_922_series_purchase;
		articulated_part:               sw_922_series_articulated_part;
        visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
        length:                        	sw_length_1_8_1;
        speed:							sw_922_series_speed;
		weight:                         NumberCarsInConsist() * 61;
        power:                          NumberCarsInConsist() * 248 * 4;	// 185 kW
        cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
        cost_factor:                    125;
		running_cost_factor:            0;
		purchase_running_cost_factor:   0;
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_922_series_graphics;
        cargo_capacity:                 0;
        cargo_age_period:				param_decay_express;
        loading_speed:					25;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
        running_cost_factor:            0;
      }
}}

// MAIL
if (param_dryellow == 1) {

item(FEAT_TRAINS, series_922) {
	property {
		/* Menu */
        name: 							string(STR_NAME_922_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        variant_group:					123;
        /* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     1987 - 1964;		        // Constructed until 1986, in service to 2008
		vehicle_life:                   30;							// Same as JapanSet
        track_type:                     SHINKANSEN;
        extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
		/* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_MAIL);
		refit_cost:                     0;
		default_cargo_type:             MAIL;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;                         // Changed by callback						
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
        power:                          8050 kW;	                // Changed by callback				
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_922_SERIES_MAIL);
        //cargo_subtype_text:             sw_922_series_year_dep_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                61;
        purchase_power:                 248 * 4;
        /* Graphics */
        default:                        sw_922_series_graphics;
		purchase:                       sw_922_series_purchase;
		articulated_part:               sw_922_series_articulated_part;
        visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
        length:                        	sw_length_1_8_1;
        speed:							sw_922_series_speed;
		weight:                         NumberCarsInConsist() * 61;
        power:                          NumberCarsInConsist() * 248 * 4;	// 185 kW
        cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
        cost_factor:                    125;
		running_cost_factor:            sw_922_series_running_cost_factor;
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_922_series_graphics;
        cargo_capacity:                 40 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					40 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
      }
}}

// PASSENGERS
if (param_dryellow == 2)  {

item(FEAT_TRAINS, series_922) {
	property {
		/* Menu */
        name: 							string(STR_NAME_922_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        variant_group:					123;
        /* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     1987 - 1964;		        // Constructed until 1986, in service to 2008
		vehicle_life:                   30;							// Same as JapanSet
        track_type:                     SHINKANSEN;
        extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
		/* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;                         // Changed by callback						
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
        power:                          8050 kW;	                // Changed by callback				
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_922_SERIES);
        //cargo_subtype_text:             sw_922_series_year_dep_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                61;
        purchase_power:                 248 * 4;
        /* Graphics */
        default:                        sw_922_series_graphics;
		purchase:                       sw_922_series_purchase;
		articulated_part:               sw_922_series_articulated_part;
        visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
        length:                        	sw_length_1_8_1;
        speed:							sw_922_series_speed;
		weight:                         NumberCarsInConsist() * 61;
        power:                          NumberCarsInConsist() * 248 * 4;	// 185 kW
        cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
        cost_factor:                    125;
		running_cost_factor:            sw_922_series_running_cost_factor;
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_922_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
      }
}}
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/n700_series/n700_series.pnml" 1

# 1 "src/trains/n700_series/n700_series_menu.pnml" 1

/*---Cargo Subtype Menu---*/

    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text, cargo_subtype) {
        0: return string(LV_N700_SERIES_N700);          	// N700
        1: return string(LV_N700_SERIES_N700_2CC);          // 2cc
        2: return string(LV_N700_SERIES_KYUSHU);          	// Kyushu
        return CB_RESULT_NO_TEXT;
        }

/* Purchase Menu */

    spriteset (ss_n700_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_n700_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral; 
            1: ss_n700_series_buy;
        }

/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_n700a_series_subtype_text, cargo_subtype) {
		0: return string(LV_N700_SERIES_N700A);                            
		1: return string(LV_N700_SERIES_N700A_2CC);                      
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */

    spriteset (ss_n700a_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_n700a_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral;
            1: ss_n700_series_buy; 
            2: ss_n700a_series_buy;
        }

/*---Cargo Subtype Menu---*/
    switch(FEAT_TRAINS, SELF, sw_n700s_series_subtype_text, cargo_subtype) {
            0: return string(LV_N700_SERIES_N700S);          	// N700
            1: return string(LV_N700_SERIES_N700S_2CC);         // 2cc
		    2: return string(LV_N700_SERIES_KAMOME);          	// Kamome
            3: return string(LV_N700_SERIES_KAMOME_2CC);        // Kamome 2cc
            return CB_RESULT_NO_TEXT;
            }

/* Purchase Menu */

    spriteset (ss_n700s_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_n700s_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral;
            1: ss_n700_series_buy; 
            2: ss_n700s_series_buy;
        }
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_n700_series_cab01f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700_series_cab01b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700_series_cab01f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700_series_cab01b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700_series_cab01f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700_series_cab01b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700_series_cab01f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700_series_cab01b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_rev(1,51)}

    // Kyushu Mask

    // 10/8
    spriteset(ss_std_n700_series_cab01f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700_series_cab01b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700_series_cab01f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700_series_cab01b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700_series_cab01f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700_series_cab01b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700_series_cab01f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700_series_cab01b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_rev(1,51)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_cab01f_mask, cargo_subtype) {1:ss_frt_n700_series_cab01f_2cc; 2:ss_frt_n700_series_cab01f_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01f_irl;       	// Base for Front
				1: ss_frt_n700_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_n700_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_cab01f_mask, cargo_subtype) {1:ss_mid_n700_series_cab01f_2cc; 2:ss_mid_n700_series_cab01f_kyu;}
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_cab01f_mask, cargo_subtype) {1:ss_std_n700_series_cab01f_2cc; 2:ss_std_n700_series_cab01f_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab01f_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_n700_series_cab01f_mask;		    // Mask for Mid
				2: sw_n700_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_cab01f_mask, cargo_subtype) {1:ss_bck_n700_series_cab01f_2cc; 2:ss_bck_n700_series_cab01f_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01f_irl;       	// Base for Front
				1: ss_bck_n700_series_cab01f_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_n700_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_cab01f, position_in_consist % 3 ) {				
            0: sw_n700_series_cab01f_frt_longsprite;
            1: sw_n700_series_cab01f_mid_stack;
            2: sw_n700_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_cab01b_mask, cargo_subtype) {1:ss_frt_n700_series_cab01b_2cc; 2:ss_frt_n700_series_cab01b_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01b_irl;       	// Base for Front
				1: ss_frt_n700_series_cab01b_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_n700_series_cab01b_frt_stack;dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_cab01b_mask, cargo_subtype) {1:ss_mid_n700_series_cab01b_2cc; 2:ss_mid_n700_series_cab01b_kyu; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_cab01b_mask, cargo_subtype) {1:ss_std_n700_series_cab01b_2cc; 2:ss_std_n700_series_cab01b_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab01b_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_n700_series_cab01b_mask;		    // Mask for Mid
				2: sw_n700_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_cab01b_mask, cargo_subtype) {1:ss_bck_n700_series_cab01b_2cc; 2:ss_bck_n700_series_cab01b_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01b_irl;       	// Base for Front
				1: ss_bck_n700_series_cab01b_mask;			// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_n700_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_n700_series_cab01b_frt_longsprite;
            1: sw_n700_series_cab01b_mid_stack;
            2: sw_n700_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_n700_series_cab02f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700_series_cab02b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700_series_cab02f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700_series_cab02b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700_series_cab02f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700_series_cab02b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700_series_cab02f_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700_series_cab02b_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Kyushu Mask

    // 10/8
    spriteset(ss_std_n700_series_cab02f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700_series_cab02b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700_series_cab02f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700_series_cab02b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700_series_cab02f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700_series_cab02b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700_series_cab02f_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700_series_cab02b_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_cab_bck_rev(1,1)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_cab02f_mask, cargo_subtype) {1:ss_frt_n700_series_cab02f_2cc; 2:ss_frt_n700_series_cab02f_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02f_irl;       	// Base for Front
				1: ss_frt_n700_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_n700_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_cab02f_mask, cargo_subtype) {1:ss_mid_n700_series_cab02f_2cc; 2:ss_mid_n700_series_cab02f_kyu;}
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_cab02f_mask, cargo_subtype) {1:ss_std_n700_series_cab02f_2cc; 2:ss_std_n700_series_cab02f_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab02f_irl; }
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_n700_series_cab02f_mask;		    // Mask for Mid
				2: sw_n700_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_cab02f_mask, cargo_subtype) {1:ss_bck_n700_series_cab02f_2cc; 2:ss_bck_n700_series_cab02f_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02f_irl;       	// Base for Front
				1: ss_bck_n700_series_cab02f_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_n700_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_n700_series_cab02f_frt_longsprite;
            1: sw_n700_series_cab02f_mid_stack;
            2: sw_n700_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_cab02b_mask, cargo_subtype) {1:ss_frt_n700_series_cab02b_2cc; 2:ss_frt_n700_series_cab02b_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02b_irl;       	// Base for Front
				1: ss_frt_n700_series_cab02b_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_n700_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_cab02b_mask, cargo_subtype) {1:ss_mid_n700_series_cab02b_2cc; 2:ss_mid_n700_series_cab02b_kyu; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_cab02b_mask, cargo_subtype) {1:ss_std_n700_series_cab02b_2cc; 2:ss_std_n700_series_cab02b_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_cab02b_mask;}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_n700_series_cab02b_mask;		    // Mask for Mid
				2: sw_n700_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_cab02b_mask, cargo_subtype) {1:ss_bck_n700_series_cab02b_2cc; 2:ss_bck_n700_series_cab02b_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02b_irl;       	// Base for Front
				1: ss_bck_n700_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_n700_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_cab02b, position_in_consist % 3 ) {				
            0: sw_n700_series_cab02b_frt_longsprite;
            1: sw_n700_series_cab02b_mid_stack;
            2: sw_n700_series_cab02b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_n700_series_coachf_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_coachb_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_coachf_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_coachb_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_coachf_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_coachb_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_coachf_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_coachb_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_rev(1,101)}

    // Kyushu Mask

    // 10/8
    spriteset(ss_std_n700_series_coachf_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_coachb_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_coachf_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_coachb_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_coachf_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_coachb_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_coachf_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_coachb_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_coachf_mask, cargo_subtype) {1:ss_frt_n700_series_coachf_2cc; 2:ss_frt_n700_series_coachf_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_coachf_irl;       	// Base for Front
				1: ss_frt_n700_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_n700_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_coachf_mask, cargo_subtype) {1:ss_mid_n700_series_coachf_2cc; 2:ss_mid_n700_series_coachf_kyu;}
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_coachf_mask, cargo_subtype) {1:ss_std_n700_series_coachf_2cc; 2:ss_std_n700_series_coachf_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_coachf_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_coachf_irl;       	// Base for Mid
				1: ss_mid_n700_series_coachf_mask;		    // Mask for Mid
				2: sw_n700_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_coachf_mask, cargo_subtype) {1:ss_bck_n700_series_coachf_2cc; 2:ss_bck_n700_series_coachf_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_coachf_irl;       	// Base for Front
				1: ss_bck_n700_series_coachf_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_n700_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_coachf, position_in_consist % 3 ) {				
            0: sw_n700_series_coachf_frt_longsprite;
            1: sw_n700_series_coachf_mid_stack;
            2: sw_n700_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_coachb_mask, cargo_subtype) {1:ss_frt_n700_series_coachb_2cc; 2:ss_frt_n700_series_coachb_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_coachb_irl;       	// Base for Front
				1: ss_frt_n700_series_coachb_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_n700_series_coachb_frt_stack;dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_coachb_mask, cargo_subtype) {1:ss_mid_n700_series_coachb_2cc; 2:ss_mid_n700_series_coachb_kyu; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_coachb_mask, cargo_subtype) {1:ss_std_n700_series_coachb_2cc; 2:ss_std_n700_series_coachb_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_coachb_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_coachb_irl;       	// Base for Mid
				1: ss_mid_n700_series_coachb_mask;		    // Mask for Mid
				2: sw_n700_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_n700_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_coachb_mask, cargo_subtype) {1:ss_bck_n700_series_coachb_2cc; 2:ss_bck_n700_series_coachb_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_coachb_irl;       	// Base for Front
				1: ss_bck_n700_series_coachb_mask;			// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_n700_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_n700_series_coachb_frt_longsprite;
            1: sw_n700_series_coachb_mid_stack;
            2: sw_n700_series_coachb_bck_longsprite;
        }
		
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_n700_series_pantof_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_pantob_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_pantof_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_pantob_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_pantof_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_pantob_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_pantof_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_pantob_2cc, "src/trains/n700_series/gfx/n700_2cc.png") {tmpl_bck_rev(1,101)}

    // Kyushu Mask

    // 10/8
    spriteset(ss_std_n700_series_pantof_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700_series_pantob_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700_series_pantof_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700_series_pantob_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700_series_pantof_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700_series_pantob_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700_series_pantof_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700_series_pantob_kyu, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700_kyushu.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_pantof_mask, cargo_subtype) {1:ss_frt_n700_series_pantof_2cc; 2:ss_frt_n700_series_pantof_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_pantof_irl;       	// Base for Front
				1: ss_frt_n700_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_n700_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_pantof_mask, cargo_subtype) {1:ss_mid_n700_series_pantof_2cc; 2:ss_mid_n700_series_pantof_kyu;}
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_pantof_mask, cargo_subtype) {1:ss_std_n700_series_pantof_2cc; 2:ss_std_n700_series_pantof_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantof_irl; }
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_pantof_irl;       	// Base for Mid
				1: ss_mid_n700_series_pantof_mask;		    // Mask for Mid
				2: panto_midsprite_n700_f;		    		// Panto for Mid
				3: sw_n700_series_pantof_mid_longsprite;	// Long Sprite
				4: sw_n700_series_pantof_std_longsprite;	// Long Sprite Mask
				5: panto_longsprite_n700_f;					// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_pantof_mask, cargo_subtype) {1:ss_bck_n700_series_pantof_2cc; 2:ss_bck_n700_series_pantof_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_pantof_irl;       	// Base for Front
				1: ss_bck_n700_series_pantof_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_n700_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_pantof, position_in_consist % 3 ) {				
            0: sw_n700_series_pantof_frt_longsprite;
            1: sw_n700_series_pantof_mid_stack;
            2: sw_n700_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700_series_pantob_mask, cargo_subtype) {1:ss_frt_n700_series_pantob_2cc; 2:ss_frt_n700_series_pantob_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_pantob_irl;       	// Base for Front
				1: ss_frt_n700_series_pantob_mask;		    // Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_frt_longsprite, PrevPartSame()  ) { 1: sw_n700_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700_series_pantob_mask, cargo_subtype) {1:ss_mid_n700_series_pantob_2cc; 2:ss_mid_n700_series_pantob_kyu; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700_series_pantob_mask, cargo_subtype) {1:ss_std_n700_series_pantob_2cc; 2:ss_std_n700_series_pantob_kyu; }
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantob_irl; }
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_std_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantob_mask; }

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_pantob_irl;       	// Base for Mid
				1: ss_mid_n700_series_pantob_mask;		    // Mask for Mid
				2: panto_midsprite_n700_b;		    		// Panto for Mid
				3: sw_n700_series_pantob_mid_longsprite;	// Long Sprite
				4: sw_n700_series_pantob_std_longsprite;	// Long Sprite Mask
				5: panto_longsprite_n700_b;					// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700_series_pantob_mask, cargo_subtype) {1:ss_bck_n700_series_pantob_2cc; 2:ss_bck_n700_series_pantob_kyu;}
		
		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_pantob_irl;       	// Base for Front
				1: ss_bck_n700_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_n700_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_n700_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_n700_series_pantob_frt_longsprite;
            1: sw_n700_series_pantob_mid_stack;
            2: sw_n700_series_pantob_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700a_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700a_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700a_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700a_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700a_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700a_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700a_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700a_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700a_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01f_irl;       	// N700 base for Front
                1: ss_frt_n700_series_cab01f_mask;		    // 2cc mask for Front
                2: ss_frt_n700a_series_cab01f_irl;          // N700A mask for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_n700a_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700a_series_cab01f_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab01f_irl;       	// N700 base for Mid
                1: ss_mid_n700_series_cab01f_mask;		    // 2cc mask for Mid
                2: ss_mid_n700a_series_cab01f_irl;       	// N700A mask for Mid
                3: sw_n700_series_cab01f_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700_series_cab01f_std_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700a_series_cab01f_mid_longsprite;   // N700A Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01f_irl;       	// N700 base for Back
				1: ss_bck_n700_series_cab01f_mask;		    // Mask for Back
                2: ss_bck_n700a_series_cab01f_irl;          // N700A mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_n700a_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700a_series_cab01f, position_in_consist % 3 ) {				
            0: sw_n700a_series_cab01f_frt_longsprite;
            1: sw_n700a_series_cab01f_mid_stack;
            2: sw_n700a_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01b_irl;       	// N700 base for Front
                1: ss_frt_n700_series_cab01b_mask;		    // 2cc mask for Front
                2: ss_frt_n700a_series_cab01b_irl;          // N700A mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_n700a_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700a_series_cab01b_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab01b_irl;       	// N700 base for Mid
                1: ss_mid_n700_series_cab01b_mask;		    // 2cc mask for Mid
                2: ss_mid_n700a_series_cab01b_irl;       	// N700A mask for Mid
                3: sw_n700_series_cab01b_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700_series_cab01b_std_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700a_series_cab01b_mid_longsprite;   // N700A Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01b_irl;       	// N700 base for Back
				1: ss_bck_n700_series_cab01b_mask;		    // Mask for Back
                2: ss_bck_n700a_series_cab01b_irl;          // N700A mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_n700a_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700a_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_n700a_series_cab01b_frt_longsprite;
            1: sw_n700a_series_cab01b_mid_stack;
            2: sw_n700a_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700a_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_n700a_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700a_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700a_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700a_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700a_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700a_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700a_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700a_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700a.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02f_irl;       	// N700 base for Front
                1: ss_frt_n700_series_cab02f_mask;		    // 2cc mask for Front
                2: ss_frt_n700a_series_cab02f_irl;          // N700A mask for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_n700a_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700a_series_cab02f_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab02f_irl;       	// N700 base for Mid
                1: ss_mid_n700_series_cab02f_mask;		    // 2cc mask for Mid
                2: ss_mid_n700a_series_cab02f_irl;       	// N700A mask for Mid
                3: sw_n700_series_cab02f_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700_series_cab02f_std_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700a_series_cab02f_mid_longsprite;   // N700A Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02f_irl;       	// N700 base for Back
				1: ss_bck_n700_series_cab02f_mask;		    // Mask for Back
                2: ss_bck_n700a_series_cab02f_irl;          // N700A mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_n700a_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700a_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_n700a_series_cab02f_frt_longsprite;
            1: sw_n700a_series_cab02f_mid_stack;
            2: sw_n700a_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02b_irl;       	// N700 base for Front
                1: ss_frt_n700_series_cab02b_mask;		    // 2cc mask for Front
                2: ss_frt_n700a_series_cab02b_irl;          // N700A mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_n700a_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_n700a_series_cab02b_irl; }

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_n700_series_cab02b_irl;       	// N700 base for Mid
                1: ss_mid_n700_series_cab02b_mask;		    // 2cc mask for Mid
                2: ss_mid_n700a_series_cab02b_irl;       	// N700A mask for Mid
                3: sw_n700_series_cab02b_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700_series_cab02b_std_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700a_series_cab02b_mid_longsprite;   // N700A Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02b_irl;       	// N700 base for Back
				1: ss_bck_n700_series_cab02b_mask;		    // Mask for Back
                2: ss_bck_n700a_series_cab02b_irl;          // N700A mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700a_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_n700a_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700a_series_cab02b, position_in_consist % 3 ) {				
            0: sw_n700a_series_cab02b_frt_longsprite;
            1: sw_n700a_series_cab02b_mid_stack;
            2: sw_n700a_series_cab02b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700s_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// S Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700s_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700s_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700s_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700s_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700s_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700s_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700s_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_rev(1,51)}

	// Kamome Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab01f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700s_series_cab01b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700s_series_cab01f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700s_series_cab01b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700s_series_cab01f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700s_series_cab01b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700s_series_cab01f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700s_series_cab01b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_rev(1,51)}

	// Kamome 2cc Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab01f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_n700s_series_cab01b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_n700s_series_cab01f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_n700s_series_cab01b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_n700s_series_cab01f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_n700s_series_cab01b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_n700s_series_cab01f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_n700s_series_cab01b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab01f_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab01f_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_cab01f_irl; 2: ss_frt_n700s_series_cab01f_kam; 3: ss_frt_n700s_series_cab01f_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01f_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_cab01f_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_cab01f_sss_mask;     // N700s masks for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_frt_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_cab01f_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab01f_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab01f_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_cab01f_irl; 2: ss_mid_n700s_series_cab01f_kam; 3: ss_mid_n700s_series_cab01f_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab01f_2cc_mask, cargo_subtype) {1: ss_std_n700_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab01f_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_cab01f_irl; 2: ss_std_n700s_series_cab01f_kam; 3: ss_std_n700s_series_cab01f_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab01f_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab01f_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_cab01f_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_cab01f_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_cab01f_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_cab01f_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_cab01f_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_cab01f_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab01f_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab01f_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_cab01f_irl; 2: ss_bck_n700s_series_cab01f_kam; 3: ss_bck_n700s_series_cab01f_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01f_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_cab01f_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_cab01f_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01f_bck_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_cab01f_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_cab01f, position_in_consist % 3 ) {				
            0: sw_n700s_series_cab01f_frt_longsprite;
            1: sw_n700s_series_cab01f_mid_stack;
            2: sw_n700s_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab01b_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab01b_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_cab01b_irl; 2: ss_frt_n700s_series_cab01b_kam; 3: ss_frt_n700s_series_cab01b_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab01b_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_cab01b_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_cab01b_sss_mask;    	// n700s mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_frt_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_cab01b_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab01b_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab01b_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_cab01b_irl; 2: ss_mid_n700s_series_cab01b_kam; 3: ss_mid_n700s_series_cab01b_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab01b_2cc_mask, cargo_subtype) {1: ss_std_n700_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab01b_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_cab01b_irl; 2: ss_std_n700s_series_cab01b_kam; 3: ss_std_n700s_series_cab01b_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab01b_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab01b_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_cab01b_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_cab01b_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_cab01b_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_cab01b_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_cab01b_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_cab01b_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab01b_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab01b_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_cab01b_irl; 2: ss_bck_n700s_series_cab01b_kam; 3: ss_bck_n700s_series_cab01b_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab01b_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_cab01b_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_cab01b_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab01b_bck_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0  && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_cab01b_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_n700s_series_cab01b_frt_longsprite;
            1: sw_n700s_series_cab01b_mid_stack;
            2: sw_n700s_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700s_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// S Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700s_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700s_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700s_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700s_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700s_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700s_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700s_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_cab_bck_rev(1,1)}

	// Kamome Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab02f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700s_series_cab02b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700s_series_cab02f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700s_series_cab02b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700s_series_cab02f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700s_series_cab02b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700s_series_cab02f_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700s_series_cab02b_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_cab_bck_rev(1,1)}

	// Kamome 2cc Mask

	// 10/8
	spriteset(ss_std_n700s_series_cab02f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_n700s_series_cab02b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_n700s_series_cab02f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_n700s_series_cab02b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_n700s_series_cab02f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_n700s_series_cab02b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_n700s_series_cab02f_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_n700s_series_cab02b_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab02f_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab02f_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_cab02f_irl; 2: ss_frt_n700s_series_cab02f_kam; 3: ss_frt_n700s_series_cab02f_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02f_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_cab02f_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_cab02f_sss_mask;     // N700s masks for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_frt_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_cab02f_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab02f_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab02f_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_cab02f_irl; 2: ss_mid_n700s_series_cab02f_kam; 3: ss_mid_n700s_series_cab02f_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab02f_2cc_mask, cargo_subtype) {1: ss_std_n700_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab02f_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_cab02f_irl; 2: ss_std_n700s_series_cab02f_kam; 3: ss_std_n700s_series_cab02f_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab02f_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab02f_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_cab02f_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_cab02f_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_cab02f_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_cab02f_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_cab02f_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_cab02f_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab02f_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab02f_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_cab02f_irl; 2: ss_bck_n700s_series_cab02f_kam; 3: ss_bck_n700s_series_cab02f_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02f_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_cab02f_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_cab02f_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02f_bck_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_cab02f_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_n700s_series_cab02f_frt_longsprite;
            1: sw_n700s_series_cab02f_mid_stack;
            2: sw_n700s_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab02b_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_cab02b_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_cab02b_irl; 2: ss_frt_n700s_series_cab02b_kam; 3: ss_frt_n700s_series_cab02b_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_cab02b_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_cab02b_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_cab02b_sss_mask;    	// n700s mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_frt_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_cab02b_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab02b_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_cab02b_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_cab02b_irl; 2: ss_mid_n700s_series_cab02b_kam; 3: ss_mid_n700s_series_cab02b_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab02b_2cc_mask, cargo_subtype) {1: ss_std_n700_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_cab02b_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_cab02b_irl; 2: ss_std_n700s_series_cab02b_kam; 3: ss_std_n700s_series_cab02b_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab02b_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_cab02b_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_cab02b_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_cab02b_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_cab02b_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_cab02b_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_cab02b_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_cab02b_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab02b_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_cab02b_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_cab02b_irl; 2: ss_bck_n700s_series_cab02b_kam; 3: ss_bck_n700s_series_cab02b_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_cab02b_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_cab02b_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_cab02b_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_cab02b_bck_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0  && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_cab02b_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_cab02b, position_in_consist % 3 ) {				
            0: sw_n700s_series_cab02b_frt_longsprite;
            1: sw_n700s_series_cab02b_mid_stack;
            2: sw_n700s_series_cab02b_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700s_series_coach.pnml" 1

/* coach */

// Sprites

	// S Mask

	// 10/8
	spriteset(ss_std_n700s_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_rev(1,101)}

	// Kamome Mask

	// 10/8
	spriteset(ss_std_n700s_series_coachf_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_coachb_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_coachf_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_coachb_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_coachf_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_coachb_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_coachf_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_coachb_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_rev(1,101)}

	// Kamome 2cc Mask

	// 10/8
	spriteset(ss_std_n700s_series_coachf_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_coachb_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_coachf_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_coachb_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_coachf_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_coachb_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_coachf_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_coachb_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_coachf_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_coachf_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_coachf_irl; 2: ss_frt_n700s_series_coachf_kam; 3: ss_frt_n700s_series_coachf_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_coachf_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_coachf_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_coachf_sss_mask;     // N700s masks for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_frt_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_coachf_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_coachf_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_coachf_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_coachf_irl; 2: ss_mid_n700s_series_coachf_kam; 3: ss_mid_n700s_series_coachf_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_coachf_2cc_mask, cargo_subtype) {1: ss_std_n700_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_coachf_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_coachf_irl; 2: ss_std_n700s_series_coachf_kam; 3: ss_std_n700s_series_coachf_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_coachf_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_coachf_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_coachf_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_coachf_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_coachf_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_coachf_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_coachf_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_coachf_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_coachf_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_coachf_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_coachf_irl; 2: ss_bck_n700s_series_coachf_kam; 3: ss_bck_n700s_series_coachf_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_coachf_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_coachf_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_coachf_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachf_bck_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_coachf_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_coachf, position_in_consist % 3 ) {				
            0: sw_n700s_series_coachf_frt_longsprite;
            1: sw_n700s_series_coachf_mid_stack;
            2: sw_n700s_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_coachb_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_coachb_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_coachb_irl; 2: ss_frt_n700s_series_coachb_kam; 3: ss_frt_n700s_series_coachb_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_coachb_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_coachb_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_coachb_sss_mask;    	// n700s mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_frt_longsprite, other_veh_curv_info(-1) == 0 && other_veh_z_offset(-1) == 0 && other_veh_z_offset(-2) == 0 ) {
				1: sw_n700s_series_coachb_frt_stack;
					dummy_sprites;		   	
			}

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_coachb_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_coachb_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_coachb_irl; 2: ss_mid_n700s_series_coachb_kam; 3: ss_mid_n700s_series_coachb_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_coachb_2cc_mask, cargo_subtype) {1: ss_std_n700_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_coachb_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_coachb_irl; 2: ss_std_n700s_series_coachb_kam; 3: ss_std_n700s_series_coachb_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_2cc_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_coachb_2cc_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_sss_longsprite, other_veh_curv_info(1) == 0 && other_veh_curv_info(-1) == 0 && other_veh_z_offset(1) == 0 && other_veh_z_offset(-1) == 0 ) {
					0: ss_std_n700s_series_coachb_sss_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_coachb_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_coachb_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_coachb_sss_mask;     // n700s mask for Mid
				// Long Sprite
                3: sw_n700_series_coachb_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				4: sw_n700s_series_coachb_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				5: sw_n700s_series_coachb_sss_longsprite;   // n700s Long Sprite mask for Mid
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_coachb_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_coachb_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_coachb_irl; 2: ss_bck_n700s_series_coachb_kam; 3: ss_bck_n700s_series_coachb_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_coachb_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_coachb_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_coachb_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_coachb_bck_longsprite, other_veh_curv_info(1) == 0 && other_veh_z_offset(1) == 0  && other_veh_z_offset(2) == 0 ) {
				1: sw_n700s_series_coachb_bck_stack;
					dummy_sprites;		   	
			}

		switch (FEAT_TRAINS, SELF, sw_n700s_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_n700s_series_coachb_frt_longsprite;
            1: sw_n700s_series_coachb_mid_stack;
            2: sw_n700s_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700s_series_panto.pnml" 1

/* panto */

// Sprites

	// S Mask

	// 10/8
	spriteset(ss_std_n700s_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/n700s.png") {tmpl_bck_rev(1,101)}

	// Kamome Mask

	// 10/8
	spriteset(ss_std_n700s_series_pantof_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_pantob_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_pantof_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_pantob_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_pantof_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_pantob_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_pantof_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_pantob_kam, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/n700_series/gfx/kamome.png") {tmpl_bck_rev(1,101)}

	// Kamome 2cc Mask

	// 10/8
	spriteset(ss_std_n700s_series_pantof_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_n700s_series_pantob_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_n700s_series_pantof_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_n700s_series_pantob_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_n700s_series_pantof_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_n700s_series_pantob_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_n700s_series_pantof_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_n700s_series_pantob_k2c, "src/trains/n700_series/gfx/kamome_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front	
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_pantof_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_pantof_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_pantof_irl; 2: ss_frt_n700s_series_pantof_kam; 3: ss_frt_n700s_series_pantof_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_pantof_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_pantof_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_pantof_sss_mask;     // N700s masks for Front     
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_n700s_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_pantof_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_pantof_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_pantof_irl; 2: ss_mid_n700s_series_pantof_kam; 3: ss_mid_n700s_series_pantof_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_pantof_2cc_mask, cargo_subtype) {1: ss_std_n700_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_pantof_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_pantof_irl; 2: ss_std_n700s_series_pantof_kam; 3: ss_std_n700s_series_pantof_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_2cc_longsprite, HideLongSprite() ) { 0: ss_std_n700s_series_pantof_2cc_mask; }
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_sss_longsprite, HideLongSprite() ) { 0: ss_std_n700s_series_pantof_sss_mask; }
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_ptg_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantof_ptg; }

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_pantof_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_pantof_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_pantof_sss_mask;     // n700s mask for Mid
                3: panto_midsprite_n700_f;		    		// Panto for Mid
				// Long Sprite
                4: sw_n700_series_pantof_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				5: sw_n700s_series_pantof_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				6: sw_n700s_series_pantof_sss_longsprite;   // n700s Long Sprite mask for Mid
                7: sw_n700s_series_pantof_ptg_longsprite;	// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_pantof_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_pantof_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_pantof_irl; 2: ss_bck_n700s_series_pantof_kam; 3: ss_bck_n700s_series_pantof_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_pantof_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_pantof_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_pantof_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_n700s_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700s_series_pantof, position_in_consist % 3 ) {				
            0: sw_n700s_series_pantof_frt_longsprite;
            1: sw_n700s_series_pantof_mid_stack;
            2: sw_n700s_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_pantob_2cc_mask, cargo_subtype) {1: ss_frt_n700_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_n700s_series_pantob_sss_mask, cargo_subtype) {0..1: ss_frt_n700s_series_pantob_irl; 2: ss_frt_n700s_series_pantob_kam; 3: ss_frt_n700s_series_pantob_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_n700_series_pantob_irl;       	// N700 base for Front
                1: ss_frt_n700s_series_pantob_2cc_mask;		// 2cc mask for Front
                2: ss_frt_n700s_series_pantob_sss_mask;    	// n700s mask for Front  
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_n700s_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_pantob_2cc_mask, cargo_subtype) {1: ss_mid_n700_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_mid_n700s_series_pantob_sss_mask, cargo_subtype) {0..1: ss_mid_n700s_series_pantob_irl; 2: ss_mid_n700s_series_pantob_kam; 3: ss_mid_n700s_series_pantob_k2c;}

		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_pantob_2cc_mask, cargo_subtype) {1: ss_std_n700_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_n700s_series_pantob_sss_mask, cargo_subtype) {0..1: ss_std_n700s_series_pantob_irl; 2: ss_std_n700s_series_pantob_kam; 3: ss_std_n700s_series_pantob_k2c;}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_2cc_longsprite, HideLongSprite() ) { 0: ss_std_n700s_series_pantob_2cc_mask; }
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_sss_longsprite, HideLongSprite() ) { 0: ss_std_n700s_series_pantob_sss_mask; }
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_ptg_longsprite, HideLongSprite() ) { 0: ss_std_n700_series_pantob_ptg; }
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
				0: ss_mid_n700_series_pantob_irl;       	// N700 base for Mid
                1: ss_mid_n700s_series_pantob_2cc_mask;		// 2cc mask for Mid
                2: ss_mid_n700s_series_pantob_sss_mask;     // n700s mask for Mid
                3: panto_midsprite_n700_b;		    		// Panto for Mid
				// Long Sprite
                4: sw_n700_series_pantob_mid_longsprite;	// N700 base Long Sprite for Corners and Hills
				5: sw_n700s_series_pantob_2cc_longsprite;	// 2cc mask Long Sprite for Corners and Hills
				6: sw_n700s_series_pantob_sss_longsprite;   // n700s Long Sprite mask for Mid
                7: sw_n700s_series_pantob_ptg_longsprite;	// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_pantob_2cc_mask, cargo_subtype) {1: ss_bck_n700_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_n700s_series_pantob_sss_mask, cargo_subtype) {0..1: ss_bck_n700s_series_pantob_irl; 2: ss_bck_n700s_series_pantob_kam; 3: ss_bck_n700s_series_pantob_k2c;}
		
		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_n700_series_pantob_irl;       	// N700 base for Back
				1: ss_bck_n700s_series_pantob_2cc_mask;		// Mask for Back
                2: ss_bck_n700s_series_pantob_sss_mask;     // n700s mask for Back
			}

		switch(FEAT_TRAINS, SELF, sw_n700s_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_n700s_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_n700s_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_n700s_series_pantob_frt_longsprite;
            1: sw_n700s_series_pantob_mid_stack;
            2: sw_n700s_series_pantob_bck_longsprite;
        }
		
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_formations.pnml" 1

// Kamome Formations



// Forwards

     switch (FEAT_TRAINS, SELF, sw_n700_series_forwards_pick_panto_long, CarNumber() == 5 ) {				
            1:  sw_n700_series_pantof;	
            sw_n700_series_pantob;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_forwards_long, CarNumber() == 5 || CarNumberFromEnd()  == 5 ) {				
            1:  sw_n700_series_forwards_pick_panto_long;	
            sw_n700_series_coachf;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_forwards_pick_panto, CarNumber() == 2 ) {				
            1:  sw_n700_series_pantof;	
            sw_n700_series_pantob;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_forwards_penultimates, CarNumber() == 2 || CarNumberFromEnd()  == 2 ) {				
            1:  sw_n700_series_forwards_pick_panto;	
            sw_n700_series_coachf;		
        }

    switch (FEAT_TRAINS, SELF, sw_n700_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_n700_series_pantof;
            sw_n700_series_coachf;				
        }

    switch (FEAT_TRAINS, SELF, sw_n700_series_forwards, num_vehs_in_consist ) {				
            0..17:  sw_n700_series_forwards_panto_in_middle;
            18..39: sw_n700_series_forwards_penultimates;
            sw_n700_series_forwards_long;
        }

// Backwards

    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards_pick_panto_long, CarNumberFromEnd() == 5 ) {				
            1:  sw_n700_series_pantob;	
            sw_n700_series_pantof;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards_long, CarNumber() == 5 || CarNumberFromEnd()  == 5 ) {				
            1:  sw_n700_series_backwards_pick_panto_long;	
            sw_n700_series_coachb;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards_pick_panto, CarNumberFromEnd() == 2 ) {				
            1:  sw_n700_series_pantob;	
            sw_n700_series_pantof;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_n700_series_backwards_pick_panto;
            sw_n700_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_n700_series_pantob;
            sw_n700_series_coachb;
        }

    switch (FEAT_TRAINS, SELF, sw_n700_series_backwards, num_vehs_in_consist ) {				
            0..17: sw_n700_series_backwards_panto_in_middle;
            18..39: sw_n700_series_backwards_penultimates;
            sw_n700_series_backwards_long;
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_n700_series_midcars, vehicle_is_reversed) {				
            0:  sw_n700_series_forwards;
            sw_n700_series_backwards;				
        }

/* Kamome Special Case */

    // Forwards

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_forwards_pick_panto, CarNumber() == 2 ) {				
                1:  sw_n700s_series_pantof;	
                sw_n700s_series_pantob;		
            }
        
        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_forwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
                1:  sw_n700s_series_kamome_forwards_pick_panto;
                sw_n700s_series_coachf;				
            }

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_forwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
                0..1:  sw_n700s_series_pantof;
                sw_n700s_series_coachf;
            }

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_forwards, num_vehs_in_consist ) {				
                0..15: sw_n700s_series_kamome_forwards_panto_in_middle;
                sw_n700s_series_kamome_forwards_penultimates;
            }


    // Backwards

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_backwards_pick_panto, CarNumberFromEnd() == 2 ) {				
                1:  sw_n700s_series_pantob;	
                sw_n700s_series_pantof;		
            }
        
        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_backwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
                1:  sw_n700s_series_kamome_backwards_pick_panto;
                sw_n700s_series_coachb;				
            }

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
                0..1:  sw_n700s_series_pantob;
                sw_n700s_series_coachb;
            }

        switch (FEAT_TRAINS, SELF, sw_n700s_series_kamome_backwards, num_vehs_in_consist ) {				
                0..15: sw_n700s_series_kamome_backwards_panto_in_middle;
                sw_n700s_series_kamome_backwards_penultimates;
            }


        switch (FEAT_TRAINS, PARENT, sw_n700s_series_kamome_midcars, vehicle_is_reversed) {				
                0:  sw_n700s_series_kamome_forwards;
                sw_n700s_series_kamome_backwards;				
            }
                
        switch (FEAT_TRAINS, PARENT, sw_n700s_series_midcars, cargo_subtype ) {				
                0..1:  sw_n700_series_midcars;	
                sw_n700s_series_kamome_midcars;	
            }

/* Cab selection */

    /* N700 */

    switch (FEAT_TRAINS, PARENT, sw_n700_series_rear, vehicle_is_reversed) {				
            1: sw_n700_series_cab01b;
            sw_n700_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_n700_series_lead, vehicle_is_reversed) {				
            1: sw_n700_series_cab02b;
            sw_n700_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_n700_series_cabs, position_in_consist) {				
            0..2: sw_n700_series_lead;
            sw_n700_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_graphics, IsCab() ) {				
            1:  sw_n700_series_cabs;
            sw_n700_series_midcars;	
        }

    /* N700A */

    switch (FEAT_TRAINS, PARENT, sw_n700a_series_rear, vehicle_is_reversed) {				
            1: sw_n700a_series_cab01b;
            sw_n700a_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_n700a_series_lead, vehicle_is_reversed) {				
            1: sw_n700a_series_cab02b;
            sw_n700a_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_n700a_series_cabs, position_in_consist) {				
            0..2: sw_n700a_series_lead;
            sw_n700a_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700a_series_graphics, IsCab() ) {				
            1:  sw_n700a_series_cabs;
            sw_n700_series_midcars;	
        }

    /* N700S */

    switch (FEAT_TRAINS, PARENT, sw_n700s_series_rear, vehicle_is_reversed) {				
            1: sw_n700s_series_cab01b;
            sw_n700s_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_n700s_series_lead, vehicle_is_reversed) {				
            1: sw_n700s_series_cab02b;
            sw_n700s_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_n700s_series_cabs, position_in_consist) {				
            0..2: sw_n700s_series_lead;
            sw_n700s_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_n700s_series_graphics, IsCab() ) {				
            1:  sw_n700s_series_cabs;
            sw_n700s_series_midcars;	
        }
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "src/trains/n700_series/n700_series_item.pnml" 1


switch (FEAT_TRAINS, SELF, sw_n700_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_n700;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_n700) {
	property {
		/* Menu */
        name: 							string(STR_NAME_N700_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2007,07,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
		speed:                          301 km/h;				    // Overwritten by callback
    	power:                          22900 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_N700_SERIES);
        cargo_subtype_text:             sw_n700_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                44;
        purchase_power:                 409 * 4;
        /* Graphics */
        default:                        sw_n700_series_graphics;
		purchase:                       sw_n700_series_purchase;
		articulated_part:               sw_n700_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        weight:                         NumberCarsInConsist() * 44;
        power:                         	max (( NumberCarsInConsist() - 2 ) , 0 )* 409 * 4;
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cost_factor:                    138;
		running_cost_factor:            (300 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_n700_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_n700_series_running_costs;
      }
}

switch (FEAT_TRAINS, SELF, sw_n700a_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_n700a;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_n700a) {
	property {
		/* Menu */
        name: 							string(STR_NAME_N700A_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					707;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2013,02,08);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
		speed:                          301 km/h;				    // Overwritten by callback
    	power:                          22900 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_N700A_SERIES);
		cargo_subtype_text:             sw_n700a_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                44;
        purchase_power:                 409 * 4;
        /* Graphics */
        default:                        sw_n700a_series_graphics;
		purchase:                       sw_n700a_series_purchase;
		articulated_part:               sw_n700a_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        weight:                         NumberCarsInConsist() * 44;
        power:                         	max (( NumberCarsInConsist() - 2 ) , 0 )* 409 * 4;
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cost_factor:                    138;
		running_cost_factor:            (300 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_n700a_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_n700a_series_running_costs;
      }
}


switch (FEAT_TRAINS, SELF, sw_n700s_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_n700s;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_n700s) {
	property {
		/* Menu */
        name: 							string(STR_NAME_N700S_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					707;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2020,07,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
		speed:                          360 km/h;				    // Overwritten by callback
    	power:                          22900 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_N700S_SERIES);
		cargo_subtype_text:             sw_n700s_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                44;
        purchase_power:                 409 * 4;
        /* Graphics */
        default:                        sw_n700s_series_graphics;
		purchase:                       sw_n700s_series_purchase;
		articulated_part:               sw_n700s_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        weight:                         NumberCarsInConsist() * 44;
        power:                         	max (( NumberCarsInConsist() - 2 ) , 0 )* 409 * 4;
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cost_factor:                    138;
		running_cost_factor:            (300 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 125 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_n700s_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_n700s_series_running_costs;
      }
}
# 1 "src/trains/n700_series/n700_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/700_series/700_series.pnml" 1

# 1 "src/trains/700_series/700_series_menu.pnml" 1
/* SUBTYPES */

    switch(FEAT_TRAINS, SELF, sw_700_series_subtype_text, cargo_subtype) {
	    0: return string(LV_700_SERIES_ORIGINAL);
        1: return string(LV_700_SERIES_ORIGINAL_2CC);
        2: return string(LV_700_SERIES_HIKARI);
        3: return string(LV_700_SERIES_HIKARI_2CC);
        return CB_RESULT_NO_TEXT;
        }

/* PURCHASE */

    spriteset (ss_700_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_700_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral; 
            1: ss_700_series_buy;
        }

/* DR YELLOW PURCHASE */

    spriteset (ss_923_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_923_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral; 
            1: ss_923_series_buy;
        }
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_700_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_700_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_cab01f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_700_series_cab01b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_700_series_cab01f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_700_series_cab01b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_700_series_cab01f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_700_series_cab01b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_700_series_cab01f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_700_series_cab01b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_rev(1,51)}

    // Hikari

    // 10/8
	spriteset(ss_std_700_series_cab01f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_700_series_cab01b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_700_series_cab01f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_700_series_cab01b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_700_series_cab01f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_700_series_cab01b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_700_series_cab01f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_700_series_cab01b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_rev(1,51)}

    // Hikari 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_cab01f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_700_series_cab01b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_700_series_cab01f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_700_series_cab01b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_700_series_cab01f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_700_series_cab01b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_700_series_cab01f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_700_series_cab01b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_rev(1,51)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab01f_hik_mask, cargo_subtype) {2:ss_frt_700_series_cab01f_hik;  3:ss_frt_700_series_cab01f_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab01f_2cc_mask, cargo_subtype) {1:ss_frt_700_series_cab01f_2cc;  3:ss_frt_700_series_cab01f_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_700_series_cab01f_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_cab01f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_700_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab01f_2cc_mask, cargo_subtype) {1:ss_mid_700_series_cab01f_2cc; 3:ss_mid_700_series_cab01f_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab01f_hik_mask, cargo_subtype) {2:ss_mid_700_series_cab01f_hik;  3:ss_mid_700_series_cab01f_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_700_series_cab01f_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab01f_hik, cargo_subtype) {2:ss_std_700_series_cab01f_hik; 3:ss_std_700_series_cab01f_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01f_hik, HideLongSprite() ) { 0: sw_std_700_series_cab01f_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab01f_2cc, cargo_subtype) {1:ss_std_700_series_cab01f_2cc; 3:ss_std_700_series_cab01f_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01f_2cc, HideLongSprite() ) { 0: sw_std_700_series_cab01f_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_cab01f_irl;       	    // Base for Mid
                1: ss_mid_700_series_cab01f_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_cab01f_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_cab01f_irl;	    // Base for LongSprite
				4: longsprite_700_series_cab01f_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_cab01f_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab01f_hik_mask, cargo_subtype) {2:ss_bck_700_series_cab01f_hik;  3:ss_bck_700_series_cab01f_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab01f_2cc_mask, cargo_subtype) {1:ss_bck_700_series_cab01f_2cc;  3:ss_bck_700_series_cab01f_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_cab01f_irl;       	    // Base for Front
				1: ss_bck_700_series_cab01f_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_cab01f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_700_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_cab01f, position_in_consist % 3 ) {				
            0: sw_700_series_cab01f_frt_longsprite;
            1: sw_700_series_cab01f_mid_stack;
            2: sw_700_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab01b_hik_mask, cargo_subtype) {2:ss_frt_700_series_cab01b_hik;  3:ss_frt_700_series_cab01b_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab01b_2cc_mask, cargo_subtype) {1:ss_frt_700_series_cab01b_2cc;  3:ss_frt_700_series_cab01b_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_700_series_cab01b_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_cab01b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_700_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab01b_2cc_mask, cargo_subtype) {1:ss_mid_700_series_cab01b_2cc; 3:ss_mid_700_series_cab01b_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab01b_hik_mask, cargo_subtype) {2:ss_mid_700_series_cab01b_hik;  3:ss_mid_700_series_cab01b_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_700_series_cab01b_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab01b_hik, cargo_subtype) {2:ss_std_700_series_cab01b_hik; 3:ss_std_700_series_cab01b_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01b_hik, HideLongSprite() ) { 0: sw_std_700_series_cab01b_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab01b_2cc, cargo_subtype) {1:ss_std_700_series_cab01b_2cc; 3:ss_std_700_series_cab01b_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab01b_2cc, HideLongSprite() ) { 0: sw_std_700_series_cab01b_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_cab01b_irl;       	    // Base for Mid
                1: ss_mid_700_series_cab01b_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_cab01b_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_cab01b_irl;	    // Base for LongSprite
				4: longsprite_700_series_cab01b_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_cab01b_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab01b_hik_mask, cargo_subtype) {2:ss_bck_700_series_cab01b_hik;  3:ss_bck_700_series_cab01b_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab01b_2cc_mask, cargo_subtype) {1:ss_bck_700_series_cab01b_2cc;  3:ss_bck_700_series_cab01b_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_cab01b_irl;       	    // Base for Front
				1: ss_bck_700_series_cab01b_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_cab01b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_700_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_700_series_cab01b_frt_longsprite;
            1: sw_700_series_cab01b_mid_stack;
            2: sw_700_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_700_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_700_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_cab02f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_700_series_cab02b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_700_series_cab02f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_700_series_cab02b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_700_series_cab02f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_700_series_cab02b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_700_series_cab02f_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_700_series_cab02b_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Hikari

    // 10/8
	spriteset(ss_std_700_series_cab02f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_700_series_cab02b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_700_series_cab02f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_700_series_cab02b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_700_series_cab02f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_700_series_cab02b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_700_series_cab02f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_700_series_cab02b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_cab_bck_rev(1,1)}

    // Hikari 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_cab02f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_700_series_cab02b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_700_series_cab02f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_700_series_cab02b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_700_series_cab02f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_700_series_cab02b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_700_series_cab02f_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_700_series_cab02b_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_cab_bck_rev(1,1)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab02f_hik_mask, cargo_subtype) {2:ss_frt_700_series_cab02f_hik;  3:ss_frt_700_series_cab02f_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab02f_2cc_mask, cargo_subtype) {1:ss_frt_700_series_cab02f_2cc;  3:ss_frt_700_series_cab02f_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_cab02f_irl;       	    // Base for Front
				1: ss_frt_700_series_cab02f_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_cab02f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_700_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab02f_2cc_mask, cargo_subtype) {1:ss_mid_700_series_cab02f_2cc; 3:ss_mid_700_series_cab02f_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab02f_hik_mask, cargo_subtype) {2:ss_mid_700_series_cab02f_hik;  3:ss_mid_700_series_cab02f_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_700_series_cab02f_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab02f_hik, cargo_subtype) {2:ss_std_700_series_cab02f_hik; 3:ss_std_700_series_cab02f_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02f_hik, HideLongSprite() ) { 0: sw_std_700_series_cab02f_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab02f_2cc, cargo_subtype) {1:ss_std_700_series_cab02f_2cc; 3:ss_std_700_series_cab02f_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02f_2cc, HideLongSprite() ) { 0: sw_std_700_series_cab02f_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_cab02f_irl;       	    // Base for Mid
                1: ss_mid_700_series_cab02f_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_cab02f_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_cab02f_irl;	    // Base for LongSprite
				4: longsprite_700_series_cab02f_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_cab02f_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab02f_hik_mask, cargo_subtype) {2:ss_bck_700_series_cab02f_hik;  3:ss_bck_700_series_cab02f_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab02f_2cc_mask, cargo_subtype) {1:ss_bck_700_series_cab02f_2cc;  3:ss_bck_700_series_cab02f_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_cab02f_irl;       	    // Base for Front
				1: ss_bck_700_series_cab02f_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_cab02f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_700_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_700_series_cab02f_frt_longsprite;
            1: sw_700_series_cab02f_mid_stack;
            2: sw_700_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab02b_hik_mask, cargo_subtype) {2:ss_frt_700_series_cab02b_hik;  3:ss_frt_700_series_cab02b_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_cab02b_2cc_mask, cargo_subtype) {1:ss_frt_700_series_cab02b_2cc;  3:ss_frt_700_series_cab02b_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_cab02b_irl;       	    // Base for Front
				1: ss_frt_700_series_cab02b_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_cab02b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_700_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab02b_2cc_mask, cargo_subtype) {1:ss_mid_700_series_cab02b_2cc; 3:ss_mid_700_series_cab02b_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_cab02b_hik_mask, cargo_subtype) {2:ss_mid_700_series_cab02b_hik;  3:ss_mid_700_series_cab02b_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_700_series_cab02b_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab02b_hik, cargo_subtype) {2:ss_std_700_series_cab02b_hik; 3:ss_std_700_series_cab02b_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02b_hik, HideLongSprite() ) { 0: sw_std_700_series_cab02b_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_cab02b_2cc, cargo_subtype) {1:ss_std_700_series_cab02b_2cc; 3:ss_std_700_series_cab02b_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_cab02b_2cc, HideLongSprite() ) { 0: sw_std_700_series_cab02b_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_cab02b_irl;       	    // Base for Mid
                1: ss_mid_700_series_cab02b_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_cab02b_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_cab02b_irl;	    // Base for LongSprite
				4: longsprite_700_series_cab02b_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_cab02b_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab02b_hik_mask, cargo_subtype) {2:ss_bck_700_series_cab02b_hik;  3:ss_bck_700_series_cab02b_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_cab02b_2cc_mask, cargo_subtype) {1:ss_bck_700_series_cab02b_2cc;  3:ss_bck_700_series_cab02b_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_cab02b_irl;       	    // Base for Front
				1: ss_bck_700_series_cab02b_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_cab02b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_700_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_cab02b, position_in_consist % 3 ) {				
            0: sw_700_series_cab02b_frt_longsprite;
            1: sw_700_series_cab02b_mid_stack;
            2: sw_700_series_cab02b_bck_longsprite;
        }
		
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_coachf_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_coachb_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_coachf_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_coachb_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_coachf_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_coachb_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_coachf_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_coachb_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Hikari

    // 10/8
	spriteset(ss_std_700_series_coachf_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_coachb_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_coachf_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_coachb_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_coachf_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_coachb_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_coachf_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_coachb_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_rev(1,101)}

    // Hikari 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_coachf_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_coachb_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_coachf_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_coachb_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_coachf_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_coachb_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_coachf_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_coachb_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_coachf_hik_mask, cargo_subtype) {2:ss_frt_700_series_coachf_hik;  3:ss_frt_700_series_coachf_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_coachf_2cc_mask, cargo_subtype) {1:ss_frt_700_series_coachf_2cc;  3:ss_frt_700_series_coachf_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_coachf_irl;       	    // Base for Front
				1: ss_frt_700_series_coachf_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_coachf_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_700_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_coachf_2cc_mask, cargo_subtype) {1:ss_mid_700_series_coachf_2cc; 3:ss_mid_700_series_coachf_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_coachf_hik_mask, cargo_subtype) {2:ss_mid_700_series_coachf_hik;  3:ss_mid_700_series_coachf_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachf_irl, HideLongSprite() ) { 0: ss_std_700_series_coachf_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_coachf_hik, cargo_subtype) {2:ss_std_700_series_coachf_hik; 3:ss_std_700_series_coachf_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachf_hik, HideLongSprite() ) { 0: sw_std_700_series_coachf_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_coachf_2cc, cargo_subtype) {1:ss_std_700_series_coachf_2cc; 3:ss_std_700_series_coachf_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachf_2cc, HideLongSprite() ) { 0: sw_std_700_series_coachf_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_700_series_coachf_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_coachf_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_coachf_irl;	    // Base for LongSprite
				4: longsprite_700_series_coachf_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_coachf_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_coachf_hik_mask, cargo_subtype) {2:ss_bck_700_series_coachf_hik;  3:ss_bck_700_series_coachf_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_coachf_2cc_mask, cargo_subtype) {1:ss_bck_700_series_coachf_2cc;  3:ss_bck_700_series_coachf_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_coachf_irl;       	    // Base for Front
				1: ss_bck_700_series_coachf_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_coachf_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_700_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_coachf, position_in_consist % 3 ) {				
            0: sw_700_series_coachf_frt_longsprite;
            1: sw_700_series_coachf_mid_stack;
            2: sw_700_series_coachf_bck_longsprite;
        }

	// Backwards

		// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_coachb_hik_mask, cargo_subtype) {2:ss_frt_700_series_coachb_hik;  3:ss_frt_700_series_coachb_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_coachb_2cc_mask, cargo_subtype) {1:ss_frt_700_series_coachb_2cc;  3:ss_frt_700_series_coachb_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_coachb_irl;       	    // Base for Front
				1: ss_frt_700_series_coachb_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_coachb_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_700_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_coachb_2cc_mask, cargo_subtype) {1:ss_mid_700_series_coachb_2cc; 3:ss_mid_700_series_coachb_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_coachb_hik_mask, cargo_subtype) {2:ss_mid_700_series_coachb_hik;  3:ss_mid_700_series_coachb_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachb_irl, HideLongSprite() ) { 0: ss_std_700_series_coachb_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_coachb_hik, cargo_subtype) {2:ss_std_700_series_coachb_hik; 3:ss_std_700_series_coachb_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachb_hik, HideLongSprite() ) { 0: sw_std_700_series_coachb_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_coachb_2cc, cargo_subtype) {1:ss_std_700_series_coachb_2cc; 3:ss_std_700_series_coachb_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_coachb_2cc, HideLongSprite() ) { 0: sw_std_700_series_coachb_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_700_series_coachb_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_coachb_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_coachb_irl;	    // Base for LongSprite
				4: longsprite_700_series_coachb_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_coachb_2cc;        // Hikari mask for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_coachb_hik_mask, cargo_subtype) {2:ss_bck_700_series_coachb_hik;  3:ss_bck_700_series_coachb_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_coachb_2cc_mask, cargo_subtype) {1:ss_bck_700_series_coachb_2cc;  3:ss_bck_700_series_coachb_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_coachb_irl;       	    // Base for Front
				1: ss_bck_700_series_coachb_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_coachb_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_700_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_700_series_coachb_frt_longsprite;
            1: sw_700_series_coachb_mid_stack;
            2: sw_700_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/700_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_pantof_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_pantob_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_pantof_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_pantob_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_pantof_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_pantob_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_pantof_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_pantob_2cc, "src/trains/700_series/gfx/700_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Hikari

    // 10/8
	spriteset(ss_std_700_series_pantof_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_pantob_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_pantof_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_pantob_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_pantof_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_pantob_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_pantof_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_pantob_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/hikari.png") {tmpl_bck_rev(1,101)}

    // Hikari 2cc Mask

	// 10/8
	spriteset(ss_std_700_series_pantof_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_700_series_pantob_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_700_series_pantof_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_700_series_pantob_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_700_series_pantof_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_700_series_pantob_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_700_series_pantof_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_700_series_pantob_h2c, "src/trains/700_series/gfx/hikari_2cc.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_pantof_hik_mask, cargo_subtype) {2:ss_frt_700_series_pantof_hik;  3:ss_frt_700_series_pantof_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_pantof_2cc_mask, cargo_subtype) {1:ss_frt_700_series_pantof_2cc;  3:ss_frt_700_series_pantof_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_pantof_irl;       	    // Base for Front
				1: ss_frt_700_series_pantof_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_pantof_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_700_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_pantof_2cc_mask, cargo_subtype) {1:ss_mid_700_series_pantof_2cc; 3:ss_mid_700_series_pantof_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_pantof_hik_mask, cargo_subtype) {2:ss_mid_700_series_pantof_hik;  3:ss_mid_700_series_pantof_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantof_irl, HideLongSprite() ) { 0: ss_std_700_series_pantof_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_pantof_hik, cargo_subtype) {2:ss_std_700_series_pantof_hik; 3:ss_std_700_series_pantof_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantof_hik, HideLongSprite() ) { 0: sw_std_700_series_pantof_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_pantof_2cc, cargo_subtype) {1:ss_std_700_series_pantof_2cc; 3:ss_std_700_series_pantof_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantof_2cc, HideLongSprite() ) { 0: sw_std_700_series_pantof_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_pantof_irl;       	    // Base for Mid
                1: ss_mid_700_series_pantof_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_pantof_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_pantof_irl;	    // Base for LongSprite
				4: longsprite_700_series_pantof_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_pantof_2cc;        // Hikari mask for LongSprite
                // Panto
                6: panto_midsprite_n700_f;                  // Panto for Mid
                7: panto_longsprite_n700_f;                 // Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_pantof_hik_mask, cargo_subtype) {2:ss_bck_700_series_pantof_hik;  3:ss_bck_700_series_pantof_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_pantof_2cc_mask, cargo_subtype) {1:ss_bck_700_series_pantof_2cc;  3:ss_bck_700_series_pantof_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_pantof_irl;       	    // Base for Front
				1: ss_bck_700_series_pantof_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_pantof_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_700_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_pantof, position_in_consist % 3 ) {				
            0: sw_700_series_pantof_frt_longsprite;
            1: sw_700_series_pantof_mid_stack;
            2: sw_700_series_pantof_bck_longsprite;
        }

	// Backwards

		// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_700_series_pantob_hik_mask, cargo_subtype) {2:ss_frt_700_series_pantob_hik;  3:ss_frt_700_series_pantob_hik; }
        switch(FEAT_TRAINS, PARENT, ss_frt_700_series_pantob_2cc_mask, cargo_subtype) {1:ss_frt_700_series_pantob_2cc;  3:ss_frt_700_series_pantob_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_700_series_pantob_irl;       	    // Base for Front
				1: ss_frt_700_series_pantob_hik_mask;		// Hikari mask for Front
				2: ss_frt_700_series_pantob_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_700_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_700_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_pantob_2cc_mask, cargo_subtype) {1:ss_mid_700_series_pantob_2cc; 3:ss_mid_700_series_pantob_h2c; }
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_mid_700_series_pantob_hik_mask, cargo_subtype) {2:ss_mid_700_series_pantob_hik;  3:ss_mid_700_series_pantob_hik; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantob_irl, HideLongSprite() ) { 0: ss_std_700_series_pantob_irl; }
            // Mask when Hikari
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_pantob_hik, cargo_subtype) {2:ss_std_700_series_pantob_hik; 3:ss_std_700_series_pantob_hik; }
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantob_hik, HideLongSprite() ) { 0: sw_std_700_series_pantob_hik; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_700_series_pantob_2cc, cargo_subtype) {1:ss_std_700_series_pantob_2cc; 3:ss_std_700_series_pantob_h2c;}
                switch(FEAT_TRAINS, SELF, longsprite_700_series_pantob_2cc, HideLongSprite() ) { 0: sw_std_700_series_pantob_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_700_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_700_series_pantob_irl;       	    // Base for Mid
                1: ss_mid_700_series_pantob_hik_mask;		// Hikari mask for Mid
				2: ss_mid_700_series_pantob_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_700_series_pantob_irl;	    // Base for LongSprite
				4: longsprite_700_series_pantob_hik;        // IRL 2cc mask for LongSprite
                5: longsprite_700_series_pantob_2cc;        // Hikari mask for LongSprite
                // Panto
                6: panto_midsprite_n700_b;                  // Panto for Mid
                7: panto_longsprite_n700_b;                 // Panto for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_700_series_pantob_hik_mask, cargo_subtype) {2:ss_bck_700_series_pantob_hik;  3:ss_bck_700_series_pantob_hik; }
        switch(FEAT_TRAINS, PARENT, ss_bck_700_series_pantob_2cc_mask, cargo_subtype) {1:ss_bck_700_series_pantob_2cc;  3:ss_bck_700_series_pantob_h2c; }
		
		switch(FEAT_TRAINS, SELF, sw_700_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_700_series_pantob_irl;       	    // Base for Front
				1: ss_bck_700_series_pantob_hik_mask;		// Hikari mask for Front
				2: ss_bck_700_series_pantob_2cc_mask;		// IRL 2cc mask for Front
			}


		switch(FEAT_TRAINS, SELF, sw_700_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_700_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_700_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_700_series_pantob_frt_longsprite;
            1: sw_700_series_pantob_mid_stack;
            2: sw_700_series_pantob_bck_longsprite;
        }
		
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/923_series.pnml" 1
/* Begin 923 Series */

/* GRAPHICS */

	/* EMU Parts */

	/* "CAB" */

		// 10/8
		spriteset(ss_std_923_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,1)}
		spriteset(ss_std_923_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,51)}

		// Front
		spriteset(ss_frt_923_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,1)}
		spriteset(ss_frt_923_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,51)}
		// Mid
		spriteset(ss_mid_923_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,1)}
		spriteset(ss_mid_923_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,51)}
		// Back
		spriteset(ss_bck_923_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,1)}
		spriteset(ss_bck_923_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,51)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_cab01f_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_cab01f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_923_series_cab01f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_cab01f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_cab01f_irl;       	    // Base for Mid
					1: longsprite_923_series_cab01f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_cab01f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_cab01f, position_in_consist % 3 ) {				
				0: sw_923_series_cab01f_frt_longsprite;
				1: sw_923_series_cab01f_mid_stack;
				2: sw_923_series_cab01f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_cab01b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_923_series_cab01b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_cab01b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_cab01b_irl;       	    // Base for Mid
					1: longsprite_923_series_cab01b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_cab01b_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_cab01b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_cab01b, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_cab01b_frt_longsprite;
				1: sw_923_series_cab01b_mid_stack;
				2: sw_923_series_cab01b_bck_longsprite;
			}

	/* "CAB" w/ MORE WINDOWS*/

		// 10/8
		spriteset(ss_std_923_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_cab_std(1,51)}
		spriteset(ss_std_923_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_cab_rev(1,1)}

		// Front
		spriteset(ss_frt_923_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_frt_std(1,51)}
		spriteset(ss_frt_923_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_frt_rev(1,1)}
		// Mid
		spriteset(ss_mid_923_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_mid_std(1,51)}
		spriteset(ss_mid_923_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_mid_rev(1,1)}
		// Back
		spriteset(ss_bck_923_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_bck_std(1,51)}
		spriteset(ss_bck_923_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_cab_bck_rev(1,1)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_cab02f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_923_series_cab02f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_cab02f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_cab02f_irl;       	    // Base for Mid
					1: longsprite_923_series_cab02f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_cab02f_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_cab02f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_cab02f, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_cab02f_frt_longsprite;
				1: sw_923_series_cab02f_mid_stack;
				2: sw_923_series_cab02f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_cab02b_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_cab02b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_923_series_cab02b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_cab02b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_cab02b_irl;       	    // Base for Mid
					1: longsprite_923_series_cab02b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_cab02b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_cab02b, position_in_consist % 3 ) {				
				0: sw_923_series_cab02b_frt_longsprite;
				1: sw_923_series_cab02b_mid_stack;
				2: sw_923_series_cab02b_bck_longsprite;
			}

	/* "COACH" - the light roof one */
	
		// 10/8
		spriteset(ss_std_923_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,301)}
		spriteset(ss_std_923_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,301)}

		// Front
		spriteset(ss_frt_923_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,301)}
		spriteset(ss_frt_923_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,301)}
		// Mid
		spriteset(ss_mid_923_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,301)}
		spriteset(ss_mid_923_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,301)}
		// Back
		spriteset(ss_bck_923_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,301)}
		spriteset(ss_bck_923_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,301)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_coachf_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_coachf_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_coachf_irl, HideLongSprite() ) { 0: ss_std_923_series_coachf_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_coachf_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_coachf_irl;       	    // Base for Mid
					1: longsprite_923_series_coachf_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_coachf_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_coachf_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_coachf, position_in_consist % 3 ) {				
				0: sw_923_series_coachf_frt_longsprite;
				1: sw_923_series_coachf_mid_stack;
				2: sw_923_series_coachf_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_coachb_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_coachb_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_coachb_irl, HideLongSprite() ) { 0: ss_std_923_series_coachb_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_coachb_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_coachb_irl;       	    // Base for Mid
					1: longsprite_923_series_coachb_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_coachb_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_coachb_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_coachb, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_coachb_frt_longsprite;
				1: sw_923_series_coachb_mid_stack;
				2: sw_923_series_coachb_bck_longsprite;
			}

	/* "PANTO 1" */

		// 10/8
		spriteset(ss_std_923_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,201)}
		spriteset(ss_std_923_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,201)}

		// Front
		spriteset(ss_frt_923_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,201)}
		spriteset(ss_frt_923_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,201)}
		// Mid
		spriteset(ss_mid_923_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,201)}
		spriteset(ss_mid_923_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,201)}
		// Back
		spriteset(ss_bck_923_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,201)}
		spriteset(ss_bck_923_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,201)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant1f_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_pant1f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant1f_irl, HideLongSprite() ) { 0: ss_std_923_series_pant1f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant1f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant1f_irl;       	    // Base for Mid
					1: longsprite_923_series_pant1f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant1f_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_pant1f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant1f, position_in_consist % 3 ) {				
				0: sw_923_series_pant1f_frt_longsprite;
				1: sw_923_series_pant1f_mid_stack;
				2: sw_923_series_pant1f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant1b_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_pant1b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant1b_irl, HideLongSprite() ) { 0: ss_std_923_series_pant1b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant1b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant1b_irl;       	    // Base for Mid
					1: longsprite_923_series_pant1b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant1b_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_pant1b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant1b, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_pant1b_frt_longsprite;
				1: sw_923_series_pant1b_mid_stack;
				2: sw_923_series_pant1b_bck_longsprite;
			}

	/* "PANTO 2" */

		// 10/8
		spriteset(ss_std_923_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,251)}
		spriteset(ss_std_923_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,251)}

		// Front
		spriteset(ss_frt_923_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,251)}
		spriteset(ss_frt_923_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,251)}
		// Mid
		spriteset(ss_mid_923_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,251)}
		spriteset(ss_mid_923_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,251)}
		// Back
		spriteset(ss_bck_923_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,251)}
		spriteset(ss_bck_923_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,251)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant2f_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_pant2f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant2f_irl, HideLongSprite() ) { 0: ss_std_923_series_pant2f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant2f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant2f_irl;       	    // Base for Mid
					1: longsprite_923_series_pant2f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant2f_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_pant2f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant2f, position_in_consist % 3 ) {				
				0: sw_923_series_pant2f_frt_longsprite;
				1: sw_923_series_pant2f_mid_stack;
				2: sw_923_series_pant2f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant2b_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_pant2b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant2b_irl, HideLongSprite() ) { 0: ss_std_923_series_pant2b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant2b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant2b_irl;       	    // Base for Mid
					1: longsprite_923_series_pant2b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant2b_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_pant2b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant2b, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_pant2b_frt_longsprite;
				1: sw_923_series_pant2b_mid_stack;
				2: sw_923_series_pant2b_bck_longsprite;
			}

	/* "PANTO 3" */

		// 10/8
		spriteset(ss_std_923_series_pant3f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,351)}
		spriteset(ss_std_923_series_pant3b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,351)}

		// Front
		spriteset(ss_frt_923_series_pant3f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,351)}
		spriteset(ss_frt_923_series_pant3b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,351)}
		// Mid
		spriteset(ss_mid_923_series_pant3f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,351)}
		spriteset(ss_mid_923_series_pant3b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,351)}
		// Back
		spriteset(ss_bck_923_series_pant3f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,351)}
		spriteset(ss_bck_923_series_pant3b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,351)}
		
		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant3f_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_pant3f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant3f_irl, HideLongSprite() ) { 0: ss_std_923_series_pant3f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant3f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant3f_irl;       	    // Base for Mid
					1: longsprite_923_series_pant3f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant3f_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_pant3f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant3f, position_in_consist % 3 ) {				
				0: sw_923_series_pant3f_frt_longsprite;
				1: sw_923_series_pant3f_mid_stack;
				2: sw_923_series_pant3f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant3b_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_pant3b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant3b_irl, HideLongSprite() ) { 0: ss_std_923_series_pant3b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant3b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant3b_irl;       	    // Base for Mid
					1: longsprite_923_series_pant3b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant3b_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_pant3b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant3b, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_pant3b_frt_longsprite;
				1: sw_923_series_pant3b_mid_stack;
				2: sw_923_series_pant3b_bck_longsprite;
			}

	/* "PANTO 4" */
	
		// 10/8
		spriteset(ss_std_923_series_pant4f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_std(1,401)}
		spriteset(ss_std_923_series_pant4b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_10_rev(1,401)}

		// Front
		spriteset(ss_frt_923_series_pant4f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_std(1,401)}
		spriteset(ss_frt_923_series_pant4b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_frt_rev(1,401)}
		// Mid
		spriteset(ss_mid_923_series_pant4f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_std(1,401)}
		spriteset(ss_mid_923_series_pant4b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_mid_rev(1,401)}
		// Back
		spriteset(ss_bck_923_series_pant4f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_std(1,401)}
		spriteset(ss_bck_923_series_pant4b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/700_series/gfx/923_series.png") {tmpl_bck_rev(1,401)}

		// Forwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant4f_frt_longsprite, NextPartSame() ) { 1: ss_frt_923_series_pant4f_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant4f_irl, HideLongSprite() ) { 0: ss_std_923_series_pant4f_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant4f_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant4f_irl;       	    // Base for Mid
					1: longsprite_923_series_pant4f_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant4f_bck_longsprite, PrevPartSame() ) { 1: ss_bck_923_series_pant4f_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant4f, position_in_consist % 3 ) {				
				0: sw_923_series_pant4f_frt_longsprite;
				1: sw_923_series_pant4f_mid_stack;
				2: sw_923_series_pant4f_bck_longsprite;
			}

		// Backwards

			// Front
			switch(FEAT_TRAINS, SELF, sw_923_series_pant4b_frt_longsprite, PrevPartSame() ) { 1: ss_frt_923_series_pant4b_irl; dummy_sprites; }

			/* MID */
			switch(FEAT_TRAINS, SELF, longsprite_923_series_pant4b_irl, HideLongSprite() ) { 0: ss_std_923_series_pant4b_irl; }

			switch(FEAT_TRAINS, SELF, sw_923_series_pant4b_mid_stack, [ 
				STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
					0: ss_mid_923_series_pant4b_irl;       	    // Base for Mid
					1: longsprite_923_series_pant4b_irl;	    // Base for LongSprite
				}

			// Back
			switch(FEAT_TRAINS, SELF, sw_923_series_pant4b_bck_longsprite, NextPartSame() ) { 1: ss_bck_923_series_pant4b_irl; dummy_sprites; }

			switch (FEAT_TRAINS, SELF, sw_923_series_pant4b, position_in_consist_from_end % 3 ) {				
				0: sw_923_series_pant4b_frt_longsprite;
				1: sw_923_series_pant4b_mid_stack;
				2: sw_923_series_pant4b_bck_longsprite;
			}

/* FORMATIONS */

// Midcars going backwards

switch (FEAT_TRAINS, SELF, sw_923_series_backwards_front, CarNumberFromEnd() ) {				
		2:  sw_923_series_pant1b;
		3:  sw_923_series_pant2b;
		sw_923_series_coachb;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_backwards_back, CarNumber() ) {				
		2:  sw_923_series_pant4b;
		3:  sw_923_series_pant3b;
		sw_923_series_coachb;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_backwards_long_front_or_back, ( position_in_consist_from_end - position_in_consist ) < 0 ) {				
		1:  sw_923_series_backwards_front;
		sw_923_series_backwards_back;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_backwards_long, ( num_vehs_in_consist - abs(position_in_consist - position_in_consist_from_end)) < 20 ) {				
		0:  sw_923_series_coachb;
		sw_923_series_backwards_long_front_or_back;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_backwards_18, CarNumberFromEnd() ) {				
		2: sw_923_series_pant1b;
		3: sw_923_series_pant2b;
		4: sw_923_series_pant3b;
		5: sw_923_series_pant4b;
		sw_923_series_coachb;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_backwards, num_vehs_in_consist) {				
		1..18: sw_923_series_backwards_18;
		sw_923_series_backwards_long;				
	}

// Midcars going forwards

switch (FEAT_TRAINS, SELF, sw_923_series_forwards_front, CarNumber() ) {				
		2:  sw_923_series_pant1f;
		3:  sw_923_series_pant2f;
		sw_923_series_coachf;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_forwards_back, CarNumberFromEnd() ) {				
		2:  sw_923_series_pant4f;
		3:  sw_923_series_pant3f;
		sw_923_series_coachf;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_forwards_long_front_or_back, ( position_in_consist - position_in_consist_from_end ) < 0 ) {				
		1:  sw_923_series_forwards_front;
		sw_923_series_forwards_back;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_forwards_long, ( num_vehs_in_consist - abs(position_in_consist - position_in_consist_from_end)) < 20 ) {				
		0:  sw_923_series_coachf;
		sw_923_series_forwards_long_front_or_back;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_forwards_18, CarNumber() ) {				
		2: sw_923_series_pant1f;
		3: sw_923_series_pant2f;
		4: sw_923_series_pant3f;
		5: sw_923_series_pant4f;
		sw_923_series_coachf;				
	}

switch (FEAT_TRAINS, SELF, sw_923_series_forwards, num_vehs_in_consist) {				
		1..18: sw_923_series_forwards_18;
		sw_923_series_forwards_long;				
	}

// Is vehicle reversed?
switch (FEAT_TRAINS, PARENT, sw_923_series_midcars, vehicle_is_reversed) {				
		0:  sw_923_series_forwards;
		sw_923_series_backwards;				
	}

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_923_series_rear, vehicle_is_reversed) {				
            1: sw_923_series_cab01b;
            sw_923_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_923_series_lead, vehicle_is_reversed) {				
            1: sw_923_series_cab02b;
            sw_923_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_923_series_cabs, position_in_consist) {				
            0..2: sw_923_series_lead;
            sw_923_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_923_series_graphics, IsCab() ) {				
            1:  sw_923_series_cabs;
            sw_923_series_midcars;	
        }
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_formations.pnml" 1

// Forwards
     switch (FEAT_TRAINS, SELF, sw_700_series_forwards_long_pick_panto, CarNumber() == 5 ) {				
            1:  sw_700_series_pantof;	
            sw_700_series_pantob;		
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_forwards_long, CarNumber() == 5 || CarNumberFromEnd()  == 5 ) {					
            1:  sw_700_series_forwards_long_pick_panto;
            sw_700_series_coachf;				
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_forwards_penultimate_pick_panto, CarNumber() == 2 ) {				
            1:  sw_700_series_pantof;	
            sw_700_series_pantob;		
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_forwards_penultimate_pantos, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_700_series_forwards_penultimate_pick_panto;
            sw_700_series_coachf;				
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_700_series_pantof;
            sw_700_series_coachf;           				
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_forwards, num_vehs_in_consist ) {				
            0..21:  sw_700_series_forwards_panto_in_middle;
            22..39: sw_700_series_forwards_penultimate_pantos;
            sw_700_series_forwards_long;
        }

// Backwards
    switch (FEAT_TRAINS, SELF, sw_700_series_backwards_long_pick_panto, CarNumberFromEnd() == 5 ) {				
            1:  sw_700_series_pantob;	
            sw_700_series_pantof;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_700_series_backwards_long, CarNumberFromEnd() == 5 || CarNumber()  == 5 ) {					
            1:  sw_700_series_backwards_long_pick_panto;
            sw_700_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_backwards_penultimate_pick_panto, CarNumberFromEnd() == 2 ) {				
            1:  sw_700_series_pantob;	
            sw_700_series_pantof;		
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_backwards_penultimate_pantos, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_700_series_backwards_penultimate_pick_panto;
            sw_700_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_700_series_pantob;
            sw_700_series_coachb;
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_backwards, num_vehs_in_consist ) {				
            0..21:  sw_700_series_backwards_panto_in_middle;
            22..39: sw_700_series_backwards_penultimate_pantos;
            sw_700_series_backwards_long;
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_700_series_midcars, vehicle_is_reversed) {				
            0:  sw_700_series_forwards;
            sw_700_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_700_series_rear, vehicle_is_reversed) {				
            1: sw_700_series_cab01b;
            sw_700_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_700_series_lead, vehicle_is_reversed) {				
            1: sw_700_series_cab02b;
            sw_700_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_700_series_cabs, position_in_consist) {				
            0..2: sw_700_series_lead;
            sw_700_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_700_series_graphics, IsCab() ) {				
            1:  sw_700_series_cabs;
            sw_700_series_midcars;	
        }
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "src/trains/700_series/700_series_item.pnml" 1


switch (FEAT_TRAINS, SELF, sw_700_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_700;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_700) {
	property {
		/* Menu */
        name: 							string(STR_NAME_700_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1999,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          286 km/h;				    // Operational Top Speed
		power:                          8050 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_700_SERIES);
		cargo_subtype_text:             sw_700_series_subtype_text;
        can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                44;
        purchase_power:                 369 * 4;
        /* Graphics */
        default:                        sw_700_series_graphics;
		purchase:                       sw_700_series_purchase;
		articulated_part:               sw_700_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        weight:                         NumberCarsInConsist() * 44;
        power:                          max ( NumberCarsInConsist() - 2 , 0 ) * 369 * 4;	// 275 kW
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    134;
		running_cost_factor:            (310 + 124 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   310 + 124 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_700_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_700_series_running_costs;
      }
}

/* DR YELLOW 923 SERIES */

	switch (FEAT_TRAINS, SELF, sw_923_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_923;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
		}

	/*---Running Cost Factor---*/
	switch (FEAT_TRAINS, PARENT, sw_923_series_running_cost_factor, param_dryellow ) {				
		1: (150 + 60 * NumberCarsInConsist() ) * RunningCostFactor();		// Mail
		2: (295 + 125 * NumberCarsInConsist() ) * RunningCostFactor();		// Passengers
		return 0;			
	}


	if (param_dryellow == 0) { // GIMMICK

	item(FEAT_TRAINS, series_923) {
		property {
			/* Menu */
			name: 							string(STR_NAME_923_SERIES);
			sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
			misc_flags:                      bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
			running_cost_base:              RUNNING_COST_ELECTRIC;
			engine_class:                   ENGINE_CLASS_ELECTRIC;
			variant_group:					700;
			/* Availability */
			climates_available:             ALL_CLIMATES;
			introduction_date:              date(2000,03,01);           // Date of launch
			model_life:                     VEHICLE_NEVER_EXPIRES;		                    
			vehicle_life:                   30;							// 
			track_type:                     SHINKANSEN;
			extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
			/* Cargo */
			reliability_decay:              5;
			refittable_cargo_classes:       bitmask(CC_PASSENGERS);
			refit_cost:                     0;
			cargo_capacity:                 1;							// Changed by callback
			loading_speed:                  50;							
			cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
			/* Stats */
			speed:                          286 km/h;                   
			power:                          8050 kW;					// Changed by callback
			weight:                         648 ton;                   // Changed by callback					
			tractive_effort_coefficient:    0.3;
			air_drag_coefficient:			0;
		}
		graphics {
			/* Menu */
			additional_text:                string(STR_DESC_923_SERIES_GIMMICK);
			//cargo_subtype_text:             sw_923_series_year_dep_subtype_text;
			can_attach_wagon:				sw_attach_mu_car_full;
			start_stop:						sw_stop_start_full_length_4;
			purchase_weight:                44;
			purchase_power:                 369 * 4;
			/* Graphics */
			default:                        sw_923_series_graphics;
			purchase:                      	sw_923_series_purchase;
			articulated_part:               sw_923_series_articulated_part;
			visual_effect_and_powered:      sw_visual_effect_and_powered;
			/* Stats */
			length:                         sw_length_1_8_1;
			power:							max ( NumberCarsInConsist() - 2 , 0 ) * 369 * 4;
			weight:							NumberCarsInConsist() * 44;
			//speed:						285 km/h;
			cargo_capacity:                 0;										// Nil capacity									
			loading_speed:					25;	
			cargo_age_period:				param_decay_express;
			cost_factor:                    130;
			running_cost_factor:            0;
			purchase_running_cost_factor:   0;

		}    
		livery_override(mu_car_full){
			default:                        sw_923_series_graphics;
			cargo_capacity:                 0;	
			cargo_age_period:				param_decay_express;
			loading_speed:                  25;
			articulated_part:				sw_mucar_full_articulated_part;
			length:							sw_length_1_8_1;
			running_cost_factor:            0;
		}
	}}

	// MAIL
	if (param_dryellow == 1) {

	item(FEAT_TRAINS, series_923) {
		property {
			/* Menu */
			name: 							string(STR_NAME_923_SERIES);
			sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
			misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
			running_cost_base:              RUNNING_COST_ELECTRIC;
			engine_class:                   ENGINE_CLASS_ELECTRIC;
			variant_group:					700;
			/* Availability */
			climates_available:             ALL_CLIMATES;
			introduction_date:              date(2000,03,01);           // Date of launch
			model_life:                     VEHICLE_NEVER_EXPIRES;	                    
			vehicle_life:                   30;							// 
			track_type:                     SHINKANSEN;
			extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
			/* Cargo */
			reliability_decay:              5;
			refittable_cargo_classes:       bitmask(CC_MAIL);
			default_cargo_type:             MAIL;
			//refittable_cargo_classes:       bitmask(CC_PASSENGERS);
			refit_cost:                     0;
			cargo_capacity:                 1;							// Changed by callback
			loading_speed:                  50;							
			cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
			/* Stats */
			speed:                          240 km/h;                   
			power:                          8050 kW;					// Changed by callback
			weight:                         1464 ton;                   // Changed by callback					
			tractive_effort_coefficient:    0.3;
			air_drag_coefficient:			0;
		}
		graphics {
			/* Menu */
			additional_text:                string(STR_DESC_923_SERIES_MAIL);
			//cargo_subtype_text:             sw_923_series_year_dep_subtype_text;
			can_attach_wagon:				sw_attach_mu_car_mail;
			start_stop:						sw_stop_start_full_length_4;
			/* Graphics */
			default:                        sw_923_series_graphics;
			purchase:                      	sw_923_series_purchase;
			articulated_part:               sw_923_series_articulated_part;
			visual_effect_and_powered:      sw_visual_effect_and_powered;
			/* Stats */
			length:                         sw_length_1_8_1;
			power:							max ( NumberCarsInConsist() - 2 , 0 ) * 369 * 4;
			weight:							NumberCarsInConsist() * 44;
			//speed:						240 km/h;
			cargo_capacity:                 40 * CapacityFactor();											
			loading_speed:					40 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
			cargo_age_period:				param_decay_express;
			cost_factor:                    130;
			running_cost_factor:            sw_923_series_running_cost_factor;
			purchase_running_cost_factor:   295 + 125 * NumberCarsInConsist();
		}
		livery_override(mu_car_mail){
			default:                        sw_923_series_graphics;
			cargo_capacity:                 40 * CapacityFactor();		
			cargo_age_period:				param_decay_express;
			loading_speed:                  40 * CapacityFactor() / param_loading_2D;
			articulated_part:				sw_mucar_full_articulated_part;
			length:							sw_length_1_8_1;		
		}
	}}

	// PASSENGERS
	if (param_dryellow == 2)  {

	item(FEAT_TRAINS, series_923) {
			property {
			/* Menu */
			name: 							string(STR_NAME_923_SERIES);
			sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
			misc_flags:                      bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
			running_cost_base:              RUNNING_COST_ELECTRIC;
			engine_class:                   ENGINE_CLASS_ELECTRIC;
			variant_group:					700;
			/* Availability */
			climates_available:             ALL_CLIMATES;
			introduction_date:              date(2000,03,01);           // Date of launch
			model_life:                     VEHICLE_NEVER_EXPIRES;	                    
			vehicle_life:                   30;							// 
			track_type:                     SHINKANSEN;
			extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
			/* Cargo */
			reliability_decay:              5;
			refittable_cargo_classes:       bitmask(CC_PASSENGERS);
			default_cargo_type:             PASS;
			ai_special_flag:                AI_FLAG_PASSENGER;
			//refittable_cargo_classes:       bitmask(CC_PASSENGERS);
			refit_cost:                     0;
			cargo_capacity:                 1;							// Changed by callback
			loading_speed:                  50;							
			cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
			/* Stats */
			speed:                          240 km/h;                   
			power:                          8050 kW;					// Changed by callback
			weight:                         1464 ton;                   // Changed by callback					
			tractive_effort_coefficient:    0.3;
			air_drag_coefficient:			0;
		}
		graphics {
			/* Menu */
			additional_text:                string(STR_DESC_923_SERIES);
			//cargo_subtype_text:             sw_923_series_year_dep_subtype_text;
			can_attach_wagon:				sw_attach_mu_car_full;
			start_stop:						sw_stop_start_full_length_4;
			/* Graphics */
			default:                        sw_923_series_graphics;
			purchase:                      	sw_923_series_purchase;
			articulated_part:               sw_923_series_articulated_part;
			visual_effect_and_powered:      sw_visual_effect_and_powered;
			/* Stats */
			length:                         sw_length_1_8_1;
			power:							max ( NumberCarsInConsist() - 2 , 0 ) * 369 * 4;
			weight:							NumberCarsInConsist() * 44;
			//speed:						240 km/h;
			cargo_capacity:                	26 * CapacityFactor();											
			loading_speed:					26 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
			cargo_age_period:				param_decay_express;
			cost_factor:                    130;
			running_cost_factor:            sw_923_series_running_cost_factor;
			purchase_running_cost_factor:   295 + 125 * NumberCarsInConsist();
		}
		livery_override(mu_car_full){
			default:                        sw_923_series_graphics;
			cargo_capacity:                 26 * CapacityFactor();	
			cargo_age_period:				param_decay_express;
			loading_speed:                  26 * CapacityFactor() / param_loading_2D;
			articulated_part:				sw_mucar_full_articulated_part;
			length:							sw_length_1_8_1;
		}
	}}
# 1 "src/trains/700_series/700_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/500_series/500_series.pnml" 1

# 1 "src/trains/500_series/500_series_menu.pnml" 1
/* Subtypes*/

	switch(FEAT_TRAINS, SELF, sw_500_series_subtype_text, cargo_subtype) {
		0: return string(LV_500_SERIES); 
        1: return string(LV_500_SERIES_2CC);
        2: return string(LV_500_SERIES_EVA);
		3: return string(LV_500_SERIES_HK); 
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_500_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_500_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral; 
            1: ss_500_series_buy;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_500_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_500_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_500_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_500_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_500_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_500_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_500_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_500_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_500_series_cab01f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_500_series_cab01b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_500_series_cab01f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_500_series_cab01b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_500_series_cab01f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_500_series_cab01b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_500_series_cab01f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_500_series_cab01b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_rev(1,51)}

    // Hello Kitty

    // 10/8
	spriteset(ss_std_500_series_cab01f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_500_series_cab01b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_500_series_cab01f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_500_series_cab01b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_500_series_cab01f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_500_series_cab01b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_500_series_cab01f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_500_series_cab01b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,51)}

    // Type EVA

	// 10/8
	spriteset(ss_std_500_series_cab01f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_500_series_cab01b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_500_series_cab01f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_500_series_cab01b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_500_series_cab01f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_500_series_cab01b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_500_series_cab01f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_500_series_cab01b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,51)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_cab01f_mask, cargo_subtype) {1:ss_frt_500_series_cab01f_2cc; 2:ss_frt_500_series_cab01f_eva;  3:ss_frt_500_series_cab01f_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_500_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_cab01f_mask, cargo_subtype) {1:ss_mid_500_series_cab01f_2cc; 2:ss_mid_500_series_cab01f_eva; 3:ss_mid_500_series_cab01f_hk; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_500_series_cab01f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_cab01f_mask, cargo_subtype) {1:ss_std_500_series_cab01f_2cc; 2:ss_std_500_series_cab01f_eva; 3:ss_std_500_series_cab01f_hk; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab01f_mask, HideLongSprite() ) { 0: sw_std_500_series_cab01f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_cab01f_irl;       	    // Base for Mid
                1: ss_mid_500_series_cab01f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_cab01f_irl;	    // Base for LongSprite
				3: longsprite_500_series_cab01f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_cab01f_mask, cargo_subtype) {1:ss_bck_500_series_cab01f_2cc; 2:ss_bck_500_series_cab01f_eva;  3:ss_bck_500_series_cab01f_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_cab01f_irl;       	    // Base for Front
				1: ss_bck_500_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_cab01f, position_in_consist % 3 ) {				
            0: sw_500_series_cab01f_frt_longsprite;
            1: sw_500_series_cab01f_mid_stack;
            2: sw_500_series_cab01f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_cab01b_mask, cargo_subtype) {1:ss_frt_500_series_cab01b_2cc; 2:ss_frt_500_series_cab01b_eva;  3:ss_frt_500_series_cab01b_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_500_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_cab01b_mask, cargo_subtype) {1:ss_mid_500_series_cab01b_2cc; 2:ss_mid_500_series_cab01b_eva; 3:ss_mid_500_series_cab01b_hk; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_500_series_cab01b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_cab01b_mask, cargo_subtype) {1:ss_std_500_series_cab01b_2cc; 2:ss_std_500_series_cab01b_eva; 3:ss_std_500_series_cab01b_hk; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab01b_mask, HideLongSprite() ) { 0: sw_std_500_series_cab01b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_cab01b_irl;       	    // Base for Mid
                1: ss_mid_500_series_cab01b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_cab01b_irl;	    // Base for LongSprite
				3: longsprite_500_series_cab01b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_cab01b_mask, cargo_subtype) {1:ss_bck_500_series_cab01b_2cc; 2:ss_bck_500_series_cab01b_eva;  3:ss_bck_500_series_cab01b_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_cab01b_irl;       	    // Base for Front
				1: ss_bck_500_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_cab01b_frt_longsprite;
            1: sw_500_series_cab01b_mid_stack;
            2: sw_500_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_500_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_500_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_500_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_500_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_500_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_500_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_500_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_500_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_500_series_cab02f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_500_series_cab02b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front    
	spriteset(ss_frt_500_series_cab02f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_500_series_cab02b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_500_series_cab02f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_500_series_cab02b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_500_series_cab02f_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_500_series_cab02b_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Hello Kitty

    // 10/8
	spriteset(ss_std_500_series_cab02f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_cab_std(1,451)}
	spriteset(ss_std_500_series_cab02b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_cab_rev(1,401)}

	// Front
	spriteset(ss_frt_500_series_cab02f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_frt_std(1,451)}
	spriteset(ss_frt_500_series_cab02b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_frt_rev(1,401)}
	// Mid
	spriteset(ss_mid_500_series_cab02f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_mid_std(1,451)}
	spriteset(ss_mid_500_series_cab02b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_mid_rev(1,401)}
	// Back
	spriteset(ss_bck_500_series_cab02f_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_bck_std(1,451)}
	spriteset(ss_bck_500_series_cab02b_hk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_cab_bck_rev(1,401)}

    // Type EVA

	// 10/8
	spriteset(ss_std_500_series_cab02f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_cab_std(1,451)}
	spriteset(ss_std_500_series_cab02b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_cab_rev(1,401)}

	// Front
	spriteset(ss_frt_500_series_cab02f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_frt_std(1,451)}
	spriteset(ss_frt_500_series_cab02b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_frt_rev(1,401)}
	// Mid
	spriteset(ss_mid_500_series_cab02f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_mid_std(1,451)}
	spriteset(ss_mid_500_series_cab02b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_mid_rev(1,401)}
	// Back
	spriteset(ss_bck_500_series_cab02f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_bck_std(1,451)}
	spriteset(ss_bck_500_series_cab02b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_cab_bck_rev(1,401)}


// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_cab02f_mask, cargo_subtype) {1:ss_frt_500_series_cab02f_2cc; 2:ss_frt_500_series_cab02f_eva;  3:ss_frt_500_series_cab02f_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_cab02f_irl;       	    // Base for Front
				1: ss_frt_500_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_cab02f_mask, cargo_subtype) {1:ss_mid_500_series_cab02f_2cc; 2:ss_mid_500_series_cab02f_eva; 3:ss_mid_500_series_cab02f_hk; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_500_series_cab02f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_cab02f_mask, cargo_subtype) {1:ss_std_500_series_cab02f_2cc; 2:ss_std_500_series_cab02f_eva; 3:ss_std_500_series_cab02f_hk; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab02f_mask, HideLongSprite() ) { 0: sw_std_500_series_cab02f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_cab02f_irl;       	    // Base for Mid
                1: ss_mid_500_series_cab02f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_cab02f_irl;	    // Base for LongSprite
				3: longsprite_500_series_cab02f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_cab02f_mask, cargo_subtype) {1:ss_bck_500_series_cab02f_2cc; 2:ss_bck_500_series_cab02f_eva;  3:ss_bck_500_series_cab02f_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_cab02f_irl;       	    // Base for Front
				1: ss_bck_500_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_500_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_cab02f_frt_longsprite;
            1: sw_500_series_cab02f_mid_stack;
            2: sw_500_series_cab02f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_cab02b_mask, cargo_subtype) {1:ss_frt_500_series_cab02b_2cc; 2:ss_frt_500_series_cab02b_eva;  3:ss_frt_500_series_cab02b_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_cab02b_irl;       	    // Base for Front
				1: ss_frt_500_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_500_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_cab02b_mask, cargo_subtype) {1:ss_mid_500_series_cab02b_2cc; 2:ss_mid_500_series_cab02b_eva; 3:ss_mid_500_series_cab02b_hk; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_500_series_cab02b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_cab02b_mask, cargo_subtype) {1:ss_std_500_series_cab02b_2cc; 2:ss_std_500_series_cab02b_eva; 3:ss_std_500_series_cab02b_hk; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_cab02b_mask, HideLongSprite() ) { 0: sw_std_500_series_cab02b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_cab02b_irl;       	    // Base for Mid
                1: ss_mid_500_series_cab02b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_cab02b_irl;	    // Base for LongSprite
				3: longsprite_500_series_cab02b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_cab02b_mask, cargo_subtype) {1:ss_bck_500_series_cab02b_2cc; 2:ss_bck_500_series_cab02b_eva;  3:ss_bck_500_series_cab02b_hk; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_cab02b_irl;       	    // Base for Front
				1: ss_bck_500_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_cab02b, position_in_consist% 3 ) {				
            0: sw_500_series_cab02b_frt_longsprite;
            1: sw_500_series_cab02b_mid_stack;
            2: sw_500_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_500_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_500_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_500_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_500_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_500_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_500_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_500_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_500_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_500_series_coachf_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_500_series_coachb_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_500_series_coachf_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_500_series_coachb_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_500_series_coachf_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_500_series_coachb_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_500_series_coachf_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_500_series_coachb_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coachf_mask, cargo_subtype) {1:ss_frt_500_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_500_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coachf_mask, cargo_subtype) {1:ss_mid_500_series_coachf_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_coachf_irl, HideLongSprite() ) { 0: ss_std_500_series_coachf_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_coachf_mask, cargo_subtype) {1:ss_std_500_series_coachf_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_coachf_mask, HideLongSprite() ) { 0: sw_std_500_series_coachf_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_coachf_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_coachf_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coachf_mask, cargo_subtype) {1:ss_bck_500_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coachf, position_in_consist % 3 ) {				
            0: sw_500_series_coachf_frt_longsprite;
            1: sw_500_series_coachf_mid_stack;
            2: sw_500_series_coachf_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coachb_mask, cargo_subtype) {1:ss_frt_500_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coachb_mask, cargo_subtype) {1:ss_mid_500_series_coachb_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_coachb_irl, HideLongSprite() ) { 0: ss_std_500_series_coachb_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_coachb_mask, cargo_subtype) {1:ss_std_500_series_coachb_2cc;}
                switch(FEAT_TRAINS, SELF, longsprite_500_series_coachb_mask, HideLongSprite() ) { 0: sw_std_500_series_coachb_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_coachb_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_coachb_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coachb_mask, cargo_subtype) {1:ss_bck_500_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_500_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_coachb_frt_longsprite;
            1: sw_500_series_coachb_mid_stack;
            2: sw_500_series_coachb_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_500_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_500_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_500_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_500_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_500_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_500_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_500_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_500_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_500_series_pantof_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_500_series_pantob_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_500_series_pantof_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_500_series_pantob_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_500_series_pantof_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_500_series_pantob_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_500_series_pantof_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_500_series_pantob_2cc, "src/trains/500_series/gfx/500_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pantof_mask, cargo_subtype) {1:ss_frt_500_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_pantof_irl;       	    // Base for Front
				1: ss_frt_500_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_500_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pantof_mask, cargo_subtype) {1:ss_mid_500_series_pantof_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_pantof_irl, HideLongSprite() ) { 0: ss_std_500_series_pantof_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_pantof_mask, cargo_subtype) {1:ss_std_500_series_pantof_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_500_series_pantof_mask, HideLongSprite() ) { 0: sw_std_500_series_pantof_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_pantof_irl;       	    // Base for Mid
                1: ss_mid_500_series_pantof_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_pantof_irl;	    // Base for LongSprite
				3: longsprite_500_series_pantof_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_500_f;
                5: panto_longsprite_500_f;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pantof_mask, cargo_subtype) {1:ss_bck_500_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_pantof_irl;       	    // Base for Front
				1: ss_bck_500_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pantof, position_in_consist % 3 ) {				
            0: sw_500_series_pantof_frt_longsprite;
            1: sw_500_series_pantof_mid_stack;
            2: sw_500_series_pantof_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pantob_mask, cargo_subtype) {1:ss_frt_500_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_pantob_irl;       	    // Base for Front
				1: ss_frt_500_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pantob_mask, cargo_subtype) {1:ss_mid_500_series_pantob_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_500_series_pantob_irl, HideLongSprite() ) { 0: ss_std_500_series_pantob_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_500_series_pantob_mask, cargo_subtype) {1:ss_std_500_series_pantob_2cc;}
                switch(FEAT_TRAINS, SELF, longsprite_500_series_pantob_mask, HideLongSprite() ) { 0: sw_std_500_series_pantob_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_pantob_irl;       	    // Base for Mid
                1: ss_mid_500_series_pantob_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_pantob_irl;	    // Base for LongSprite
				3: longsprite_500_series_pantob_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_500_b;
                5: panto_longsprite_500_b;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pantob_mask, cargo_subtype) {1:ss_bck_500_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_500_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_pantob_irl;       	    // Base for Front
				1: ss_bck_500_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_500_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_pantob_frt_longsprite;
            1: sw_500_series_pantob_mid_stack;
            2: sw_500_series_pantob_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_coac3.pnml" 1

/* coac3 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_coac3f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,151)}
        spriteset(ss_std_500_series_coac3b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,151)}

        // Front
        spriteset(ss_frt_500_series_coac3f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,151)}
        spriteset(ss_frt_500_series_coac3b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,151)}
        // Mid
        spriteset(ss_mid_500_series_coac3f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,151)}
        spriteset(ss_mid_500_series_coac3b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,151)}
        // Back
        spriteset(ss_bck_500_series_coac3f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,151)}
        spriteset(ss_bck_500_series_coac3b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,151)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_coac3f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,151)}
        spriteset(ss_std_500_series_coac3b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,151)}

        // Front
        spriteset(ss_frt_500_series_coac3f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,151)}
        spriteset(ss_frt_500_series_coac3b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,151)}
        // Mid
        spriteset(ss_mid_500_series_coac3f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,151)}
        spriteset(ss_mid_500_series_coac3b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,151)}
        // Back
        spriteset(ss_bck_500_series_coac3f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,151)}
        spriteset(ss_bck_500_series_coac3b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac3f_mask, cargo_subtype) {2:ss_frt_500_series_coac3f_eva; 3:ss_frt_500_series_coac3f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_coac3f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_coac3f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac3f_mask, cargo_subtype) {2:ss_mid_500_series_coac3f_eva; 3:ss_mid_500_series_coac3f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac3f_mask, cargo_subtype) {2:ss_std_500_series_coac3f_eva; 3:ss_std_500_series_coac3f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac3f_mask, HideLongSprite() ) { 0: sw_std_500_series_coac3f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac3f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac3f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac3f_mask;       // Masks for LongSprite
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac3f_mask, cargo_subtype) {2:ss_bck_500_series_coac3f_eva; 3:ss_bck_500_series_coac3f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_coac3f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_coac3f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac3f, position_in_consist % 3 ) {				
            0: sw_500_series_coac3f_frt_longsprite;
            1: sw_500_series_coac3f_mid_stack;
            2: sw_500_series_coac3f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac3b_mask, cargo_subtype) {2:ss_frt_500_series_coac3b_eva; 3:ss_frt_500_series_coac3b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_coac3b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_coac3b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac3b_mask, cargo_subtype) {2:ss_mid_500_series_coac3b_eva; 3:ss_mid_500_series_coac3b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac3b_mask, cargo_subtype) {2:ss_std_500_series_coac3b_eva; 3:ss_std_500_series_coac3b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac3b_mask, HideLongSprite() ) { 0: sw_std_500_series_coac3b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac3b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac3b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac3b_mask;       // Masks for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac3b_mask, cargo_subtype) {2:ss_bck_500_series_coac3b_eva; 3:ss_bck_500_series_coac3b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_coac3b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac3b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_coac3b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac3b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_coac3b_frt_longsprite;
            1: sw_500_series_coac3b_mid_stack;
            2: sw_500_series_coac3b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_coac4.pnml" 1

/* coac4 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_coac4f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,201)}
        spriteset(ss_std_500_series_coac4b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,201)}

        // Front
        spriteset(ss_frt_500_series_coac4f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,201)}
        spriteset(ss_frt_500_series_coac4b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,201)}
        // Mid
        spriteset(ss_mid_500_series_coac4f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,201)}
        spriteset(ss_mid_500_series_coac4b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,201)}
        // Back
        spriteset(ss_bck_500_series_coac4f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,201)}
        spriteset(ss_bck_500_series_coac4b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,201)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_coac4f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,201)}
        spriteset(ss_std_500_series_coac4b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,201)}

        // Front
        spriteset(ss_frt_500_series_coac4f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,201)}
        spriteset(ss_frt_500_series_coac4b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,201)}
        // Mid
        spriteset(ss_mid_500_series_coac4f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,201)}
        spriteset(ss_mid_500_series_coac4b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,201)}
        // Back
        spriteset(ss_bck_500_series_coac4f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,201)}
        spriteset(ss_bck_500_series_coac4b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,201)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac4f_mask, cargo_subtype) {2:ss_frt_500_series_coac4f_eva; 3:ss_frt_500_series_coac4f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_coac4f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_coac4f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac4f_mask, cargo_subtype) {2:ss_mid_500_series_coac4f_eva; 3:ss_mid_500_series_coac4f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac4f_mask, cargo_subtype) {2:ss_std_500_series_coac4f_eva; 3:ss_std_500_series_coac4f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac4f_mask, HideLongSprite() ) { 0: sw_std_500_series_coac4f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac4f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac4f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac4f_mask;       // Masks for LongSprite
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac4f_mask, cargo_subtype) {2:ss_bck_500_series_coac4f_eva; 3:ss_bck_500_series_coac4f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_coac4f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_coac4f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac4f, position_in_consist % 3 ) {				
            0: sw_500_series_coac4f_frt_longsprite;
            1: sw_500_series_coac4f_mid_stack;
            2: sw_500_series_coac4f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac4b_mask, cargo_subtype) {2:ss_frt_500_series_coac4b_eva; 3:ss_frt_500_series_coac4b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_coac4b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_coac4b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac4b_mask, cargo_subtype) {2:ss_mid_500_series_coac4b_eva; 3:ss_mid_500_series_coac4b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac4b_mask, cargo_subtype) {2:ss_std_500_series_coac4b_eva; 3:ss_std_500_series_coac4b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac4b_mask, HideLongSprite() ) { 0: sw_std_500_series_coac4b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac4b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac4b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac4b_mask;       // Masks for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac4b_mask, cargo_subtype) {2:ss_bck_500_series_coac4b_eva; 3:ss_bck_500_series_coac4b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_coac4b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac4b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_coac4b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac4b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_coac4b_frt_longsprite;
            1: sw_500_series_coac4b_mid_stack;
            2: sw_500_series_coac4b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_coac5.pnml" 1

/* coac5 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_coac5f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,251)}
        spriteset(ss_std_500_series_coac5b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,251)}

        // Front
        spriteset(ss_frt_500_series_coac5f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,251)}
        spriteset(ss_frt_500_series_coac5b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,251)}
        // Mid
        spriteset(ss_mid_500_series_coac5f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,251)}
        spriteset(ss_mid_500_series_coac5b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,251)}
        // Back
        spriteset(ss_bck_500_series_coac5f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,251)}
        spriteset(ss_bck_500_series_coac5b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,251)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_coac5f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,251)}
        spriteset(ss_std_500_series_coac5b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,251)}

        // Front
        spriteset(ss_frt_500_series_coac5f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,251)}
        spriteset(ss_frt_500_series_coac5b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,251)}
        // Mid
        spriteset(ss_mid_500_series_coac5f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,251)}
        spriteset(ss_mid_500_series_coac5b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,251)}
        // Back
        spriteset(ss_bck_500_series_coac5f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,251)}
        spriteset(ss_bck_500_series_coac5b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,251)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac5f_mask, cargo_subtype) {2:ss_frt_500_series_coac5f_eva; 3:ss_frt_500_series_coac5f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_coac5f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_coac5f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac5f_mask, cargo_subtype) {2:ss_mid_500_series_coac5f_eva; 3:ss_mid_500_series_coac5f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac5f_mask, cargo_subtype) {2:ss_std_500_series_coac5f_eva; 3:ss_std_500_series_coac5f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac5f_mask, HideLongSprite() ) { 0: sw_std_500_series_coac5f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac5f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac5f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac5f_mask;       // Masks for LongSprite
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac5f_mask, cargo_subtype) {2:ss_bck_500_series_coac5f_eva; 3:ss_bck_500_series_coac5f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_coac5f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_coac5f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac5f, position_in_consist % 3 ) {				
            0: sw_500_series_coac5f_frt_longsprite;
            1: sw_500_series_coac5f_mid_stack;
            2: sw_500_series_coac5f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac5b_mask, cargo_subtype) {2:ss_frt_500_series_coac5b_eva; 3:ss_frt_500_series_coac5b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_coac5b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_coac5b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac5b_mask, cargo_subtype) {2:ss_mid_500_series_coac5b_eva; 3:ss_mid_500_series_coac5b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac5b_mask, cargo_subtype) {2:ss_std_500_series_coac5b_eva; 3:ss_std_500_series_coac5b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac5b_mask, HideLongSprite() ) { 0: sw_std_500_series_coac5b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac5b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac5b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac5b_mask;       // Masks for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac5b_mask, cargo_subtype) {2:ss_bck_500_series_coac5b_eva; 3:ss_bck_500_series_coac5b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_coac5b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac5b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_coac5b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac5b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_coac5b_frt_longsprite;
            1: sw_500_series_coac5b_mid_stack;
            2: sw_500_series_coac5b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_coac6.pnml" 1

/* coac6 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_coac6f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,301)}
        spriteset(ss_std_500_series_coac6b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,301)}

        // Front
        spriteset(ss_frt_500_series_coac6f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,301)}
        spriteset(ss_frt_500_series_coac6b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,301)}
        // Mid
        spriteset(ss_mid_500_series_coac6f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,301)}
        spriteset(ss_mid_500_series_coac6b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,301)}
        // Back
        spriteset(ss_bck_500_series_coac6f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,301)}
        spriteset(ss_bck_500_series_coac6b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,301)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_coac6f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,301)}
        spriteset(ss_std_500_series_coac6b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,301)}

        // Front
        spriteset(ss_frt_500_series_coac6f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,301)}
        spriteset(ss_frt_500_series_coac6b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,301)}
        // Mid
        spriteset(ss_mid_500_series_coac6f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,301)}
        spriteset(ss_mid_500_series_coac6b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,301)}
        // Back
        spriteset(ss_bck_500_series_coac6f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,301)}
        spriteset(ss_bck_500_series_coac6b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,301)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac6f_mask, cargo_subtype) {2:ss_frt_500_series_coac6f_eva; 3:ss_frt_500_series_coac6f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_coac6f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_coac6f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac6f_mask, cargo_subtype) {2:ss_mid_500_series_coac6f_eva; 3:ss_mid_500_series_coac6f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac6f_mask, cargo_subtype) {2:ss_std_500_series_coac6f_eva; 3:ss_std_500_series_coac6f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac6f_mask, HideLongSprite() ) { 0: sw_std_500_series_coac6f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac6f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac6f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac6f_mask;       // Masks for LongSprite
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac6f_mask, cargo_subtype) {2:ss_bck_500_series_coac6f_eva; 3:ss_bck_500_series_coac6f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_coac6f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_coac6f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac6f, position_in_consist % 3 ) {				
            0: sw_500_series_coac6f_frt_longsprite;
            1: sw_500_series_coac6f_mid_stack;
            2: sw_500_series_coac6f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_coac6b_mask, cargo_subtype) {2:ss_frt_500_series_coac6b_eva; 3:ss_frt_500_series_coac6b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_coac6b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_coac6b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_coac6b_mask, cargo_subtype) {2:ss_mid_500_series_coac6b_eva; 3:ss_mid_500_series_coac6b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_coac6b_mask, cargo_subtype) {2:ss_std_500_series_coac6b_eva; 3:ss_std_500_series_coac6b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_coac6b_mask, HideLongSprite() ) { 0: sw_std_500_series_coac6b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_coac6b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_coac6b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_coac6b_mask;       // Masks for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_coac6b_mask, cargo_subtype) {2:ss_bck_500_series_coac6b_eva; 3:ss_bck_500_series_coac6b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_coac6b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_coac6b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_coac6b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_coac6b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_coac6b_frt_longsprite;
            1: sw_500_series_coac6b_mid_stack;
            2: sw_500_series_coac6b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_pant2.pnml" 1

/* pant2 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_pant2f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,101)}
        spriteset(ss_std_500_series_pant2b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,101)}

        // Front
        spriteset(ss_frt_500_series_pant2f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,101)}
        spriteset(ss_frt_500_series_pant2b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,101)}
        // Mid
        spriteset(ss_mid_500_series_pant2f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,101)}
        spriteset(ss_mid_500_series_pant2b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,101)}
        // Back
        spriteset(ss_bck_500_series_pant2f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,101)}
        spriteset(ss_bck_500_series_pant2b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,101)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_pant2f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,101)}
        spriteset(ss_std_500_series_pant2b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,101)}

        // Front
        spriteset(ss_frt_500_series_pant2f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,101)}
        spriteset(ss_frt_500_series_pant2b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,101)}
        // Mid
        spriteset(ss_mid_500_series_pant2f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,101)}
        spriteset(ss_mid_500_series_pant2b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,101)}
        // Back
        spriteset(ss_bck_500_series_pant2f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,101)}
        spriteset(ss_bck_500_series_pant2b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pant2f_mask, cargo_subtype) {2:ss_frt_500_series_pant2f_eva; 3:ss_frt_500_series_pant2f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_pant2f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_pant2f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pant2f_mask, cargo_subtype) {2:ss_mid_500_series_pant2f_eva; 3:ss_mid_500_series_pant2f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_pant2f_mask, cargo_subtype) {2:ss_std_500_series_pant2f_eva; 3:ss_std_500_series_pant2f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_pant2f_mask, HideLongSprite() ) { 0: sw_std_500_series_pant2f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pant2f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_pant2f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_pant2f_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_500_f;
                5: panto_longsprite_500_f;
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pant2f_mask, cargo_subtype) {2:ss_bck_500_series_pant2f_eva; 3:ss_bck_500_series_pant2f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_pant2f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_pant2f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pant2f, position_in_consist % 3 ) {				
            0: sw_500_series_pant2f_frt_longsprite;
            1: sw_500_series_pant2f_mid_stack;
            2: sw_500_series_pant2f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pant2b_mask, cargo_subtype) {2:ss_frt_500_series_pant2b_eva; 3:ss_frt_500_series_pant2b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_pant2b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_pant2b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pant2b_mask, cargo_subtype) {2:ss_mid_500_series_pant2b_eva; 3:ss_mid_500_series_pant2b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_pant2b_mask, cargo_subtype) {2:ss_std_500_series_pant2b_eva; 3:ss_std_500_series_pant2b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_pant2b_mask, HideLongSprite() ) { 0: sw_std_500_series_pant2b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pant2b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_pant2b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_pant2b_mask;       // Masks for LongSprite
                // pant2s
                4: panto_midsprite_500_b;
                5: panto_longsprite_500_b;
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pant2b_mask, cargo_subtype) {2:ss_bck_500_series_pant2b_eva; 3:ss_bck_500_series_pant2b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_pant2b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant2b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_pant2b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pant2b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_pant2b_frt_longsprite;
            1: sw_500_series_pant2b_mid_stack;
            2: sw_500_series_pant2b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_pant7.pnml" 1

/* pant7 */

// Sprites

	// Hello Kitty

        // 10/8
        spriteset(ss_std_500_series_pant7f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_std(1,151)}
        spriteset(ss_std_500_series_pant7b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_10_rev(1,151)}

        // Front
        spriteset(ss_frt_500_series_pant7f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_std(1,151)}
        spriteset(ss_frt_500_series_pant7b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_frt_rev(1,151)}
        // Mid
        spriteset(ss_mid_500_series_pant7f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_std(1,151)}
        spriteset(ss_mid_500_series_pant7b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_mid_rev(1,151)}
        // Back
        spriteset(ss_bck_500_series_pant7f_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_std(1,151)}
        spriteset(ss_bck_500_series_pant7b_hik, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_hk.png") {tmpl_bck_rev(1,151)}

    // Type EVA

        // 10/8
        spriteset(ss_std_500_series_pant7f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_std(1,351)}
        spriteset(ss_std_500_series_pant7b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_10_rev(1,351)}

        // Front
        spriteset(ss_frt_500_series_pant7f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_std(1,351)}
        spriteset(ss_frt_500_series_pant7b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_frt_rev(1,351)}
        // Mid
        spriteset(ss_mid_500_series_pant7f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_std(1,351)}
        spriteset(ss_mid_500_series_pant7b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_mid_rev(1,351)}
        // Back
        spriteset(ss_bck_500_series_pant7f_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_std(1,351)}
        spriteset(ss_bck_500_series_pant7b_eva, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/500_series/gfx/500_series_eva.png") {tmpl_bck_rev(1,351)}

// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pant7f_mask, cargo_subtype) {2:ss_frt_500_series_pant7f_eva; 3:ss_frt_500_series_pant7f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachf_irl;       	    // Base for Front
				1: ss_frt_500_series_pant7f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7f_frt_longsprite, NextPartSame() ) { 1: sw_500_series_pant7f_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pant7f_mask, cargo_subtype) {2:ss_mid_500_series_pant7f_eva; 3:ss_mid_500_series_pant7f_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_pant7f_mask, cargo_subtype) {2:ss_std_500_series_pant7f_eva; 3:ss_std_500_series_pant7f_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_pant7f_mask, HideLongSprite() ) { 0: sw_std_500_series_pant7f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pant7f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_500_series_pant7f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_500_series_pant7f_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_500_b;
                5: panto_longsprite_500_b;
			}

		// Back		
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pant7f_mask, cargo_subtype) {2:ss_bck_500_series_pant7f_eva; 3:ss_bck_500_series_pant7f_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachf_irl;       	    // Base for Front
				1: ss_bck_500_series_pant7f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7f_bck_longsprite, PrevPartSame() ) { 1: sw_500_series_pant7f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pant7f, position_in_consist % 3 ) {				
            0: sw_500_series_pant7f_frt_longsprite;
            1: sw_500_series_pant7f_mid_stack;
            2: sw_500_series_pant7f_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_500_series_pant7b_mask, cargo_subtype) {2:ss_frt_500_series_pant7b_eva; 3:ss_frt_500_series_pant7b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_500_series_coachb_irl;       	    // Base for Front
				1: ss_frt_500_series_pant7b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7b_frt_longsprite, PrevPartSame() ) { 1: sw_500_series_pant7b_frt_stack; dummy_sprites; }

		/* MID */
        switch(FEAT_TRAINS, PARENT, ss_mid_500_series_pant7b_mask, cargo_subtype) {2:ss_mid_500_series_pant7b_eva; 3:ss_mid_500_series_pant7b_hik;}

        switch(FEAT_TRAINS, PARENT, sw_std_500_series_pant7b_mask, cargo_subtype) {2:ss_std_500_series_pant7b_eva; 3:ss_std_500_series_pant7b_hik;}        
        switch(FEAT_TRAINS, SELF, longsprite_500_series_pant7b_mask, HideLongSprite() ) { 0: sw_std_500_series_pant7b_mask; }  
            
		switch(FEAT_TRAINS, SELF, sw_500_series_pant7b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_500_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_500_series_pant7b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_500_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_500_series_pant7b_mask;       // Masks for LongSprite
                // pant7s
                4: panto_midsprite_500_f;
                5: panto_longsprite_500_f;
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_500_series_pant7b_mask, cargo_subtype) {2:ss_bck_500_series_pant7b_eva; 3:ss_bck_500_series_pant7b_hik;}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_500_series_coachb_irl;       	    // Base for Front
				1: ss_bck_500_series_pant7b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_500_series_pant7b_bck_longsprite, NextPartSame() ) { 1: sw_500_series_pant7b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_500_series_pant7b, position_in_consist_from_end % 3 ) {				
            0: sw_500_series_pant7b_frt_longsprite;
            1: sw_500_series_pant7b_mid_stack;
            2: sw_500_series_pant7b_bck_longsprite;
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_formations.pnml" 1


/* Hello Kitty & Type EVA */

    // Backwards
        // Short
        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_backwards_short, CarNumber() ) {				
            2: sw_500_series_pant7b;
            3: sw_500_series_coac6b;
            4: sw_500_series_coac5b;
            5: sw_500_series_coac4b;
            6: sw_500_series_coac3b;
            7: sw_500_series_pant2b;
            sw_500_series_coachb;	
        }

        // Penultimates
        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_backwards_long_consist, (CarNumber() - 2) % 4 ) {				
            1: sw_500_series_coac6b;
            2: sw_500_series_coac5b;
            3: sw_500_series_coac4b;
            sw_500_series_coac3b;
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_backwards_long_pantos, CarNumberFromEnd() == 2 ) {				
            1: sw_500_series_pant2b;
            sw_500_series_pant7b;	
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_backwards_long, CarNumber() == 2 || CarNumberFromEnd() == 2 ) {				
            1: sw_500_series_hkeva_backwards_long_pantos;
            sw_500_series_hkeva_backwards_long_consist;	
        }

    switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_backwards, num_vehs_in_consist) {				
            0..23:  sw_500_series_hkeva_backwards_short;
            sw_500_series_hkeva_backwards_long;				
        }

    // Forwards
        // Short
        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_forwards_short, CarNumberFromEnd() ) {				
            2: sw_500_series_pant7f;
            3: sw_500_series_coac6f;
            4: sw_500_series_coac5f;
            5: sw_500_series_coac4f;
            6: sw_500_series_coac3f;
            7: sw_500_series_pant2f;
            sw_500_series_coachf;	
        }

        // Penultimates
        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_forwards_long_consist, (CarNumberFromEnd() - 2) % 4 ) {				
            1: sw_500_series_coac6f;
            2: sw_500_series_coac5f;
            3: sw_500_series_coac4f;
            sw_500_series_coac3f;
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_forwards_long_pantos, CarNumber() == 2 ) {				
            1: sw_500_series_pant2f;
            sw_500_series_pant7f;	
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_forwards_long, CarNumber() == 2 || CarNumberFromEnd() == 2 ) {				
            1: sw_500_series_hkeva_forwards_long_pantos;
            sw_500_series_hkeva_forwards_long_consist;	
        }


    switch (FEAT_TRAINS, SELF, sw_500_series_hkeva_forwards, num_vehs_in_consist) {				
            0..23:  sw_500_series_hkeva_forwards_short;
            sw_500_series_hkeva_forwards_long;				
        }

/* Basic */

    // Backwards

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards_long_pick_panto, CarNumberFromEnd() == 5 ) {				
            1:  sw_500_series_pantof;	
            sw_500_series_pantob;		
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards_long, CarNumberFromEnd() == 5 || CarNumber()  == 4 ) {					
            1:  sw_500_series_basic_backwards_long_pick_panto;
            sw_500_series_coachf;				
        }
        
        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards_penultimate_pick_panto, CarNumberFromEnd() == 2 ) {				
            1:  sw_500_series_pantof;	
            sw_500_series_pantob;		
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_500_series_basic_backwards_penultimate_pick_panto;
            sw_500_series_coachf;				
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_500_series_pantof;
            sw_500_series_coachf;           				
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_backwards, num_vehs_in_consist) {				
            0..20:  sw_500_series_basic_backwards_middle;
            21..47:  sw_500_series_basic_backwards_penultimates;
            sw_500_series_basic_backwards_long;				
        }


    // Forwards

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards_long_pick_panto, CarNumber() == 5 ) {				
            1:  sw_500_series_pantof;	
            sw_500_series_pantob;		
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards_long, CarNumber() == 5 || CarNumberFromEnd()  == 4 ) {					
            1:  sw_500_series_basic_forwards_long_pick_panto;
            sw_500_series_coachf;				
        }
        
        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards_penultimate_pick_panto, CarNumber() == 2 ) {				
            1:  sw_500_series_pantof;	
            sw_500_series_pantob;		
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_500_series_basic_forwards_penultimate_pick_panto;
            sw_500_series_coachf;				
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_500_series_pantof;
            sw_500_series_coachf;           				
        }

        switch (FEAT_TRAINS, SELF, sw_500_series_basic_forwards, num_vehs_in_consist) {				
            0..20:  sw_500_series_basic_forwards_middle;
            21..47:  sw_500_series_basic_forwards_penultimates;
            sw_500_series_basic_forwards_long;				
        }


/* Forwards or Backwards */
    
    switch (FEAT_TRAINS, PARENT, sw_500_series_backwards, cargo_subtype ) {				
            2..3:  sw_500_series_hkeva_backwards;
            sw_500_series_basic_backwards;				
        }

    switch (FEAT_TRAINS, PARENT, sw_500_series_forwards, cargo_subtype ) {				
            2..3:  sw_500_series_hkeva_forwards;
            sw_500_series_basic_forwards;				
        }
    
    switch (FEAT_TRAINS, PARENT, sw_500_series_midcars, vehicle_is_reversed) {				
            0:  sw_500_series_forwards;
            sw_500_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_500_series_rear, vehicle_is_reversed) {				
            1: sw_500_series_cab01b;
            sw_500_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_500_series_lead, vehicle_is_reversed) {				
            1: sw_500_series_cab02b;
            sw_500_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_500_series_cabs, position_in_consist) {				
            0..2: sw_500_series_lead;
            sw_500_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_500_series_graphics, IsCab() ) {				
            1:  sw_500_series_cabs;
            sw_500_series_midcars;	
        }
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "src/trains/500_series/500_series_item.pnml" 1

// Articulation
switch (FEAT_TRAINS, SELF, sw_500_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_500;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_500) {
	property {
		/* Menu */
		name: 							string(STR_NAME_500_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          301 km/h;				
		power:                          18240 kW;	                // Changed by callback		
		weight:                         42*16 tons;	                // Changed by callback			
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_500_SERIES);
		cargo_subtype_text:             sw_500_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                42;
        purchase_power:                 382 * 4;
		/* Graphics */
		default:                        sw_500_series_graphics;
		purchase:                       sw_500_series_purchase;
		articulated_part:               sw_500_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
		weight:							NumberCarsInConsist() * 42;
		power:							NumberCarsInConsist() * 382 * 4;	// 285 kW
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    145;
		running_cost_factor:            (310 + 130 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   310 + 130 * NumberCarsInConsist();	
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_500_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_500_series_running_costs;
      }
}
# 1 "src/trains/500_series/500_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/300_series/300_series.pnml" 1

# 1 "src/trains/300_series/300_series_menu.pnml" 1
/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_300_series_subtype_text, cargo_subtype) {
		0: return string(LV_300_SERIES);                            
		1: return string(LV_300_SERIES_2CC); 
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_300_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_300_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrwestcentral; 
            1: ss_300_series_buy;
        }
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_300_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_300_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_300_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_300_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_300_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_300_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_300_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_300_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_300_series_cab01f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_300_series_cab01b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_300_series_cab01f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_300_series_cab01b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_300_series_cab01f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_300_series_cab01b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_300_series_cab01f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_300_series_cab01b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_cab01f_mask, cargo_subtype) {1:ss_frt_300_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_cab01f_irl;       	// Base for Front
				1: ss_frt_300_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_300_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_cab01f_mask, cargo_subtype) {1:ss_mid_300_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_cab01f_mask, cargo_subtype) {1:ss_std_300_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab01f_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_300_series_cab01f_mask;		// Mask for Mid
				2: sw_300_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_cab01f_mask, cargo_subtype) {1:ss_bck_300_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_cab01f_irl;       	// Base for Front
				1: ss_bck_300_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_300_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_cab01f, position_in_consist % 3 ) {				
            0: sw_300_series_cab01f_frt_longsprite;
            1: sw_300_series_cab01f_mid_stack;
            2: sw_300_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_cab01b_mask, cargo_subtype) {1:ss_frt_300_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_cab01b_irl;       	// Base for Front
				1: ss_frt_300_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_300_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_cab01b_mask, cargo_subtype) {1:ss_mid_300_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_cab01b_mask, cargo_subtype) {1:ss_std_300_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab01b_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_300_series_cab01b_mask;		// Mask for Mid
				2: sw_300_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_cab01b_mask, cargo_subtype) {1:ss_bck_300_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_cab01b_irl;       	// Base for Front
				1: ss_bck_300_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_300_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_300_series_cab01b_frt_longsprite;
            1: sw_300_series_cab01b_mid_stack;
            2: sw_300_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_300_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_300_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_300_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_300_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_300_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_300_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_300_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_300_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_300_series_cab02f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_300_series_cab02b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_300_series_cab02f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_300_series_cab02b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_300_series_cab02f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_300_series_cab02b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_300_series_cab02f_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_300_series_cab02b_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_cab02f_mask, cargo_subtype) {1:ss_frt_300_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_cab02f_irl;       	// Base for Front
				1: ss_frt_300_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_300_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_cab02f_mask, cargo_subtype) {1:ss_mid_300_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_cab02f_mask, cargo_subtype) {1:ss_std_300_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab02f_irl; }

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_300_series_cab02f_mask;		// Mask for Mid
				2: sw_300_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_cab02f_mask, cargo_subtype) {1:ss_bck_300_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_cab02f_irl;       	// Base for Front
				1: ss_bck_300_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_300_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_300_series_cab02f_frt_longsprite;
            1: sw_300_series_cab02f_mid_stack;
            2: sw_300_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_cab02b_mask, cargo_subtype) {1:ss_frt_300_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_cab02b_irl;       	// Base for Front
				1: ss_frt_300_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_300_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_cab02b_mask, cargo_subtype) {1:ss_mid_300_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_cab02b_mask, cargo_subtype) {1:ss_std_300_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_300_series_cab02b_mask;		// Mask for Mid
				2: sw_300_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_cab02b_mask, cargo_subtype) {1:ss_bck_300_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_cab02b_irl;       	// Base for Front
				1: ss_bck_300_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_300_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_cab02b, position_in_consist % 3 ) {				
            0: sw_300_series_cab02b_frt_longsprite;
            1: sw_300_series_cab02b_mid_stack;
            2: sw_300_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_300_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_300_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_300_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_300_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_300_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_300_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_300_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_300_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_rev(1,151)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_300_series_coachf_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_300_series_coachb_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_300_series_coachf_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_300_series_coachb_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_300_series_coachf_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_300_series_coachb_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_300_series_coachf_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_300_series_coachb_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_coachf_mask, cargo_subtype) {1:ss_frt_300_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_coachf_irl;       	// Base for Front
				1: ss_frt_300_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_300_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_coachf_mask, cargo_subtype) {1:ss_mid_300_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_coachf_mask, cargo_subtype) {1:ss_std_300_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_coachf_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_coachf_irl;       	// Base for Mid
				1: ss_mid_300_series_coachf_mask;		// Mask for Mid
				2: sw_300_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_coachf_mask, cargo_subtype) {1:ss_bck_300_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_coachf_irl;       	// Base for Front
				1: ss_bck_300_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_300_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_coachf, position_in_consist % 3 ) {				
            0: sw_300_series_coachf_frt_longsprite;
            1: sw_300_series_coachf_mid_stack;
            2: sw_300_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_coachb_mask, cargo_subtype) {1:ss_frt_300_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_coachb_irl;       	// Base for Front
				1: ss_frt_300_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_300_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_coachb_mask, cargo_subtype) {1:ss_mid_300_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_coachb_mask, cargo_subtype) {1:ss_std_300_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_coachb_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_coachb_irl;       	// Base for Mid
				1: ss_mid_300_series_coachb_mask;		// Mask for Mid
				2: sw_300_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_coachb_mask, cargo_subtype) {1:ss_bck_300_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_coachb_irl;       	// Base for Front
				1: ss_bck_300_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_300_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_300_series_coachb_frt_longsprite;
            1: sw_300_series_coachb_mid_stack;
            2: sw_300_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_300_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_300_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_300_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_300_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_300_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_300_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_300_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_300_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/300_series/gfx/300_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_300_series_pantof_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_300_series_pantob_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_300_series_pantof_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_300_series_pantob_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_300_series_pantof_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_300_series_pantob_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_300_series_pantof_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_300_series_pantob_2cc, "src/trains/300_series/gfx/300_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_pantof_mask, cargo_subtype) {1:ss_frt_300_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_pantof_irl;       	// Base for Front
				1: ss_frt_300_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_300_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_pantof_mask, cargo_subtype) {1:ss_mid_300_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_pantof_mask, cargo_subtype) {1:ss_std_300_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_pantof_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_pantof_irl;       	// Base for Mid
				1: ss_mid_300_series_pantof_mask;		// Mask for Mid
				2: sw_300_series_pantof_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_pantof_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_pantof_mask, cargo_subtype) {1:ss_bck_300_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_pantof_irl;       	// Base for Front
				1: ss_bck_300_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_300_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_pantof, position_in_consist % 3 ) {				
            0: sw_300_series_pantof_frt_longsprite;
            1: sw_300_series_pantof_mid_stack;
            2: sw_300_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_300_series_pantob_mask, cargo_subtype) {1:ss_frt_300_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_300_series_pantob_irl;       	// Base for Front
				1: ss_frt_300_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_300_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_300_series_pantob_mask, cargo_subtype) {1:ss_mid_300_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_300_series_pantob_mask, cargo_subtype) {1:ss_std_300_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_mid_longsprite, HideLongSprite() ) { 0: ss_std_300_series_pantob_irl; }
		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_std_longsprite, HideLongSprite() ) { 0: ss_std_300_series_pantob_mask; }

		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_300_series_pantob_irl;       	// Base for Mid
				1: ss_mid_300_series_pantob_mask;		// Mask for Mid
				2: sw_300_series_pantob_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_300_series_pantob_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_300_series_pantob_mask, cargo_subtype) {1:ss_bck_300_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_300_series_pantob_irl;       	// Base for Front
				1: ss_bck_300_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_300_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_300_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_300_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_300_series_pantob_frt_longsprite;
            1: sw_300_series_pantob_mid_stack;
            2: sw_300_series_pantob_bck_longsprite;
        }
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_formations.pnml" 1
// Forwards

    switch (FEAT_TRAINS, SELF, sw_300_series_forwards_6th_and_5_from_end, CarNumber() == 6 || CarNumberFromEnd()  == 5 ) {					
            0:  sw_300_series_coachf;
            sw_300_series_pantof;				
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_forwards_4th_and_5_from_end, CarNumber() == 4 || CarNumberFromEnd()  == 5 ) {				
            0:  sw_300_series_coachf;
            sw_300_series_pantof;				
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_300_series_pantof;
            sw_300_series_coachf;
            				
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_forwards, num_vehs_in_consist ) {				
            0..35:  sw_300_series_forwards_panto_in_middle;
            36..47: sw_300_series_forwards_4th_and_5_from_end;
            sw_300_series_forwards_6th_and_5_from_end;
        }

// Backwards

    switch (FEAT_TRAINS, SELF, sw_300_series_backwards_6th_and_5_from_end, CarNumberFromEnd() == 6 || CarNumber()  == 5 ) {					
            0:  sw_300_series_coachb;
            sw_300_series_pantob;				
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_backwards_4th_and_5_from_end, CarNumberFromEnd() == 4 || CarNumber()  == 5 ) {				
            0:  sw_300_series_coachb;
            sw_300_series_pantob;				
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_300_series_pantob;
            sw_300_series_coachb;
            
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_backwards, num_vehs_in_consist ) {				
            0..35:  sw_300_series_backwards_panto_in_middle;
            36..47: sw_300_series_backwards_4th_and_5_from_end;
            sw_300_series_backwards_6th_and_5_from_end;
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_300_series_midcars, vehicle_is_reversed) {				
            0:  sw_300_series_forwards;
            sw_300_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_300_series_rear, vehicle_is_reversed) {				
            1: sw_300_series_cab01b;
            sw_300_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_300_series_lead, vehicle_is_reversed) {				
            1: sw_300_series_cab02b;
            sw_300_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_300_series_cabs, position_in_consist) {				
            0..2: sw_300_series_lead;
            sw_300_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_300_series_graphics, IsCab() ) {				
            1:  sw_300_series_cabs;
            sw_300_series_midcars;	
        }
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "src/trains/300_series/300_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_300_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_300;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_300) {
	property {
		/* Menu */
        name: 							string(STR_NAME_300_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1992,03,01);
		model_life:                     30;		                    // In service from 1992,03,01 to 2012,03,16
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          271 km/h;					// Agreed to Wikipedia					
		power:                          402*4*10 hp;            	// 300kw x 10 motorised cars x 4 per car				
		weight:                         44*16 tons;	                // 44t (per JPS) x 16 cars				
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_300_SERIES);
        cargo_subtype_text:             sw_300_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                44;
        purchase_power:                 402 * 4;
        /* Graphics */
        default:                        sw_300_series_graphics;
		purchase:                       sw_300_series_purchase;
		articulated_part:               sw_300_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        power:                          (( NumberCarsInConsist() / 2 ) + 2 ) * 402 * 4;	// 300 kW
        weight:                         NumberCarsInConsist() * 44;
		cargo_capacity:                 28 * CapacityFactor();															
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    130;
		running_cost_factor:            (305 + 124 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   305 + 124 * NumberCarsInConsist();		
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_300_series_graphics;
        cargo_capacity:                 28 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_300_series_running_costs;
      }
}
# 1 "src/trains/300_series/300_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/100_series/100_series.pnml" 1

# 1 "src/trains/100_series/100_series_menu.pnml" 1

/* Subtypes */

	// From 1985 to 1988
	switch(FEAT_TRAINS, SELF, sw_100_series_1985_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
		1: return string(LV_100_SERIES_X);          // X
		2: return string(LV_100_SERIES_X_2CC);      // X 2cc
		return CB_RESULT_NO_TEXT;
		}

	// From 1988 to 2000 - introduction of V set with more double decker cars
	switch(FEAT_TRAINS, SELF, sw_100_series_1988_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
		1: return string(LV_100_SERIES_X);          // X
		2: return string(LV_100_SERIES_X_2CC);      // X 2cc
		3: return string(LV_100_SERIES_V);          // V set with bilevel
		4: return string(LV_100_SERIES_V_2CC);      // V set with bilevel 2cc
		return CB_RESULT_NO_TEXT;
		}

	// From 2000 onwards - introduction of Kodama Livery
	switch(FEAT_TRAINS, SELF, sw_100_series_2000_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
		1: return string(LV_100_SERIES_X);          // X
		2: return string(LV_100_SERIES_X_2CC);      // X 2cc
		3: return string(LV_100_SERIES_V);          // V set with bilevel
		4: return string(LV_100_SERIES_V_2CC);      // V set with bilevel 2cc
		5: return string(LV_100_SERIES_KODAMA);     // 8-car ser with Kodama livery 
		return CB_RESULT_NO_TEXT;
		}

	// SUBTYPE MENU over time
	switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_subtype_text, current_year) {
		0..1987: sw_100_series_1985_subtype_text;
		1988..1999: sw_100_series_1988_subtype_text;
		sw_100_series_2000_subtype_text;
	}

/* Purchase Menu */

    spriteset (ss_100_series_irl_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {template_purchase(233, 1)}
    spriteset (ss_100_series_kodama_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {template_purchase(233, 1)}
    

    switch(FEAT_TRAINS, SELF, logo_100_series_year_dep, current_year) {
			0..1986:    logo_jnr;                           // JNR (Original Livery)
			1987..1988: logo_jrcentral;                     // JR Central (Original Livery)
			1989..1999: logo_jrwestcentral;                 // JR Central & West (Original Livery)
			2000..2001: logo_jrwestcentral;                 // JR Central & West (Kodama Livery)
			            logo_jrwest;                        // JR West (Kodama Livery)
		}

    switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_purchase, current_year) {
			2000..9999: ss_100_series_kodama_buy;           // Kodama Period
		}

    switch(FEAT_TRAINS, SELF, sw_100_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_100_series_year_dep; 
            1: ss_100_series_irl_buy;
            2: sw_100_series_year_dep_purchase;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_100_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_100_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_100_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_100_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_100_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_100_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_100_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_cab01f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_100_series_cab01b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_100_series_cab01f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_100_series_cab01b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_100_series_cab01f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_100_series_cab01b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_100_series_cab01f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_100_series_cab01b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_rev(1,51)}

    // Kodama

    // 10/8
	spriteset(ss_std_100_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_100_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_100_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_100_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_100_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_100_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_100_series_cab01f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_100_series_cab01b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_cab01f_ydp, current_year) {2000..9999: ss_frt_100_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_cab01f_2cc_mask, cargo_subtype) {0:sw_frt_100_series_cab01f_ydp; 2:ss_frt_100_series_cab01f_2cc; 4:ss_frt_100_series_cab01f_2cc; 5:ss_frt_100_series_cab01f_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_100_series_cab01f_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_100_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_cab01f_ydp, current_year) {2000..9999: ss_mid_100_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_cab01f_2cc_mask, cargo_subtype) {0:sw_mid_100_series_cab01f_ydp; 2:ss_mid_100_series_cab01f_2cc; 4:ss_mid_100_series_cab01f_2cc; 5:ss_mid_100_series_cab01f_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_100_series_cab01f_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_cab01f_ydp, current_year) {2000..9999: ss_std_100_series_cab01f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_cab01f_2cc_mask, cargo_subtype) {0:sw_std_100_series_cab01f_ydp; 2:ss_std_100_series_cab01f_2cc; 4:ss_std_100_series_cab01f_2cc; 5:ss_std_100_series_cab01f_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab01f_2cc, HideLongSprite() ) { 0: sw_std_100_series_cab01f_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_cab01f_irl;       	    // Base for Mid
				1: ss_mid_100_series_cab01f_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_cab01f_irl;	    // Base for LongSprite
                3: longsprite_100_series_cab01f_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_cab01f_ydp, current_year) {2000..9999: ss_bck_100_series_cab01f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_cab01f_2cc_mask, cargo_subtype) {0:sw_bck_100_series_cab01f_ydp; 2:ss_bck_100_series_cab01f_2cc; 4:ss_bck_100_series_cab01f_2cc; 5:ss_bck_100_series_cab01f_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_cab01f_irl;       	    // Base for Back
				1: ss_bck_100_series_cab01f_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_cab01f, position_in_consist % 3 ) {				
            0: sw_100_series_cab01f_frt_longsprite;
            1: sw_100_series_cab01f_mid_stack;
            2: sw_100_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_cab01b_ydp, current_year) {2000..9999: ss_frt_100_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_cab01b_2cc_mask, cargo_subtype) {0:sw_frt_100_series_cab01b_ydp; 2:ss_frt_100_series_cab01b_2cc; 4:ss_frt_100_series_cab01b_2cc; 5:ss_frt_100_series_cab01b_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_100_series_cab01b_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_cab01b_ydp, current_year) {2000..9999: ss_mid_100_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_cab01b_2cc_mask, cargo_subtype) {0:sw_mid_100_series_cab01b_ydp; 2:ss_mid_100_series_cab01b_2cc; 4:ss_mid_100_series_cab01b_2cc; 5:ss_mid_100_series_cab01b_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_100_series_cab01b_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_cab01b_ydp, current_year) {2000..9999: ss_std_100_series_cab01b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_cab01b_2cc_mask, cargo_subtype) {0:sw_std_100_series_cab01b_ydp; 2:ss_std_100_series_cab01b_2cc; 4:ss_std_100_series_cab01b_2cc; 5:ss_std_100_series_cab01b_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab01b_2cc, HideLongSprite() ) { 0: sw_std_100_series_cab01b_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_cab01b_irl;       	    // Base for Mid
				1: ss_mid_100_series_cab01b_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_cab01b_irl;	    // Base for LongSprite
                3: longsprite_100_series_cab01b_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_cab01b_ydp, current_year) {2000..9999: ss_bck_100_series_cab01b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_cab01b_2cc_mask, cargo_subtype) {0:sw_bck_100_series_cab01b_ydp; 2:ss_bck_100_series_cab01b_2cc; 4:ss_bck_100_series_cab01b_2cc; 5:ss_bck_100_series_cab01b_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_cab01b_irl;       	    // Base for Back
				1: ss_bck_100_series_cab01b_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_100_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_cab01b_frt_longsprite;
            1: sw_100_series_cab01b_mid_stack;
            2: sw_100_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_100_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_100_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_100_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_100_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_100_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_100_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_100_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_cab02f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_100_series_cab02b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_100_series_cab02f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_100_series_cab02b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_100_series_cab02f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_100_series_cab02b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_100_series_cab02f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_100_series_cab02b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Roundnose

    // 10/8
	spriteset(ss_std_100_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_100_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_100_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_100_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_100_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_100_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_100_series_cab02f_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_100_series_cab02b_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_cab02f_ydp, current_year) {2000..9999: ss_frt_100_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_cab02f_2cc_mask, cargo_subtype) {0:sw_frt_100_series_cab02f_ydp; 2:ss_frt_100_series_cab02f_2cc; 4:ss_frt_100_series_cab02f_2cc; 5:ss_frt_100_series_cab02f_kdm; }
		
            switch(FEAT_TRAINS, SELF, sw_100_series_cab02f_frt_stack, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_frt_100_series_cab02f_irl;       	    // Base for Front
                    1: ss_frt_100_series_cab02f_2cc_mask;		// Masks for Front
                }

		    switch(FEAT_TRAINS, SELF, sw_100_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_cab02f_ydp, current_year) {2000..9999: ss_mid_100_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_cab02f_2cc_mask, cargo_subtype) {0:sw_mid_100_series_cab02f_ydp; 2:ss_mid_100_series_cab02f_2cc; 4:ss_mid_100_series_cab02f_2cc; 5:ss_mid_100_series_cab02f_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_100_series_cab02f_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_cab02f_ydp, current_year) {2000..9999: ss_std_100_series_cab02f_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_cab02f_2cc_mask, cargo_subtype) {0:sw_std_100_series_cab02f_ydp; 2:ss_std_100_series_cab02f_2cc; 4:ss_std_100_series_cab02f_2cc; 5:ss_std_100_series_cab02f_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab02f_2cc, HideLongSprite() ) { 0: sw_std_100_series_cab02f_2cc_mask; }
            
        // Panto Decision
            switch(FEAT_TRAINS, SELF, panto_midsprite_100_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_f; }
            switch(FEAT_TRAINS, SELF, panto_longsprite_100_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_f; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_cab02f_irl;       	    // Base for Mid
				1: ss_mid_100_series_cab02f_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_cab02f_irl;	    // Base for LongSprite
                3: longsprite_100_series_cab02f_2cc;        // Mask for LongSprite
                // Pantos
                4: panto_midsprite_100_series_cab02f;       // Panto for Mid
                5: panto_longsprite_100_series_cab02f;      // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_cab02f_ydp, current_year) {2000..9999: ss_bck_100_series_cab02f_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_cab02f_2cc_mask, cargo_subtype) {0:sw_bck_100_series_cab02f_ydp; 2:ss_bck_100_series_cab02f_2cc; 4:ss_bck_100_series_cab02f_2cc; 5:ss_bck_100_series_cab02f_kdm; }
		
            switch(FEAT_TRAINS, SELF, sw_100_series_cab02f_bck_stack, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_bck_100_series_cab02f_irl;       	    // Base for Front
                    1: ss_bck_100_series_cab02f_2cc_mask;		// Masks for Front
                }


		switch(FEAT_TRAINS, SELF, sw_100_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_100_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_cab02f_frt_longsprite;
            1: sw_100_series_cab02f_mid_stack;
            2: sw_100_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_cab02b_ydp, current_year) {2000..9999: ss_frt_100_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_cab02b_2cc_mask, cargo_subtype) {0:sw_frt_100_series_cab02b_ydp; 2:ss_frt_100_series_cab02b_2cc; 4:ss_frt_100_series_cab02b_2cc; 5:ss_frt_100_series_cab02b_kdm; }
		
            switch(FEAT_TRAINS, SELF, sw_100_series_cab02b_frt_stack, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_frt_100_series_cab02b_irl;       	    // Base for Front
                    1: ss_frt_100_series_cab02b_2cc_mask;		// Masks for Front
                }

		    switch(FEAT_TRAINS, SELF, sw_100_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_100_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_cab02b_ydp, current_year) {2000..9999: ss_mid_100_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_cab02b_2cc_mask, cargo_subtype) {0:sw_mid_100_series_cab02b_ydp; 2:ss_mid_100_series_cab02b_2cc; 4:ss_mid_100_series_cab02b_2cc; 5:ss_mid_100_series_cab02b_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_100_series_cab02b_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_cab02b_ydp, current_year) {2000..9999: ss_std_100_series_cab02b_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_cab02b_2cc_mask, cargo_subtype) {0:sw_std_100_series_cab02b_ydp; 2:ss_std_100_series_cab02b_2cc; 4:ss_std_100_series_cab02b_2cc; 5:ss_std_100_series_cab02b_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_cab02b_2cc, HideLongSprite() ) { 0: sw_std_100_series_cab02b_2cc_mask; }
            
        // Panto Decision
            switch(FEAT_TRAINS, SELF, panto_midsprite_100_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_b; }
            switch(FEAT_TRAINS, SELF, panto_longsprite_100_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_b; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_cab02b_irl;       	    // Base for Mid
				1: ss_mid_100_series_cab02b_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_cab02b_irl;	    // Base for LongSprite
                3: longsprite_100_series_cab02b_2cc;        // Mask for LongSprite
                // Pantos
                4: panto_midsprite_100_series_cab02b;       // Panto for Mid
                5: panto_longsprite_100_series_cab02b;      // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_cab02b_ydp, current_year) {2000..9999: ss_bck_100_series_cab02b_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_cab02b_2cc_mask, cargo_subtype) {0:sw_bck_100_series_cab02b_ydp; 2:ss_bck_100_series_cab02b_2cc; 4:ss_bck_100_series_cab02b_2cc; 5:ss_bck_100_series_cab02b_kdm; }
		
            switch(FEAT_TRAINS, SELF, sw_100_series_cab02b_bck_stack, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_bck_100_series_cab02b_irl;       	    // Base for Front
                    1: ss_bck_100_series_cab02b_2cc_mask;		// Masks for Front
                }


		switch(FEAT_TRAINS, SELF, sw_100_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_cab02b, position_in_consist % 3 ) {				
            0: sw_100_series_cab02b_frt_longsprite;
            1: sw_100_series_cab02b_mid_stack;
            2: sw_100_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_coachf_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_coachb_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_coachf_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_coachb_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_coachf_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_coachb_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_coachf_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_coachb_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Kodama

    // 10/8
	spriteset(ss_std_100_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_coachf_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_coachb_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_coachf_ydp, current_year) {2000..9999: ss_frt_100_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_coachf_2cc_mask, cargo_subtype) {0:sw_frt_100_series_coachf_ydp; 2:ss_frt_100_series_coachf_2cc; 4:ss_frt_100_series_coachf_2cc; 5:ss_frt_100_series_coachf_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_coachf_irl;       	    // Base for Front
				1: ss_frt_100_series_coachf_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_100_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_coachf_ydp, current_year) {2000..9999: ss_mid_100_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_coachf_2cc_mask, cargo_subtype) {0:sw_mid_100_series_coachf_ydp; 2:ss_mid_100_series_coachf_2cc; 4:ss_mid_100_series_coachf_2cc; 5:ss_mid_100_series_coachf_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_coachf_irl, HideLongSprite() ) { 0: ss_std_100_series_coachf_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_coachf_ydp, current_year) {2000..9999: ss_std_100_series_coachf_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_coachf_2cc_mask, cargo_subtype) {0:sw_std_100_series_coachf_ydp; 2:ss_std_100_series_coachf_2cc; 4:ss_std_100_series_coachf_2cc; 5:ss_std_100_series_coachf_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_coachf_2cc, HideLongSprite() ) { 0: sw_std_100_series_coachf_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_coachf_irl;       	    // Base for Mid
				1: ss_mid_100_series_coachf_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_coachf_irl;	    // Base for LongSprite
                3: longsprite_100_series_coachf_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_coachf_ydp, current_year) {2000..9999: ss_bck_100_series_coachf_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_coachf_2cc_mask, cargo_subtype) {0:sw_bck_100_series_coachf_ydp; 2:ss_bck_100_series_coachf_2cc; 4:ss_bck_100_series_coachf_2cc; 5:ss_bck_100_series_coachf_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_coachf_irl;       	    // Base for Back
				1: ss_bck_100_series_coachf_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_coachf, position_in_consist % 3 ) {				
            0: sw_100_series_coachf_frt_longsprite;
            1: sw_100_series_coachf_mid_stack;
            2: sw_100_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_coachb_ydp, current_year) {2000..9999: ss_frt_100_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_coachb_2cc_mask, cargo_subtype) {0:sw_frt_100_series_coachb_ydp; 2:ss_frt_100_series_coachb_2cc; 4:ss_frt_100_series_coachb_2cc; 5:ss_frt_100_series_coachb_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_coachb_irl;       	    // Base for Front
				1: ss_frt_100_series_coachb_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_coachb_ydp, current_year) {2000..9999: ss_mid_100_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_coachb_2cc_mask, cargo_subtype) {0:sw_mid_100_series_coachb_ydp; 2:ss_mid_100_series_coachb_2cc; 4:ss_mid_100_series_coachb_2cc; 5:ss_mid_100_series_coachb_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_coachb_irl, HideLongSprite() ) { 0: ss_std_100_series_coachb_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_coachb_ydp, current_year) {2000..9999: ss_std_100_series_coachb_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_coachb_2cc_mask, cargo_subtype) {0:sw_std_100_series_coachb_ydp; 2:ss_std_100_series_coachb_2cc; 4:ss_std_100_series_coachb_2cc; 5:ss_std_100_series_coachb_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_coachb_2cc, HideLongSprite() ) { 0: sw_std_100_series_coachb_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_coachb_irl;       	    // Base for Mid
				1: ss_mid_100_series_coachb_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_coachb_irl;	    // Base for LongSprite
                3: longsprite_100_series_coachb_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_coachb_ydp, current_year) {2000..9999: ss_bck_100_series_coachb_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_coachb_2cc_mask, cargo_subtype) {0:sw_bck_100_series_coachb_ydp; 2:ss_bck_100_series_coachb_2cc; 4:ss_bck_100_series_coachb_2cc; 5:ss_bck_100_series_coachb_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_coachb_irl;       	    // Base for Back
				1: ss_bck_100_series_coachb_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_100_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_coachb_frt_longsprite;
            1: sw_100_series_coachb_mid_stack;
            2: sw_100_series_coachb_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_pantof_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_pantob_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_pantof_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_pantob_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_pantof_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_pantob_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_pantof_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_pantob_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Kodama

    // 10/8
	spriteset(ss_std_100_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_100_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_100_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_100_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_100_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_100_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_100_series_pantof_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_100_series_pantob_kdm, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_kodama.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_pantof_ydp, current_year) {2000..9999: ss_frt_100_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_pantof_2cc_mask, cargo_subtype) {0:sw_frt_100_series_pantof_ydp; 2:ss_frt_100_series_pantof_2cc; 4:ss_frt_100_series_pantof_2cc; 5:ss_frt_100_series_pantof_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_pantof_irl;       	    // Base for Front
				1: ss_frt_100_series_pantof_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_100_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_pantof_ydp, current_year) {2000..9999: ss_mid_100_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_pantof_2cc_mask, cargo_subtype) {0:sw_mid_100_series_pantof_ydp; 2:ss_mid_100_series_pantof_2cc; 4:ss_mid_100_series_pantof_2cc; 5:ss_mid_100_series_pantof_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_pantof_irl, HideLongSprite() ) { 0: ss_std_100_series_pantof_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_pantof_ydp, current_year) {2000..9999: ss_std_100_series_pantof_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_pantof_2cc_mask, cargo_subtype) {0:sw_std_100_series_pantof_ydp; 2:ss_std_100_series_pantof_2cc; 4:ss_std_100_series_pantof_2cc; 5:ss_std_100_series_pantof_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_pantof_2cc, HideLongSprite() ) { 0: sw_std_100_series_pantof_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_pantof_irl;       	    // Base for Mid
				1: ss_mid_100_series_pantof_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_pantof_irl;	    // Base for LongSprite
                3: longsprite_100_series_pantof_2cc;        // Mask for LongSprite
                // Pantos
                4: panto_midsprite_200_f;                  // Panto for Mid
                5: panto_longsprite_200_f;                 // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_pantof_ydp, current_year) {2000..9999: ss_bck_100_series_pantof_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_pantof_2cc_mask, cargo_subtype) {0:sw_bck_100_series_pantof_ydp; 2:ss_bck_100_series_pantof_2cc; 4:ss_bck_100_series_pantof_2cc; 5:ss_bck_100_series_pantof_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_pantof_irl;       	    // Base for Back
				1: ss_bck_100_series_pantof_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_pantof, position_in_consist % 3 ) {				
            0: sw_100_series_pantof_frt_longsprite;
            1: sw_100_series_pantof_mid_stack;
            2: sw_100_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
                switch(FEAT_TRAINS, SELF, sw_frt_100_series_pantob_ydp, current_year) {2000..9999: ss_frt_100_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_pantob_2cc_mask, cargo_subtype) {0:sw_frt_100_series_pantob_ydp; 2:ss_frt_100_series_pantob_2cc; 4:ss_frt_100_series_pantob_2cc; 5:ss_frt_100_series_pantob_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_pantob_irl;       	    // Base for Front
				1: ss_frt_100_series_pantob_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
                switch(FEAT_TRAINS, SELF, sw_mid_100_series_pantob_ydp, current_year) {2000..9999: ss_mid_100_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_pantob_2cc_mask, cargo_subtype) {0:sw_mid_100_series_pantob_ydp; 2:ss_mid_100_series_pantob_2cc; 4:ss_mid_100_series_pantob_2cc; 5:ss_mid_100_series_pantob_kdm; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_pantob_irl, HideLongSprite() ) { 0: ss_std_100_series_pantob_irl; }   
            // Masks
        		switch(FEAT_TRAINS, SELF, sw_std_100_series_pantob_ydp, current_year) {2000..9999: ss_std_100_series_pantob_kdm; }
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_pantob_2cc_mask, cargo_subtype) {0:sw_std_100_series_pantob_ydp; 2:ss_std_100_series_pantob_2cc; 4:ss_std_100_series_pantob_2cc; 5:ss_std_100_series_pantob_kdm; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_pantob_2cc, HideLongSprite() ) { 0: sw_std_100_series_pantob_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_pantob_irl;       	    // Base for Mid
				1: ss_mid_100_series_pantob_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_pantob_irl;	    // Base for LongSprite
                3: longsprite_100_series_pantob_2cc;        // Mask for LongSprite
                // Pantos
                4: panto_midsprite_200_b;                  // Panto for Mid
                5: panto_longsprite_200_b;                 // Panto for LongSprite
			}

		// Back
			// Masks
                switch(FEAT_TRAINS, SELF, sw_bck_100_series_pantob_ydp, current_year) {2000..9999: ss_bck_100_series_pantob_kdm; }
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_pantob_2cc_mask, cargo_subtype) {0:sw_bck_100_series_pantob_ydp; 2:ss_bck_100_series_pantob_2cc; 4:ss_bck_100_series_pantob_2cc; 5:ss_bck_100_series_pantob_kdm; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_pantob_irl;       	    // Base for Back
				1: ss_bck_100_series_pantob_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_100_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_pantob_frt_longsprite;
            1: sw_100_series_pantob_mid_stack;
            2: sw_100_series_pantob_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_2dec1.pnml" 1

/* 2dec1 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_2dec1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_100_series_2dec1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_100_series_2dec1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_100_series_2dec1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_100_series_2dec1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_100_series_2dec1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_100_series_2dec1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_100_series_2dec1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_rev(1,151)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_2dec1f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_100_series_2dec1b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_100_series_2dec1f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_100_series_2dec1b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_100_series_2dec1f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_100_series_2dec1b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_100_series_2dec1f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_100_series_2dec1b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_2dec1f_2cc_mask, cargo_subtype) {2:ss_frt_100_series_2dec1f_2cc; 4:ss_frt_100_series_2dec1f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_2dec1f_irl;       	    // Base for Front
				1: ss_frt_100_series_2dec1f_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1f_frt_longsprite, NextPartSame() ) { 1: sw_100_series_2dec1f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_2dec1f_2cc_mask, cargo_subtype) {2:ss_mid_100_series_2dec1f_2cc; 4:ss_mid_100_series_2dec1f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec1f_irl, HideLongSprite() ) { 0: ss_std_100_series_2dec1f_irl; }   
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_2dec1f_2cc_mask, cargo_subtype) {2:ss_std_100_series_2dec1f_2cc; 4:ss_std_100_series_2dec1f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec1f_2cc, HideLongSprite() ) { 0: sw_std_100_series_2dec1f_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_2dec1f_irl;       	    // Base for Mid
				1: ss_mid_100_series_2dec1f_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_2dec1f_irl;	    // Base for LongSprite
                3: longsprite_100_series_2dec1f_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_2dec1f_2cc_mask, cargo_subtype) {2:ss_bck_100_series_2dec1f_2cc; 4:ss_bck_100_series_2dec1f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_2dec1f_irl;       	    // Base for Back
				1: ss_bck_100_series_2dec1f_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1f_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_2dec1f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_2dec1f, position_in_consist % 3 ) {				
            0: sw_100_series_2dec1f_frt_longsprite;
            1: sw_100_series_2dec1f_mid_stack;
            2: sw_100_series_2dec1f_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_2dec1b_2cc_mask, cargo_subtype) {2:ss_frt_100_series_2dec1b_2cc; 4:ss_frt_100_series_2dec1b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_2dec1b_irl;       	    // Base for Front
				1: ss_frt_100_series_2dec1b_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1b_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_2dec1b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_2dec1b_2cc_mask, cargo_subtype) {2:ss_mid_100_series_2dec1b_2cc; 4:ss_mid_100_series_2dec1b_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec1b_irl, HideLongSprite() ) { 0: ss_std_100_series_2dec1b_irl; }   
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_2dec1b_2cc_mask, cargo_subtype) {2:ss_std_100_series_2dec1b_2cc; 4:ss_std_100_series_2dec1b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec1b_2cc, HideLongSprite() ) { 0: sw_std_100_series_2dec1b_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_2dec1b_irl;       	    // Base for Mid
				1: ss_mid_100_series_2dec1b_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_2dec1b_irl;	    // Base for LongSprite
                3: longsprite_100_series_2dec1b_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_2dec1b_2cc_mask, cargo_subtype) {2:ss_bck_100_series_2dec1b_2cc; 4:ss_bck_100_series_2dec1b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_2dec1b_irl;       	    // Base for Back
				1: ss_bck_100_series_2dec1b_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec1b_bck_longsprite, NextPartSame() ) { 1: sw_100_series_2dec1b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_2dec1b, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_2dec1b_frt_longsprite;
            1: sw_100_series_2dec1b_mid_stack;
            2: sw_100_series_2dec1b_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_2dec2.pnml" 1

/* 2dec2 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_100_series_2dec2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_std(1,201)}
	spriteset(ss_std_100_series_2dec2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_10_rev(1,201)}

	// Front
	spriteset(ss_frt_100_series_2dec2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_std(1,201)}
	spriteset(ss_frt_100_series_2dec2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_frt_rev(1,201)}
	// Mid
	spriteset(ss_mid_100_series_2dec2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_std(1,201)}
	spriteset(ss_mid_100_series_2dec2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_mid_rev(1,201)}
	// Back
	spriteset(ss_bck_100_series_2dec2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_std(1,201)}
	spriteset(ss_bck_100_series_2dec2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/100_series/gfx/100_series_irl.png") {tmpl_bck_rev(1,201)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_100_series_2dec2f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_std(1,201)}
	spriteset(ss_std_100_series_2dec2b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_10_rev(1,201)}

	// Front
	spriteset(ss_frt_100_series_2dec2f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_std(1,201)}
	spriteset(ss_frt_100_series_2dec2b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_frt_rev(1,201)}
	// Mid
	spriteset(ss_mid_100_series_2dec2f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_std(1,201)}
	spriteset(ss_mid_100_series_2dec2b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_mid_rev(1,201)}
	// Back
	spriteset(ss_bck_100_series_2dec2f_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_std(1,201)}
	spriteset(ss_bck_100_series_2dec2b_2cc, "src/trains/100_series/gfx/100_series_2cc.png") {tmpl_bck_rev(1,201)}

// Sprite Selection

	// Forwards

		// Front
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_2dec2f_2cc_mask, cargo_subtype) {2:ss_frt_100_series_2dec2f_2cc; 4:ss_frt_100_series_2dec2f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_2dec2f_irl;       	    // Base for Front
				1: ss_frt_100_series_2dec2f_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2f_frt_longsprite, NextPartSame() ) { 1: sw_100_series_2dec2f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_2dec2f_2cc_mask, cargo_subtype) {2:ss_mid_100_series_2dec2f_2cc; 4:ss_mid_100_series_2dec2f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec2f_irl, HideLongSprite() ) { 0: ss_std_100_series_2dec2f_irl; }   
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_2dec2f_2cc_mask, cargo_subtype) {2:ss_std_100_series_2dec2f_2cc; 4:ss_std_100_series_2dec2f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec2f_2cc, HideLongSprite() ) { 0: sw_std_100_series_2dec2f_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_2dec2f_irl;       	    // Base for Mid
				1: ss_mid_100_series_2dec2f_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_2dec2f_irl;	    // Base for LongSprite
                3: longsprite_100_series_2dec2f_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_2dec2f_2cc_mask, cargo_subtype) {2:ss_bck_100_series_2dec2f_2cc; 4:ss_bck_100_series_2dec2f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_2dec2f_irl;       	    // Base for Back
				1: ss_bck_100_series_2dec2f_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2f_bck_longsprite, PrevPartSame() ) { 1: sw_100_series_2dec2f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_2dec2f, position_in_consist % 3 ) {				
            0: sw_100_series_2dec2f_frt_longsprite;
            1: sw_100_series_2dec2f_mid_stack;
            2: sw_100_series_2dec2f_bck_longsprite;
        }

	// Backwards

		// Front
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_frt_100_series_2dec2b_2cc_mask, cargo_subtype) {2:ss_frt_100_series_2dec2b_2cc; 4:ss_frt_100_series_2dec2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_100_series_2dec2b_irl;       	    // Base for Front
				1: ss_frt_100_series_2dec2b_2cc_mask;		// Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2b_frt_longsprite, PrevPartSame() ) { 1: sw_100_series_2dec2b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Masks
        	    switch(FEAT_TRAINS, PARENT, ss_mid_100_series_2dec2b_2cc_mask, cargo_subtype) {2:ss_mid_100_series_2dec2b_2cc; 4:ss_mid_100_series_2dec2b_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec2b_irl, HideLongSprite() ) { 0: ss_std_100_series_2dec2b_irl; }   
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_100_series_2dec2b_2cc_mask, cargo_subtype) {2:ss_std_100_series_2dec2b_2cc; 4:ss_std_100_series_2dec2b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_100_series_2dec2b_2cc, HideLongSprite() ) { 0: sw_std_100_series_2dec2b_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_100_series_2dec2b_irl;       	    // Base for Mid
				1: ss_mid_100_series_2dec2b_2cc_mask;		// Mask for Mid
                // Long Sprite
				2: longsprite_100_series_2dec2b_irl;	    // Base for LongSprite
                3: longsprite_100_series_2dec2b_2cc;        // Mask for LongSprite
			}

		// Back
			// Masks
        	    switch(FEAT_TRAINS, PARENT, ss_bck_100_series_2dec2b_2cc_mask, cargo_subtype) {2:ss_bck_100_series_2dec2b_2cc; 4:ss_bck_100_series_2dec2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_100_series_2dec2b_irl;       	    // Base for Back
				1: ss_bck_100_series_2dec2b_2cc_mask;		// Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_100_series_2dec2b_bck_longsprite, NextPartSame() ) { 1: sw_100_series_2dec2b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_100_series_2dec2b, position_in_consist_from_end % 3 ) {				
            0: sw_100_series_2dec2b_frt_longsprite;
            1: sw_100_series_2dec2b_mid_stack;
            2: sw_100_series_2dec2b_bck_longsprite;
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_formations.pnml" 1


// Others
    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_others, EvenCarBackward() ) {				
            1:  sw_100_series_pantob;
            sw_100_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_others, EvenCarForward() ) {				
            1:  sw_100_series_pantof;
            sw_100_series_coachf;				
        }

// V
    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_9_and_10, CarNumberFromEnd() == 5 || CarNumberFromEnd() == 6 ) {				
            0:  sw_100_series_backwards_others;
            sw_100_series_2dec1b;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_11_to_14, CarNumberFromEnd() ) {				
            5: sw_100_series_2dec1b;
            6: sw_100_series_2dec1b;
            7: sw_100_series_2dec2b;
            8: sw_100_series_2dec1b;
            sw_100_series_backwards_others;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_v_15plus, CarNumberFromEnd() ) {				
            7: sw_100_series_2dec1b;
            8: sw_100_series_2dec1b;
            9: sw_100_series_2dec2b;
            10: sw_100_series_2dec1b;
            sw_100_series_backwards_others;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_v, num_vehs_in_consist ) {				
            0..24:  sw_100_series_backwards_others;
            25..30: sw_100_series_backwards_9_and_10;
            31..42: sw_100_series_backwards_11_to_14;
            sw_100_series_backwards_v_15plus;
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_9_and_10, CarNumber() == 5 || CarNumber() == 6 ) {				
            0:  sw_100_series_forwards_others;
            sw_100_series_2dec1f;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_11_to_14, CarNumber() ) {				
            5: sw_100_series_2dec1f;
            6: sw_100_series_2dec1f;
            7: sw_100_series_2dec2f;
            8: sw_100_series_2dec1f;
            sw_100_series_forwards_others;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_v_15plus, CarNumber() ) {				
            7: sw_100_series_2dec1f;
            8: sw_100_series_2dec1f;
            9: sw_100_series_2dec2f;
            10: sw_100_series_2dec1f;
            sw_100_series_forwards_others;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_v, num_vehs_in_consist ) {				
            0..24:  sw_100_series_forwards_others;
            25..30: sw_100_series_forwards_9_and_10;
            31..42: sw_100_series_forwards_11_to_14;
            sw_100_series_forwards_v_15plus;
        }

// Year Dep
    switch (FEAT_TRAINS, SELF, sw_100_series_backwards_year_dep, build_year) {				
            1988..1999:  sw_100_series_backwards_v;
            sw_100_series_backwards_others;				
        }

    switch (FEAT_TRAINS, PARENT, sw_100_series_backwards, cargo_subtype) {				
            0:  sw_100_series_backwards_year_dep;
            3:  sw_100_series_backwards_v;
            4:  sw_100_series_backwards_v;
            sw_100_series_backwards_others;				
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_forwards_year_dep, build_year) {				
            1988..1999:  sw_100_series_forwards_v;
            sw_100_series_forwards_others;				
        }

    switch (FEAT_TRAINS, PARENT, sw_100_series_forwards, cargo_subtype) {				
            0:  sw_100_series_forwards_year_dep;
            3:  sw_100_series_forwards_v;
            4:  sw_100_series_forwards_v;
            sw_100_series_forwards_others;				
        }

// Is vehicle reversed?
    switch (FEAT_TRAINS, PARENT, sw_100_series_midcars, vehicle_is_reversed) {				
            0:  sw_100_series_forwards;
            sw_100_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_100_series_rear, vehicle_is_reversed) {				
            1: sw_100_series_cab01b;
            sw_100_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_100_series_lead, vehicle_is_reversed) {				
            1: sw_100_series_cab02b;
            sw_100_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_100_series_cabs, position_in_consist) {				
            0..2: sw_100_series_lead;
            sw_100_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_100_series_graphics, IsCab() ) {				
            1:  sw_100_series_cabs;
            sw_100_series_midcars;	
        }
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "src/trains/100_series/100_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_100_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_100;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/* SPEED */
    switch(FEAT_TRAINS, SELF, sw_100_series_speed, cargo_subtype) {
        0..2: return 220;   // Original speed
        return 230;         // Kodama speed
    }

item(FEAT_TRAINS, series_100) {
	property {
		/* Menu */
        name: 							string(STR_NAME_100_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1985,10,01);           // Date of launch
		model_life:                     1993 - 1985;		        // Constructed until 1992
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train		
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_100_SERIES);
        cargo_subtype_text:             sw_100_series_year_dep_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                53;
        purchase_power:                 308 * 4;
        /* Graphics */
        default:                        sw_100_series_graphics;
		purchase:                       sw_100_series_purchase;
		articulated_part:               sw_100_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        weight:                         NumberCarsInConsist() * 53;
        power:                          max (NumberCarsInConsist() - 2 ,0) * 308 * 4;	// 230 kW
        speed:							sw_100_series_speed;
		cargo_capacity:                 27 * CapacityFactor();															
		loading_speed:					27 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    132;
		running_cost_factor:            (300 + 123 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 123 * NumberCarsInConsist();
		
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_100_series_graphics;
        cargo_capacity:                 27 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:					27 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_100_series_running_costs;
      }
}
# 1 "src/trains/100_series/100_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/800_series/800_series.pnml" 1

# 1 "src/trains/800_series/800_series_menu.pnml" 1
/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_800_series_subtype_text, cargo_subtype) {
		0: return string(LV_800_SERIES);                            
		1: return string(LV_800_SERIES_2CC); 
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_800_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_800_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrkyushu; 
            1: ss_800_series_buy;
        }
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_800_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_800_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_800_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_800_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_800_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_800_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_800_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_800_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_800_series_cab01f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_800_series_cab01b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_800_series_cab01f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_800_series_cab01b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_800_series_cab01f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_800_series_cab01b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_800_series_cab01f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_800_series_cab01b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_cab01f_mask, cargo_subtype) {1:ss_frt_800_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_cab01f_irl;       	// Base for Front
				1: ss_frt_800_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_frt_longsprite, NextPartSame()) { 1: sw_800_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_cab01f_mask, cargo_subtype) {1:ss_mid_800_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_cab01f_mask, cargo_subtype) {1:ss_std_800_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_mid_longsprite, HideLongSprite()) {
					0: ss_std_800_series_cab01f_irl;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_std_longsprite, HideLongSprite()) {
					0: ss_std_800_series_cab01f_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_800_series_cab01f_mask;		// Mask for Mid
				2: sw_800_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_cab01f_mask, cargo_subtype) {1:ss_bck_800_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_cab01f_irl;       	// Base for Front
				1: ss_bck_800_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_800_series_cab01f_bck_stack; dummy_sprites;	}

		switch (FEAT_TRAINS, SELF, sw_800_series_cab01f, position_in_consist % 3 ) {				
            0: sw_800_series_cab01f_frt_longsprite;
            1: sw_800_series_cab01f_mid_stack;
            2: sw_800_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_cab01b_mask, cargo_subtype) {1:ss_frt_800_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_cab01b_irl;       	// Base for Front
				1: ss_frt_800_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_800_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_cab01b_mask, cargo_subtype) {1:ss_mid_800_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_cab01b_mask, cargo_subtype) {1:ss_std_800_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab01b_irl; }
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_800_series_cab01b_mask;		// Mask for Mid
				2: sw_800_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_cab01b_mask, cargo_subtype) {1:ss_bck_800_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_cab01b_irl;       	// Base for Front
				1: ss_bck_800_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_800_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_800_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_800_series_cab01b_frt_longsprite;
            1: sw_800_series_cab01b_mid_stack;
            2: sw_800_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_800_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_800_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_800_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_800_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_800_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_800_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_800_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_800_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_800_series_cab02f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_800_series_cab02b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_800_series_cab02f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_800_series_cab02b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_800_series_cab02f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_800_series_cab02b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_800_series_cab02f_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_800_series_cab02b_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_cab02f_mask, cargo_subtype) {1:ss_frt_800_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_cab02f_irl;       	// Base for Front
				1: ss_frt_800_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_800_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_cab02f_mask, cargo_subtype) {1:ss_mid_800_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_cab02f_mask, cargo_subtype) {1:ss_std_800_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab02f_irl; }
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_800_series_cab02f_mask;		// Mask for Mid
				2: sw_800_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_cab02f_mask, cargo_subtype) {1:ss_bck_800_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_cab02f_irl;       	// Base for Front
				1: ss_bck_800_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_800_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_800_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_800_series_cab02f_frt_longsprite;
            1: sw_800_series_cab02f_mid_stack;
            2: sw_800_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_cab02b_mask, cargo_subtype) {1:ss_frt_800_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_cab02b_irl;       	// Base for Front
				1: ss_frt_800_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_800_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_cab02b_mask, cargo_subtype) {1:ss_mid_800_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_cab02b_mask, cargo_subtype) {1:ss_std_800_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_800_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_800_series_cab02b_mask;		// Mask for Mid
				2: sw_800_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_cab02b_mask, cargo_subtype) {1:ss_bck_800_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_cab02b_irl;       	// Base for Front
				1: ss_bck_800_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_800_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_800_series_cab02b, position_in_consist % 3 ) {				
            0: sw_800_series_cab02b_frt_longsprite;
            1: sw_800_series_cab02b_mid_stack;
            2: sw_800_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_800_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_800_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_800_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_800_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_800_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_800_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_800_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_800_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_rev(1,151)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_800_series_coachf_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_800_series_coachb_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_800_series_coachf_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_800_series_coachb_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_800_series_coachf_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_800_series_coachb_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_800_series_coachf_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_800_series_coachb_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_coachf_mask, cargo_subtype) {1:ss_frt_800_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_coachf_irl;       	// Base for Front
				1: ss_frt_800_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_frt_longsprite, NextPartSame()) { 1: sw_800_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_coachf_mask, cargo_subtype) {1:ss_mid_800_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_coachf_mask, cargo_subtype) {1:ss_std_800_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_mid_longsprite, HideLongSprite()) {
					0: ss_std_800_series_coachf_irl;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_std_longsprite, HideLongSprite()) {
					0: ss_std_800_series_coachf_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_coachf_irl;       	// Base for Mid
				1: ss_mid_800_series_coachf_mask;		// Mask for Mid
				2: sw_800_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_coachf_mask, cargo_subtype) {1:ss_bck_800_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_coachf_irl;       	// Base for Front
				1: ss_bck_800_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_800_series_coachf_bck_stack; dummy_sprites;	}

		switch (FEAT_TRAINS, SELF, sw_800_series_coachf, position_in_consist % 3 ) {				
            0: sw_800_series_coachf_frt_longsprite;
            1: sw_800_series_coachf_mid_stack;
            2: sw_800_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_coachb_mask, cargo_subtype) {1:ss_frt_800_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_coachb_irl;       	// Base for Front
				1: ss_frt_800_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_800_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_coachb_mask, cargo_subtype) {1:ss_mid_800_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_coachb_mask, cargo_subtype) {1:ss_std_800_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_800_series_coachb_irl; }
		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_800_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_coachb_irl;       	// Base for Mid
				1: ss_mid_800_series_coachb_mask;		// Mask for Mid
				2: sw_800_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_800_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_coachb_mask, cargo_subtype) {1:ss_bck_800_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_coachb_irl;       	// Base for Front
				1: ss_bck_800_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_800_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_800_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_800_series_coachb_frt_longsprite;
            1: sw_800_series_coachb_mid_stack;
            2: sw_800_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_panto.pnml" 1

/* panto */

// Sprites
	
	// Base

	// 10/8
	spriteset(ss_std_800_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_800_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_800_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_800_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_800_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_800_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_mid_rev(1,101)}

	// Back
	spriteset(ss_bck_800_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_800_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/800_series/gfx/800_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_800_series_pantof_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_800_series_pantob_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_800_series_pantof_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_800_series_pantob_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_800_series_pantof_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_800_series_pantob_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_mid_rev(1,101)}

	// Back
	spriteset(ss_bck_800_series_pantof_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_800_series_pantob_2cc, "src/trains/800_series/gfx/800_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_pantof_mask, cargo_subtype) {1:ss_frt_800_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_pantof_irl;       	// Base for Front
				1: ss_frt_800_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_800_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_pantof_mask, cargo_subtype) {1:ss_mid_800_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_pantof_mask, cargo_subtype) {1:ss_std_800_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_mid_longsprite, HideLongSprite() ) { 0: ss_std_800_series_pantof_irl; }
		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_std_longsprite, HideLongSprite() ) { 0: ss_std_800_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_pantof_irl;       	// Base for Mid
				1: ss_mid_800_series_pantof_mask;		// Mask for Mid
				2: panto_midsprite_800_f;				// Panto for Mid
				3: sw_800_series_pantof_mid_longsprite;	// Long Sprite
				4: sw_800_series_pantof_std_longsprite;	// Long Sprite Mask
				5: panto_longsprite_800_f;				// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_pantof_mask, cargo_subtype) {1:ss_bck_800_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_pantof_irl;       	// Base for Front
				1: ss_bck_800_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_800_series_pantof_bck_stack; dummy_sprites;	}

		switch (FEAT_TRAINS, SELF, sw_800_series_pantof, position_in_consist % 3 ) {				
            0: sw_800_series_pantof_frt_longsprite;
            1: sw_800_series_pantof_mid_stack;
            2: sw_800_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_800_series_pantob_mask, cargo_subtype) {1:ss_frt_800_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_800_series_pantob_irl;       	// Base for Front
				1: ss_frt_800_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_800_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_800_series_pantob_mask, cargo_subtype) {1:ss_mid_800_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_800_series_pantob_mask, cargo_subtype) {1:ss_std_800_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_mid_longsprite, HideLongSprite() ) {
					0: ss_std_800_series_pantob_irl;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_std_longsprite, HideLongSprite() ) {
					0: ss_std_800_series_pantob_mask;		   	
				}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_800_series_pantob_irl;       	// Base for Mid
				1: ss_mid_800_series_pantob_mask;		// Mask for Mid
				2: panto_midsprite_800_b;				// Panto for Mid
				3: sw_800_series_pantob_mid_longsprite;	// Long Sprite
				4: sw_800_series_pantob_std_longsprite;	// Long Sprite Mask
				5: panto_longsprite_800_b;				// Panto for Long Sprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_800_series_pantob_mask, cargo_subtype) {1:ss_bck_800_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_800_series_pantob_irl;       	// Base for Front
				1: ss_bck_800_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_800_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_800_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_800_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_800_series_pantob_frt_longsprite;
            1: sw_800_series_pantob_mid_stack;
            2: sw_800_series_pantob_bck_longsprite;
        }
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_formations.pnml" 1
// Forwards

    switch (FEAT_TRAINS, SELF, sw_800_series_forwards_pick_panto, CarNumber() == 2 ) {				
            1:  sw_800_series_pantof;	
            sw_800_series_pantob;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_800_series_forwards_penultimates, CarNumber() == 2 || CarNumberFromEnd()  == 2 ) {				
            1:  sw_800_series_forwards_pick_panto;	
            sw_800_series_coachf;		
        }

    switch (FEAT_TRAINS, SELF, sw_800_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_800_series_pantof;
            sw_800_series_coachf;				
        }

    switch (FEAT_TRAINS, SELF, sw_800_series_forwards, num_vehs_in_consist ) {				
            0..17:  sw_800_series_forwards_panto_in_middle;
            sw_800_series_forwards_penultimates;
        }

// Backwards

    switch (FEAT_TRAINS, SELF, sw_800_series_backwards_pick_panto, CarNumberFromEnd() == 2 ) {				
            1:  sw_800_series_pantob;	
            sw_800_series_pantof;		
        }
    
    switch (FEAT_TRAINS, SELF, sw_800_series_backwards_penultimates, CarNumberFromEnd() == 2 || CarNumber()  == 2 ) {				
            1:  sw_800_series_backwards_pick_panto;
            sw_800_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_800_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_800_series_pantob;
            sw_800_series_coachb;
        }

    switch (FEAT_TRAINS, SELF, sw_800_series_backwards, num_vehs_in_consist ) {				
            0..17:  sw_800_series_backwards_panto_in_middle;
            sw_800_series_backwards_penultimates;
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_800_series_midcars, vehicle_is_reversed) {				
            0:  sw_800_series_forwards;
            sw_800_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_800_series_rear, vehicle_is_reversed) {				
            1: sw_800_series_cab01b;
            sw_800_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_800_series_lead, vehicle_is_reversed) {				
            1: sw_800_series_cab02b;
            sw_800_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_800_series_cabs, position_in_consist) {				
            0..2: sw_800_series_lead;
            sw_800_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_800_series_graphics, IsCab() ) {				
            1:  sw_800_series_cabs;
            sw_800_series_midcars;	
        }
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "src/trains/800_series/800_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_800_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_800;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_800_series_attach_vehid, [vehicle_type_id == mu_car_full]) {
 0: return string(ONLY_ADD_MUCAR);
}

/*---Length Check---*/
switch (FEAT_TRAINS, SELF, sw_800_series_stop_start, num_vehs_in_consist < 12) {				
		1:  return string(STR_LENGTH_ERROR); 				
		return CB_RESULT_NO_TEXT; 
	}

item(FEAT_TRAINS, series_800) {
	property {
		/* Menu */
		name: 							string(STR_NAME_800_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2004,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          261 km/h;				
		power:                          9300 hp;					// 1550 hp (per JPS) x 6 cars					
		weight:                         44 * 6 tons;				// 44t (per JPS) x 6 cars					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_800_SERIES);
		cargo_subtype_text:             sw_800_series_subtype_text;
		can_attach_wagon:				sw_800_series_attach_vehid;
		start_stop:						sw_800_series_stop_start;
		purchase_weight:                44;
        purchase_power:                 375 * 4;
		/* Graphics */
		default:                        sw_800_series_graphics;
		purchase:                       sw_800_series_purchase;
		articulated_part:               sw_800_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
        power:                          NumberCarsInConsist() * 375 * 4;	// (285 kW)
        weight:                         NumberCarsInConsist() * 44 ;
		cargo_capacity:                 22 * CapacityFactor();															
		loading_speed:					22 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    121;
		running_cost_factor:            (290 + 120 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   290 + 120 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_800_series_graphics;
        cargo_capacity:                 22 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  22 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_800_series_running_costs;
      }
}
# 1 "src/trains/800_series/800_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/l0_series/l0_series.pnml" 1

# 1 "src/trains/l0_series/l0_series_menu.pnml" 1

/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_l0_series_subtype_text, cargo_subtype) {
		0: return string(LV_L0_SERIES);                            // Sharknose
		1: return string(LV_L0_SERIES_2CC);                        // Sharknose 2cc
		return CB_RESULT_NO_TEXT;
		}


/* Purchase Menu */
    spriteset (ss_l0_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_l0_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jrcentral; 
            1: ss_l0_series_buy;
        }
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "src/trains/l0_series/l0_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_l0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_l0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_l0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_l0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_l0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_l0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_l0_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_l0_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_l0_series_cab01f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_l0_series_cab01b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_l0_series_cab01f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_l0_series_cab01b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_l0_series_cab01f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_l0_series_cab01b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_l0_series_cab01f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_l0_series_cab01b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_cab01f_mask, cargo_subtype) {1:ss_frt_l0_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_cab01f_irl;       	// Base for Front
				1: ss_frt_l0_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_l0_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_cab01f_mask, cargo_subtype) {1:ss_mid_l0_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_cab01f_mask, cargo_subtype) {1:ss_std_l0_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab01f_irl; }
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_l0_series_cab01f_mask;		// Mask for Mid
				2: sw_l0_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_cab01f_mask, cargo_subtype) {1:ss_bck_l0_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_cab01f_irl;       	// Base for Front
				1: ss_bck_l0_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_l0_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_cab01f, position_in_consist % 3 ) {				
            0: sw_l0_series_cab01f_frt_longsprite;
            1: sw_l0_series_cab01f_mid_stack;
            2: sw_l0_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_cab01b_mask, cargo_subtype) {1:ss_frt_l0_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_cab01b_irl;       	// Base for Front
				1: ss_frt_l0_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_l0_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_cab01b_mask, cargo_subtype) {1:ss_mid_l0_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_cab01b_mask, cargo_subtype) {1:ss_std_l0_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab01b_irl; }
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_l0_series_cab01b_mask;		// Mask for Mid
				2: sw_l0_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_cab01b_mask, cargo_subtype) {1:ss_bck_l0_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_cab01b_irl;       	// Base for Front
				1: ss_bck_l0_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_l0_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_l0_series_cab01b_frt_longsprite;
            1: sw_l0_series_cab01b_mid_stack;
            2: sw_l0_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "src/trains/l0_series/l0_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_l0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_l0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_l0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_l0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_l0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_l0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_l0_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_l0_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_l0_series_cab02f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_l0_series_cab02b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_l0_series_cab02f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_l0_series_cab02b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_l0_series_cab02f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_l0_series_cab02b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_l0_series_cab02f_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_l0_series_cab02b_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_cab02f_mask, cargo_subtype) {1:ss_frt_l0_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_cab02f_irl;       	// Base for Front
				1: ss_frt_l0_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_l0_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_cab02f_mask, cargo_subtype) {1:ss_mid_l0_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_cab02f_mask, cargo_subtype) {1:ss_std_l0_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab02f_irl; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_l0_series_cab02f_mask;		// Mask for Mid
				2: sw_l0_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_cab02f_mask, cargo_subtype) {1:ss_bck_l0_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_cab02f_irl;       	// Base for Front
				1: ss_bck_l0_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_l0_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_l0_series_cab02f_frt_longsprite;
            1: sw_l0_series_cab02f_mid_stack;
            2: sw_l0_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_cab02b_mask, cargo_subtype) {1:ss_frt_l0_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_cab02b_irl;       	// Base for Front
				1: ss_frt_l0_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_l0_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_cab02b_mask, cargo_subtype) {1:ss_mid_l0_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_cab02b_mask, cargo_subtype) {1:ss_std_l0_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_l0_series_cab02b_mask;		// Mask for Mid
				2: sw_l0_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_cab02b_mask, cargo_subtype) {1:ss_bck_l0_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_cab02b_irl;       	// Base for Front
				1: ss_bck_l0_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_l0_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_cab02b, position_in_consist % 3 ) {				
            0: sw_l0_series_cab02b_frt_longsprite;
            1: sw_l0_series_cab02b_mid_stack;
            2: sw_l0_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "src/trains/l0_series/l0_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_l0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_l0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_l0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_l0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_l0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_l0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_l0_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_l0_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/l0_series/gfx/l0_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_l0_series_coachf_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_l0_series_coachb_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_l0_series_coachf_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_l0_series_coachb_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_l0_series_coachf_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_l0_series_coachb_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_l0_series_coachf_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_l0_series_coachb_2cc, "src/trains/l0_series/gfx/l0_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_coachf_mask, cargo_subtype) {1:ss_frt_l0_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_coachf_irl;       	// Base for Front
				1: ss_frt_l0_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_l0_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_coachf_mask, cargo_subtype) {1:ss_mid_l0_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_coachf_mask, cargo_subtype) {1:ss_std_l0_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_coachf_irl; }
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_coachf_irl;       	// Base for Mid
				1: ss_mid_l0_series_coachf_mask;		// Mask for Mid
				2: sw_l0_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_coachf_mask, cargo_subtype) {1:ss_bck_l0_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_coachf_irl;       	// Base for Front
				1: ss_bck_l0_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_l0_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_coachf, position_in_consist % 3 ) {				
            0: sw_l0_series_coachf_frt_longsprite;
            1: sw_l0_series_coachf_mid_stack;
            2: sw_l0_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_l0_series_coachb_mask, cargo_subtype) {1:ss_frt_l0_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_l0_series_coachb_irl;       	// Base for Front
				1: ss_frt_l0_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_l0_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_l0_series_coachb_mask, cargo_subtype) {1:ss_mid_l0_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_l0_series_coachb_mask, cargo_subtype) {1:ss_std_l0_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_coachb_irl; }
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_l0_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_l0_series_coachb_irl;       	// Base for Mid
				1: ss_mid_l0_series_coachb_mask;		// Mask for Mid
				2: sw_l0_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_l0_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_l0_series_coachb_mask, cargo_subtype) {1:ss_bck_l0_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_l0_series_coachb_irl;       	// Base for Front
				1: ss_bck_l0_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_l0_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_l0_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_l0_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_l0_series_coachb_frt_longsprite;
            1: sw_l0_series_coachb_mid_stack;
            2: sw_l0_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "src/trains/l0_series/l0_series_formations.pnml" 1
/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_l0_series_midcars, vehicle_is_reversed) {				
            0:  sw_l0_series_coachf;
            sw_l0_series_coachb;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_l0_series_rear, vehicle_is_reversed) {				
            1: sw_l0_series_cab01b;
            sw_l0_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_l0_series_lead, vehicle_is_reversed) {				
            1: sw_l0_series_cab02b;
            sw_l0_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_l0_series_cabs, position_in_consist) {				
            0..2: sw_l0_series_lead;
            sw_l0_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_l0_series_graphics, IsCab() ) {				
            1:  sw_l0_series_cabs;
            sw_l0_series_midcars;	
        }
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "src/trains/l0_series/l0_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_l0_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_l0;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Cargo Capacity---*/
switch (FEAT_TRAINS, SELF, sw_l0_series_cargo_capacity_levels, position_in_consist == 1 || position_in_consist_from_end == 1 ) {				
		1:  return 24 * CapacityFactor();		
		return 60 * CapacityFactor();
	}

switch (FEAT_TRAINS, SELF, sw_l0_series_cargo_capacity, position_in_consist % 3) {				
		1:  sw_l0_series_cargo_capacity_levels; 				
		return 0;
	}


item(FEAT_TRAINS, series_l0) {
	property {
		/* Menu */
        name: 							string(STR_NAME_L0_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2027,01,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;
		vehicle_life:                   30;							// 
		track_type:                     SC_MAGLEV;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          505 km/h;									
		power:                          800*4*10 hp;            			
		weight:                         25 tons;	                			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_L0_SERIES);
        cargo_subtype_text:             sw_l0_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_maglev;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                25;
        purchase_power:                 800 * 4;
        /* Graphics */
        default:                        sw_l0_series_graphics;
		purchase:                       sw_l0_series_purchase;
		articulated_part:               sw_l0_series_articulated_part;
		visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_DISABLE,0,ENABLE_WAGON_POWER);
        /* Stats */
        length:                         sw_length_1_8_1;
        power:                          (( NumberCarsInConsist() / 2 ) + 2 ) * 400 * 4;	
        weight:                         NumberCarsInConsist() * 25;									// https://linear-chuo-shinkansen.jr-central.co.jp/about/design/
		cargo_capacity:                 sw_l0_series_cargo_capacity();
		purchase_cargo_capacity:		60 / 3 * CapacityFactor() ;													
		loading_speed:					28 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    260;
		running_cost_factor:            (600 + 250 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   600 + 250 * NumberCarsInConsist();	
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_maglev){
        default:                        sw_l0_series_graphics;
        cargo_capacity:                 sw_l0_series_cargo_capacity;
        cargo_age_period:				param_decay_express;
        loading_speed:					28 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_maglev_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_l0_series_running_costs;
      }
}
# 1 "src/trains/l0_series/l0_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

/*---JR EAST TRAINS---*/
# 1 "src/trains/200_series/200_series.pnml" 1

# 1 "src/trains/200_series/200_series_menu.pnml" 1

/* SUBTYPES */

    // Roundnose
    switch(FEAT_TRAINS, SELF, sw_200_series_roundnose_subtype_text, cargo_subtype) {
	    0: return string(LV_200_SERIES_ORIGINAL);       // Roundnose
        1: return string(LV_200_SERIES_ORIGINAL_2CC);   // Roundnose 2cc
        2: return string(LV_200_SERIES_REFURB);         // Refurb
        return CB_RESULT_NO_TEXT;
        }

    // Sharknose
    switch(FEAT_TRAINS, SELF, sw_200_series_sharknose_subtype_text, cargo_subtype) {
        0: return string(LV_200_SERIES_ORIGINAL);       // Sharknose
        1: return string(LV_200_SERIES_ORIGINAL_2CC);   // Sharknose 2cc
        return CB_RESULT_NO_TEXT;
        }

    // 275
    switch(FEAT_TRAINS, SELF, sw_200_series_275_subtype_text, cargo_subtype) {
        0: return string(LV_200_SERIES_ORIGINAL);       // 275
        1: return string(LV_200_SERIES_ORIGINAL_2CC);   // 275 2cc
        return CB_RESULT_NO_TEXT;
        }


/* PURCHASE */

    // Sharknose
        spriteset (ss_200_series_sharknose_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {template_purchase(233, 1)}

        switch(FEAT_TRAINS, SELF, sw_200_series_sharknose_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jreast; 
                1: ss_200_series_sharknose_buy;
            }
    
    // Roundnose
        spriteset (ss_200_series_roundnose_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {template_purchase(233, 1)}

        switch(FEAT_TRAINS, SELF, sw_200_series_roundnose_purchase, [ 
            STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                0: logo_jreast; 
                1: ss_200_series_sharknose_buy;
                2: ss_200_series_roundnose_buy;
            }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_200_series_cab01f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_200_series_cab01b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_200_series_cab01f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_200_series_cab01b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_200_series_cab01f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_200_series_cab01b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_200_series_cab01f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_200_series_cab01b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_rev(1,51)}

	// Sharknose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_cab01f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_200_series_cab01b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_200_series_cab01f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_200_series_cab01b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_200_series_cab01f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_200_series_cab01b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_200_series_cab01f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_200_series_cab01b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_rev(1,51)}

    // Roundnose

    // 10/8
	spriteset(ss_std_200_series_cab01f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_200_series_cab01b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_200_series_cab01f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_200_series_cab01b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_200_series_cab01f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_200_series_cab01b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_200_series_cab01f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_200_series_cab01b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_bck_rev(1,51)}

    // Roundnose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_cab01f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_200_series_cab01b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_200_series_cab01f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_200_series_cab01b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_200_series_cab01f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_200_series_cab01b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_200_series_cab01f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_200_series_cab01b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_bck_rev(1,51)}

    // Refurb

    // 10/8
	spriteset(ss_std_200_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_200_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_200_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_200_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_200_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_200_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_200_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_200_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_rev(1,51)}


// Sprite Selection

	// Forwards

		// Front
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01f_shp_mask, vehicle_type_id) {200:ss_frt_200_series_cab01f_rnd; 202:ss_frt_200_series_cab01f_rnd; 204:ss_frt_200_series_cab01f_rnd;}
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01f_2cc_id, vehicle_type_id) {200:ss_frt_200_series_cab01f_rn2; 201:ss_frt_200_series_cab01f_sh2; 202:ss_frt_200_series_cab01f_rn2; 204:ss_frt_200_series_cab01f_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01f_2cc_mask, cargo_subtype) {1:ss_frt_200_series_cab01f_2cc_id;  2:ss_frt_200_series_cab01f_rfb; 4:ss_frt_200_series_cab01f_rn2; 5:ss_frt_200_series_cab01f_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_cab01f_sha;       	    // Base for Front
				1: ss_frt_200_series_cab01f_shp_mask;		// Shape mask for Front
				2: ss_frt_200_series_cab01f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_200_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01f_shp_mask, vehicle_type_id) {200:ss_mid_200_series_cab01f_rnd; 202:ss_mid_200_series_cab01f_rnd; 204:ss_mid_200_series_cab01f_rnd;}
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01f_2cc_id, vehicle_type_id) {200:ss_mid_200_series_cab01f_rn2; 201:ss_mid_200_series_cab01f_sh2; 202:ss_mid_200_series_cab01f_rn2; 204:ss_mid_200_series_cab01f_rn2; }
        		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01f_2cc_mask, cargo_subtype) {1:ss_mid_200_series_cab01f_2cc_id;  2:ss_mid_200_series_cab01f_rfb; 4:ss_mid_200_series_cab01f_rn2; 5:ss_mid_200_series_cab01f_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01f_sha, HideLongSprite() ) { 0: ss_std_200_series_cab01f_sha; }
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab01f_shp_mask, vehicle_type_id) {200:ss_std_200_series_cab01f_rnd; 202:ss_std_200_series_cab01f_rnd; 204:ss_std_200_series_cab01f_rnd; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01f_shp, HideLongSprite() ) { 0: sw_std_200_series_cab01f_shp_mask; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_std_200_series_cab01f_2cc_id, vehicle_type_id) {200:ss_std_200_series_cab01f_rn2; 201:ss_std_200_series_cab01f_sh2; 202:ss_std_200_series_cab01f_rn2; 204:ss_std_200_series_cab01f_rn2;}
        		switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab01f_2cc_mask, cargo_subtype) {1:ss_std_200_series_cab01f_2cc_id;  2:ss_std_200_series_cab01f_rfb; 4:ss_std_200_series_cab01f_rn2; 5:ss_std_200_series_cab01f_rfb;}
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01f_2cc, HideLongSprite() ) { 0: sw_std_200_series_cab01f_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_cab01f_sha;       	    // Base for Mid
                1: ss_mid_200_series_cab01f_shp_mask;		// Shape mask for Mid
				2: ss_mid_200_series_cab01f_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_200_series_cab01f_sha;	    // Base for LongSprite
				4: longsprite_200_series_cab01f_shp;        // Shape mask for LongSprite
                5: longsprite_200_series_cab01f_2cc;        // 2cc mask for LongSprite
			}

		// Front
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01f_shp_mask, vehicle_type_id) {200:ss_bck_200_series_cab01f_rnd; 202:ss_bck_200_series_cab01f_rnd; 204:ss_bck_200_series_cab01f_rnd;}
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01f_2cc_id, vehicle_type_id) {200:ss_bck_200_series_cab01f_rn2; 201:ss_bck_200_series_cab01f_sh2; 202:ss_bck_200_series_cab01f_rn2; 204:ss_bck_200_series_cab01f_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01f_2cc_mask, cargo_subtype) {1:ss_bck_200_series_cab01f_2cc_id;  2:ss_bck_200_series_cab01f_rfb; 4:ss_bck_200_series_cab01f_rn2; 5:ss_bck_200_series_cab01f_rfb; }

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_cab01f_sha;       	    // Base for Front
				1: ss_bck_200_series_cab01f_shp_mask;		// Shape mask for Front
				2: ss_bck_200_series_cab01f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_200_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_cab01f, position_in_consist % 3 ) {				
            0: sw_200_series_cab01f_frt_longsprite;
            1: sw_200_series_cab01f_mid_stack;
            2: sw_200_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01b_shp_mask, vehicle_type_id) {200:ss_frt_200_series_cab01b_rnd; 202:ss_frt_200_series_cab01b_rnd; }
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01b_2cc_id, vehicle_type_id) {200:ss_frt_200_series_cab01b_rn2; 201:ss_frt_200_series_cab01b_sh2; 202:ss_frt_200_series_cab01b_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab01b_2cc_mask, cargo_subtype) {1:ss_frt_200_series_cab01b_2cc_id;  2:ss_frt_200_series_cab01b_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_cab01b_sha;       	    // Base for Front
				1: ss_frt_200_series_cab01b_shp_mask;		// Shape mask for Front
				2: ss_frt_200_series_cab01b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_200_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01b_shp_mask, vehicle_type_id) {200:ss_mid_200_series_cab01b_rnd; 202:ss_mid_200_series_cab01b_rnd; }
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01b_2cc_id, vehicle_type_id) {200:ss_mid_200_series_cab01b_rn2; 201:ss_mid_200_series_cab01b_sh2; 202:ss_mid_200_series_cab01b_rn2; }
        		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab01b_2cc_mask, cargo_subtype) {1:ss_mid_200_series_cab01b_2cc_id;  2:ss_mid_200_series_cab01b_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01b_sha, HideLongSprite() ) { 0: ss_std_200_series_cab01b_sha; }
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab01b_shp_mask, vehicle_type_id) {200:ss_std_200_series_cab01b_rnd; 202:ss_std_200_series_cab01b_rnd; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01b_shp, HideLongSprite() ) { 0: sw_std_200_series_cab01b_shp_mask; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_std_200_series_cab01b_2cc_id, vehicle_type_id) {200:ss_std_200_series_cab01b_rn2; 201:ss_std_200_series_cab01b_sh2; 202:ss_std_200_series_cab01b_rn2; }
        		switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab01b_2cc_mask, cargo_subtype) {1:ss_std_200_series_cab01b_2cc_id;  2:ss_std_200_series_cab01b_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab01b_2cc, HideLongSprite() ) { 0: sw_std_200_series_cab01b_2cc_mask; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_cab01b_sha;       	    // Base for Mid
                1: ss_mid_200_series_cab01b_shp_mask;		// Shape mask for Mid
				2: ss_mid_200_series_cab01b_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_200_series_cab01b_sha;	    // Base for LongSprite
				4: longsprite_200_series_cab01b_shp;        // Shape mask for LongSprite
                5: longsprite_200_series_cab01b_2cc;        // 2cc mask for LongSprite
			}

		// Back
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01b_shp_mask, vehicle_type_id) {200:ss_bck_200_series_cab01b_rnd; 202:ss_bck_200_series_cab01b_rnd; }
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01b_2cc_id, vehicle_type_id) {200:ss_bck_200_series_cab01b_rn2; 201:ss_bck_200_series_cab01b_sh2; 202:ss_bck_200_series_cab01b_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab01b_2cc_mask, cargo_subtype) {1:ss_bck_200_series_cab01b_2cc_id;  2:ss_bck_200_series_cab01b_rfb; }

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_cab01b_sha;       	    // Base for Front
				1: ss_bck_200_series_cab01b_shp_mask;		// Shape mask for Front
				2: ss_bck_200_series_cab01b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_200_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_200_series_cab01b_frt_longsprite;
            1: sw_200_series_cab01b_mid_stack;
            2: sw_200_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_200_series_cab02f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_200_series_cab02b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_200_series_cab02f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_200_series_cab02b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_200_series_cab02f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_200_series_cab02b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_200_series_cab02f_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_200_series_cab02b_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_cab_bck_rev(1,1)}

	// Sharknose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_cab02f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_200_series_cab02b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_200_series_cab02f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_200_series_cab02b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_200_series_cab02f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_200_series_cab02b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_200_series_cab02f_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_200_series_cab02b_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Roundnose

    // 10/8
	spriteset(ss_std_200_series_cab02f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_200_series_cab02b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_200_series_cab02f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_200_series_cab02b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_200_series_cab02f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_200_series_cab02b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_200_series_cab02f_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_200_series_cab02b_rnd, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_roundnose.png") {tmpl_cab_bck_rev(1,1)}

    // Roundnose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_cab02f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_200_series_cab02b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_200_series_cab02f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_200_series_cab02b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_200_series_cab02f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_200_series_cab02b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_200_series_cab02f_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_200_series_cab02b_rn2, "src/trains/200_series/gfx/200_series_roundnose_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Refurb

    // 10/8
	spriteset(ss_std_200_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_200_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_200_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_200_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_200_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_200_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_200_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_200_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_cab_bck_rev(1,1)}


// Sprite Selection

	// Forwards

		// Front
		// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02f_shp_mask, vehicle_type_id) {200:ss_frt_200_series_cab02f_rnd; 202:ss_frt_200_series_cab02f_rnd; 204:ss_frt_200_series_cab02f_rnd;}
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02f_2cc_id, vehicle_type_id) {200:ss_frt_200_series_cab02f_rn2; 201:ss_frt_200_series_cab02f_sh2; 202:ss_frt_200_series_cab02f_rn2; 204:ss_frt_200_series_cab02f_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02f_2cc_mask, cargo_subtype) {1:ss_frt_200_series_cab02f_2cc_id;  2:ss_frt_200_series_cab02f_rfb; 4:ss_frt_200_series_cab02f_rn2; 5:ss_frt_200_series_cab02f_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_cab02f_sha;       	    // Base for Front
				1: ss_frt_200_series_cab02f_shp_mask;		// Shape mask for Front
				2: ss_frt_200_series_cab02f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_200_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

       // Mid Parts
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02f_shp_mask, vehicle_type_id) {200:ss_mid_200_series_cab02f_rnd; 202:ss_mid_200_series_cab02f_rnd; 204:ss_mid_200_series_cab02f_rnd;}
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02f_2cc_id, vehicle_type_id) {200:ss_mid_200_series_cab02f_rn2; 201:ss_mid_200_series_cab02f_sh2; 202:ss_mid_200_series_cab02f_rn2; 204:ss_mid_200_series_cab02f_rn2; }
        		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02f_2cc_mask, cargo_subtype) {1:ss_mid_200_series_cab02f_2cc_id;  2:ss_mid_200_series_cab02f_rfb; 4:ss_mid_200_series_cab02f_rn2; 5:ss_mid_200_series_cab02f_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02f_sha, HideLongSprite() ) { 0: ss_std_200_series_cab02f_sha; }
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab02f_shp_mask, vehicle_type_id) {200:ss_std_200_series_cab02f_rnd; 202:ss_std_200_series_cab02f_rnd; 204:ss_std_200_series_cab02f_rnd; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02f_shp, HideLongSprite() ) { 0: sw_std_200_series_cab02f_shp_mask; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_std_200_series_cab02f_2cc_id, vehicle_type_id) {200:ss_std_200_series_cab02f_rn2; 201:ss_std_200_series_cab02f_sh2; 202:ss_std_200_series_cab02f_rn2; 204:ss_std_200_series_cab02f_rn2;}
        		switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab02f_2cc_mask, cargo_subtype) {1:ss_std_200_series_cab02f_2cc_id;  2:ss_std_200_series_cab02f_rfb; 4:ss_std_200_series_cab02f_rn2; 5:ss_std_200_series_cab02f_rfb;}
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02f_2cc, HideLongSprite() ) { 0: sw_std_200_series_cab02f_2cc_mask; }
                        
        // Panto Decision
            switch(FEAT_TRAINS, SELF, panto_midsprite_200_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_f; }
            switch(FEAT_TRAINS, SELF, panto_longsprite_200_series_cab02f, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_f; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_cab02f_sha;       	    // Base for Mid
                1: ss_mid_200_series_cab02f_shp_mask;		// Hikari mask for Mid
				2: ss_mid_200_series_cab02f_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_200_series_cab02f_sha;	    // Base for LongSprite
				4: longsprite_200_series_cab02f_shp;        // IRL 2cc mask for LongSprite
                5: longsprite_200_series_cab02f_2cc;        // Hikari mask for LongSprite
                // Pantos
                6: panto_midsprite_200_series_cab02f;       // Panto for Mid
                7: panto_longsprite_200_series_cab02f;      // Panto for LongSprite
			}

		// Back
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02f_shp_mask, vehicle_type_id) {200:ss_bck_200_series_cab02f_rnd; 202:ss_bck_200_series_cab02f_rnd; 204:ss_bck_200_series_cab02f_rnd;}
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02f_2cc_id, vehicle_type_id) {200:ss_bck_200_series_cab02f_rn2; 201:ss_bck_200_series_cab02f_sh2; 202:ss_bck_200_series_cab02f_rn2; 204:ss_bck_200_series_cab02f_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02f_2cc_mask, cargo_subtype) {1:ss_bck_200_series_cab02f_2cc_id;  2:ss_bck_200_series_cab02f_rfb; 4:ss_bck_200_series_cab02f_rn2; 5:ss_bck_200_series_cab02f_rfb; }

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_cab02f_sha;       	    // Base for Front
				1: ss_bck_200_series_cab02f_shp_mask;		// Shape mask for Front
				2: ss_bck_200_series_cab02f_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_200_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_200_series_cab02f_frt_longsprite;
            1: sw_200_series_cab02f_mid_stack;
            2: sw_200_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02b_shp_mask, vehicle_type_id) {200:ss_frt_200_series_cab02b_rnd; 202:ss_frt_200_series_cab02b_rnd; }
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02b_2cc_id, vehicle_type_id) {200:ss_frt_200_series_cab02b_rn2; 201:ss_frt_200_series_cab02b_sh2; 202:ss_frt_200_series_cab02b_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_frt_200_series_cab02b_2cc_mask, cargo_subtype) {1:ss_frt_200_series_cab02b_2cc_id;  2:ss_frt_200_series_cab02b_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_cab02b_sha;       	    // Base for Front
				1: ss_frt_200_series_cab02b_shp_mask;		// Shape mask for Front
				2: ss_frt_200_series_cab02b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_200_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02b_shp_mask, vehicle_type_id) {200:ss_mid_200_series_cab02b_rnd; 202:ss_mid_200_series_cab02b_rnd; }
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02b_2cc_id, vehicle_type_id) {200:ss_mid_200_series_cab02b_rn2; 201:ss_mid_200_series_cab02b_sh2; 202:ss_mid_200_series_cab02b_rn2; }
        		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_cab02b_2cc_mask, cargo_subtype) {1:ss_mid_200_series_cab02b_2cc_id;  2:ss_mid_200_series_cab02b_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02b_sha, HideLongSprite() ) { 0: ss_std_200_series_cab02b_sha; }
            // Shape Mask
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab02b_shp_mask, vehicle_type_id) {200:ss_std_200_series_cab02b_rnd; 202:ss_std_200_series_cab02b_rnd; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02b_shp, HideLongSprite() ) { 0: sw_std_200_series_cab02b_shp_mask; }     
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, ss_std_200_series_cab02b_2cc_id, vehicle_type_id) {200:ss_std_200_series_cab02b_rn2; 201:ss_std_200_series_cab02b_sh2; 202:ss_std_200_series_cab02b_rn2; }
        		switch(FEAT_TRAINS, PARENT, sw_std_200_series_cab02b_2cc_mask, cargo_subtype) {1:ss_std_200_series_cab02b_2cc_id;  2:ss_std_200_series_cab02b_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_cab02b_2cc, HideLongSprite() ) { 0: sw_std_200_series_cab02b_2cc_mask; }
            
        // Panto Decision
            switch(FEAT_TRAINS, SELF, panto_midsprite_200_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_midsprite_200_b; }
            switch(FEAT_TRAINS, SELF, panto_longsprite_200_series_cab02b, PantoOnCabEvenConsist() ) { 1: panto_longsprite_200_b; }

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_cab02b_sha;       	    // Base for Mid
                1: ss_mid_200_series_cab02b_shp_mask;		// Hikari mask for Mid
				2: ss_mid_200_series_cab02b_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				3: longsprite_200_series_cab02b_sha;	    // Base for LongSprite
				4: longsprite_200_series_cab02b_shp;        // IRL 2cc mask for LongSprite
                5: longsprite_200_series_cab02b_2cc;        // Hikari mask for LongSprite
                // Pantos
                6: panto_midsprite_200_series_cab02b;       // Panto for Mid
                7: panto_longsprite_200_series_cab02b;      // Panto for LongSprite
			}

		// Back
			// Shape Mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02b_shp_mask, vehicle_type_id) {200:ss_bck_200_series_cab02b_rnd; 202:ss_bck_200_series_cab02b_rnd; }
			// 2cc mask
			switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02b_2cc_id, vehicle_type_id) {200:ss_bck_200_series_cab02b_rn2; 201:ss_bck_200_series_cab02b_sh2; 202:ss_bck_200_series_cab02b_rn2; }
        	switch(FEAT_TRAINS, PARENT, ss_bck_200_series_cab02b_2cc_mask, cargo_subtype) {1:ss_bck_200_series_cab02b_2cc_id;  2:ss_bck_200_series_cab02b_rfb; }

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_cab02b_sha;       	    // Base for Front
				1: ss_bck_200_series_cab02b_shp_mask;		// Shape mask for Front
				2: ss_bck_200_series_cab02b_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_200_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_cab02b, position_in_consist % 3 ) {				
            0: sw_200_series_cab02b_frt_longsprite;
            1: sw_200_series_cab02b_mid_stack;
            2: sw_200_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_200_series_coachf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_coachb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_coachf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_coachb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_coachf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_coachb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_coachf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_coachb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_rev(1,101)}

	// Sharknose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_coachf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_coachb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_coachf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_coachb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_coachf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_coachb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_coachf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_coachb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_rev(1,101)}

    // Refurb

    // 10/8
	spriteset(ss_std_200_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_200_series_coachf_2cc_mask, cargo_subtype) {1:ss_frt_200_series_coachf_sh2;  2:ss_frt_200_series_coachf_rfb; 4:ss_frt_200_series_coachf_sh2; 5:ss_frt_200_series_coachf_rfb;}
		
		switch(FEAT_TRAINS, SELF, sw_200_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_coachf_sha;       	    // Base for Front
				1: ss_frt_200_series_coachf_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_200_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // 2cc Mask
				switch(FEAT_TRAINS, PARENT, ss_mid_200_series_coachf_2cc_mask, cargo_subtype) {1:ss_mid_200_series_coachf_sh2; 2:ss_mid_200_series_coachf_rfb; 4:ss_mid_200_series_coachf_sh2; 5:ss_mid_200_series_coachf_rfb;  }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_coachf_sha, HideLongSprite() ) { 0: ss_std_200_series_coachf_sha; }

            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_coachf_2cc, cargo_subtype) {1:ss_std_200_series_coachf_sh2; 2:ss_std_200_series_coachf_rfb; 4:ss_std_200_series_coachf_sh2; 5:ss_std_200_series_coachf_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_coachf_2cc, HideLongSprite() ) { 0: sw_std_200_series_coachf_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_coachf_sha;       	    // Base for Mid
				1: ss_mid_200_series_coachf_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				2: longsprite_200_series_coachf_sha;	    // Base for LongSprite
                3: longsprite_200_series_coachf_2cc;        // Hikari mask for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_200_series_coachf_2cc_mask, cargo_subtype) {1:ss_frt_200_series_coachf_sh2;  2:ss_frt_200_series_coachf_rfb; 4:ss_frt_200_series_coachf_sh2;  5:ss_frt_200_series_coachf_rfb;}

		switch(FEAT_TRAINS, SELF, sw_200_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_coachf_sha;       	    // Base for Front
				1: ss_bck_200_series_coachf_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_200_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_coachf, position_in_consist % 3 ) {				
            0: sw_200_series_coachf_frt_longsprite;
            1: sw_200_series_coachf_mid_stack;
            2: sw_200_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_200_series_coachb_2cc_mask, cargo_subtype) {1:ss_frt_200_series_coachb_sh2;  2:ss_frt_200_series_coachb_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_coachb_sha;       	    // Base for Front
				1: ss_frt_200_series_coachb_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_200_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_coachb_2cc_mask, cargo_subtype) {1:ss_mid_200_series_coachb_sh2; 2:ss_mid_200_series_coachb_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_coachb_sha, HideLongSprite() ) { 0: ss_std_200_series_coachb_sha; }  
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_coachb_2cc, cargo_subtype) {1:ss_std_200_series_coachb_sh2;  2:ss_std_200_series_coachb_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_coachb_2cc, HideLongSprite() ) { 0: sw_std_200_series_coachb_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_coachb_sha;       	    // Base for Mid
				1: ss_mid_200_series_coachb_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				2: longsprite_200_series_coachb_sha;	    // Base for LongSprite
                3: longsprite_200_series_coachb_2cc;        // Hikari mask for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_200_series_coachb_2cc_mask, cargo_subtype) {1:ss_bck_200_series_coachb_sh2;  2:ss_bck_200_series_coachb_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_coachb_sha;       	    // Base for Front
				1: ss_bck_200_series_coachb_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_200_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_200_series_coachb_frt_longsprite;
            1: sw_200_series_coachb_mid_stack;
            2: sw_200_series_coachb_bck_longsprite;
        }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_200_series_pantof_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_pantob_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_pantof_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_pantob_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_pantof_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_pantob_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_pantof_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_pantob_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_rev(1,101)}

	// Sharknose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_pantof_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_pantob_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_pantof_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_pantob_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_pantof_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_pantob_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_pantof_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_pantob_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_rev(1,101)}

    // Refurb

    // 10/8
	spriteset(ss_std_200_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_200_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_200_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_200_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_200_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_200_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_200_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_200_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_refurb.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_200_series_pantof_2cc_mask, cargo_subtype) {1:ss_frt_200_series_pantof_sh2;  2:ss_frt_200_series_pantof_rfb; 4:ss_frt_200_series_pantof_sh2;  5:ss_frt_200_series_pantof_rfb;}
		
		switch(FEAT_TRAINS, SELF, sw_200_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_pantof_sha;       	    // Base for Front
				1: ss_frt_200_series_pantof_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_200_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // 2cc Mask
				switch(FEAT_TRAINS, PARENT, ss_mid_200_series_pantof_2cc_mask, cargo_subtype) {1:ss_mid_200_series_pantof_sh2; 2:ss_mid_200_series_pantof_rfb; 4:ss_mid_200_series_pantof_sh2; 5:ss_mid_200_series_pantof_rfb;}

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_pantof_sha, HideLongSprite() ) { 0: ss_std_200_series_pantof_sha; }

            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_pantof_2cc, cargo_subtype) {1:ss_std_200_series_pantof_sh2; 2:ss_std_200_series_pantof_rfb; 4:ss_std_200_series_pantof_sh2; 5:ss_std_200_series_pantof_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_pantof_2cc, HideLongSprite() ) { 0: sw_std_200_series_pantof_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_pantof_sha;       	    // Base for Mid
				1: ss_mid_200_series_pantof_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				2: longsprite_200_series_pantof_sha;	    // Base for LongSprite
                3: longsprite_200_series_pantof_2cc;        // Hikari mask for LongSprite
				// Pantos
                4: panto_midsprite_200_f;                  // Panto for Mid
                5: panto_longsprite_200_f;                 // Panto for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_200_series_pantof_2cc_mask, cargo_subtype) {1:ss_frt_200_series_pantof_sh2;  2:ss_frt_200_series_pantof_rfb; 4:ss_frt_200_series_pantof_sh2;  5:ss_frt_200_series_pantof_rfb;}

		switch(FEAT_TRAINS, SELF, sw_200_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_pantof_sha;       	    // Base for Front
				1: ss_bck_200_series_pantof_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_200_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_pantof, position_in_consist % 3 ) {				
            0: sw_200_series_pantof_frt_longsprite;
            1: sw_200_series_pantof_mid_stack;
            2: sw_200_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
        switch(FEAT_TRAINS, PARENT, ss_frt_200_series_pantob_2cc_mask, cargo_subtype) {1:ss_frt_200_series_pantob_sh2;  2:ss_frt_200_series_pantob_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_pantob_sha;       	    // Base for Front
				1: ss_frt_200_series_pantob_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_200_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            // 2cc Mask
                switch(FEAT_TRAINS, PARENT, ss_mid_200_series_pantob_2cc_mask, cargo_subtype) {1:ss_mid_200_series_pantob_sh2; 2:ss_mid_200_series_pantob_rfb; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_200_series_pantob_sha, HideLongSprite() ) { 0: ss_std_200_series_pantob_sha; }  
            // Mask when 2cc
                switch(FEAT_TRAINS, PARENT, sw_std_200_series_pantob_2cc, cargo_subtype) {1:ss_std_200_series_pantob_sh2;  2:ss_std_200_series_pantob_rfb; }
                switch(FEAT_TRAINS, SELF, longsprite_200_series_pantob_2cc, HideLongSprite() ) { 0: sw_std_200_series_pantob_2cc; }
            

		switch(FEAT_TRAINS, SELF, sw_200_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_200_series_pantob_sha;       	    // Base for Mid
				1: ss_mid_200_series_pantob_2cc_mask;		// 2cc masks for Mid
                // Long Sprite
				2: longsprite_200_series_pantob_sha;	    // Base for LongSprite
                3: longsprite_200_series_pantob_2cc;        // Hikari mask for LongSprite
				// Pantos
                4: panto_midsprite_200_b;                  // Panto for Mid
                5: panto_longsprite_200_b;                 // Panto for LongSprite
			}

		// Back
        switch(FEAT_TRAINS, PARENT, ss_bck_200_series_pantob_2cc_mask, cargo_subtype) {1:ss_bck_200_series_pantob_sh2;  2:ss_bck_200_series_pantob_rfb; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_pantob_sha;       	    // Base for Front
				1: ss_bck_200_series_pantob_2cc_mask;		// IRL 2cc mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_200_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_200_series_pantob_frt_longsprite;
            1: sw_200_series_pantob_mid_stack;
            2: sw_200_series_pantob_bck_longsprite;
        }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_2deck.pnml" 1
/* 2deck */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_200_series_2deckf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_200_series_2deckb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_200_series_2deckf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_200_series_2deckb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_200_series_2deckf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_200_series_2deckb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_200_series_2deckf_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_200_series_2deckb_sha, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200_series/gfx/200_series_sharknose.png") {tmpl_bck_rev(1,151)}

	// Sharknose 2cc Mask

	// 10/8
	spriteset(ss_std_200_series_2deckf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_200_series_2deckb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_200_series_2deckf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_200_series_2deckb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_200_series_2deckf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_200_series_2deckb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_200_series_2deckf_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_200_series_2deckb_sh2, "src/trains/200_series/gfx/200_series_sharknose_2cc.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_200_series_2deckf_mask, cargo_subtype) {1:ss_frt_200_series_2deckf_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_2deckf_sha;       	// Base for Front
				1: ss_frt_200_series_2deckf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_frt_longsprite, NextPartSame() ) { 1: sw_200_series_2deckf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_2deckf_mask, cargo_subtype) {1:ss_mid_200_series_2deckf_sh2; }
		switch(FEAT_TRAINS, PARENT, ss_std_200_series_2deckf_mask, cargo_subtype) {1:ss_std_200_series_2deckf_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_mid_longsprite, HideLongSprite() ) { 0: ss_std_200_series_2deckf_sha; }
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_std_longsprite, HideLongSprite() ) { 0: ss_std_200_series_2deckf_mask; }

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_200_series_2deckf_sha;       	// Base for Mid
				1: ss_mid_200_series_2deckf_mask;		// Mask for Mid
				2: sw_200_series_2deckf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_200_series_2deckf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_200_series_2deckf_mask, cargo_subtype) {1:ss_bck_200_series_2deckf_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_2deckf_sha;       	// Base for Front
				1: ss_bck_200_series_2deckf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckf_bck_longsprite, PrevPartSame() ) { 1: sw_200_series_2deckf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_2deckf, position_in_consist % 3 ) {				
            0: sw_200_series_2deckf_frt_longsprite;
            1: sw_200_series_2deckf_mid_stack;
            2: sw_200_series_2deckf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_200_series_2deckb_mask, cargo_subtype) {1:ss_frt_200_series_2deckb_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_200_series_2deckb_sha;       	// Base for Front
				1: ss_frt_200_series_2deckb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_frt_longsprite, PrevPartSame() ) { 1: sw_200_series_2deckb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_200_series_2deckb_mask, cargo_subtype) {1:ss_mid_200_series_2deckb_sh2; }
		switch(FEAT_TRAINS, PARENT, ss_std_200_series_2deckb_mask, cargo_subtype) {1:ss_std_200_series_2deckb_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_mid_longsprite, HideLongSprite() ) { 0: ss_std_200_series_2deckb_sha; }
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_std_longsprite, HideLongSprite() ) { 0: ss_std_200_series_2deckb_mask; }

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_200_series_2deckb_sha;       	// Base for Mid
				1: ss_mid_200_series_2deckb_mask;		// Mask for Mid
				2: sw_200_series_2deckb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_200_series_2deckb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_200_series_2deckb_mask, cargo_subtype) {1:ss_bck_200_series_2deckb_sh2; }
		
		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_200_series_2deckb_sha;       	// Base for Front
				1: ss_bck_200_series_2deckb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_200_series_2deckb_bck_longsprite, NextPartSame() ) { 1: sw_200_series_2deckb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_200_series_2deckb, position_in_consist_from_end % 3 ) {				
            0: sw_200_series_2deckb_frt_longsprite;
            1: sw_200_series_2deckb_mid_stack;
            2: sw_200_series_2deckb_bck_longsprite;
        }
		
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_formations.pnml" 1

// Sharknose

    // Midcars going backwards
    switch (FEAT_TRAINS, SELF, sw_200_series_sharknose_backwards, CarNumberFromEnd() % 16) {				
            2:  sw_200_series_pantob;
            4:  sw_200_series_pantob;
            6:  sw_200_series_pantob;
            8:  sw_200_series_pantob;
            9:  sw_200_series_2deckb;
            10: sw_200_series_2deckb;
            12: sw_200_series_pantob;
            14: sw_200_series_pantob;
            sw_200_series_coachb;				
        }

    // Midcars going forwards
    switch (FEAT_TRAINS, SELF, sw_200_series_sharknose_forwards, CarNumber() % 16) {				
            2:  sw_200_series_pantof;
            4:  sw_200_series_pantof;
            6:  sw_200_series_pantof;
            8:  sw_200_series_pantof;
            9:  sw_200_series_2deckf;
            10: sw_200_series_2deckf;
            12: sw_200_series_pantof;
            14: sw_200_series_pantof;
            sw_200_series_coachf;				
        }

// Roundnose

    switch (FEAT_TRAINS, SELF, sw_200_series_roundnose_backwards, EvenCarBackward() ) {				
            1:  sw_200_series_pantob;
            sw_200_series_coachb;				
        }

    switch (FEAT_TRAINS, SELF, sw_200_series_roundnose_forwards, EvenCarForward() ) {				
            1:  sw_200_series_pantof;
            sw_200_series_coachf;				
        }

/* Forwards or Backwards */

    switch (FEAT_TRAINS, PARENT, sw_200_series_forwards, vehicle_type_id) {				
            201:  sw_200_series_sharknose_forwards;
            sw_200_series_roundnose_forwards;				
        }
    
    switch (FEAT_TRAINS, PARENT, sw_200_series_backwards, vehicle_type_id) {				
            201:  sw_200_series_sharknose_backwards;
            sw_200_series_roundnose_backwards;				
        }
    
    switch (FEAT_TRAINS, PARENT, sw_200_series_midcars, vehicle_is_reversed) {				
            0:  sw_200_series_forwards;
            sw_200_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_200_series_rear, vehicle_is_reversed) {				
            1: sw_200_series_cab01b;
            sw_200_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_200_series_lead, vehicle_is_reversed) {				
            1: sw_200_series_cab02b;
            sw_200_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_200_series_cabs, position_in_consist) {				
            0..2: sw_200_series_lead;
            sw_200_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_200_series_graphics, IsCab() ) {				
            1:  sw_200_series_cabs;
            sw_200_series_midcars;	
        }
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "src/trains/200_series/200_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_200_series_original_articulated_part, extra_callback_info1) {
		1 .. 2: return series_200;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_200) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1982,06,23);           // Date of launch
		model_life:                     34;		                    // Until 2008
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          210 km/h;                   // Changed by callback
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_200_SERIES);
		cargo_subtype_text:             sw_200_series_roundnose_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                58;
        purchase_power:                 308 * 4;
		/* Graphics */
		default:                        sw_200_series_graphics;
		purchase:                      	sw_200_series_roundnose_purchase;
		articulated_part:               sw_200_series_original_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
        power:							NumberCarsInConsist() * 308 * 4 ;		// 230 kW
		weight:							NumberCarsInConsist() * 58;
        //speed:							sw_200_series_speed;
		cargo_capacity:                 26 * CapacityFactor();										// 1230 capacity / (16 cars * 3 parts) is approx 26						
		loading_speed:					26 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    130;
		running_cost_factor:            (295 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   295 + 125 * NumberCarsInConsist();
		
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_200_series_graphics;
        cargo_capacity:                 26 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  26 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_200_series_running_costs;
      }
}


switch (FEAT_TRAINS, SELF, sw_200_series_sharknose_articulated_part, extra_callback_info1) {
		1 .. 2: return series_200_sharknose;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_200_sharknose) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_SERIES_SHARK);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					series_200;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1990,03,01);           // Date of launch
		model_life:                     34;		                    // Until 2008
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		extra_flags:					bitmask(VEHICLE_FLAG_DISABLE_EXCLUSIVE_PREVIEW);
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          240 km/h;                   
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_200_SERIES_SHARK);
		cargo_subtype_text:				sw_200_series_sharknose_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                58;
        purchase_power:                 308 * 4;
		/* Graphics */
		default:                        sw_200_series_graphics;
		purchase:                       sw_200_series_sharknose_purchase;
		articulated_part:               sw_200_series_sharknose_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
        power:							NumberCarsInConsist() * 308 * 4 ;		// 230 kW
		weight:							NumberCarsInConsist() * 58;
        //speed:						240 km/h;
		cargo_capacity:                 26 * CapacityFactor();										// 1230 capacity / (16 cars * 3 parts) is approx 26						
		loading_speed:					26 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    130;
		running_cost_factor:            (295 + 125 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   295 + 125 * NumberCarsInConsist();
		
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_200_series_graphics;
        cargo_capacity:                 26 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  26 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_200_series_sharknose_running_costs;
      }
}

switch (FEAT_TRAINS, SELF, sw_200_series_original_275_articulated_part, extra_callback_info1) {
		1 .. 2: return series_200_275;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_200_275) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_SERIES_275);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					200;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1990,03,01);           // Date of launch
		model_life:                     27;		                    // Until 2007
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          275 km/h;                   // Changed by callback
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_200_SERIES_275);
		cargo_subtype_text:             sw_200_series_275_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                58;
        purchase_power:                 308 * 4;
		/* Graphics */
		default:                        sw_200_series_graphics;
		purchase:                       sw_200_series_roundnose_purchase;
		articulated_part:               sw_200_series_original_275_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
        power:							NumberCarsInConsist() * 308 * 4 ;		// 230 kW
		weight:							NumberCarsInConsist() * 58;
        //speed:							sw_200_series_speed;
		cargo_capacity:                 26 * CapacityFactor();										// 1230 capacity / (16 cars * 3 parts) is approx 26						
		loading_speed:					26 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    145;
		running_cost_factor:            (300 + 130 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   300 + 130 * NumberCarsInConsist();
		
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_200_series_graphics;
        cargo_capacity:                 26 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  26 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_200_series_running_costs;
      }
}
# 1 "src/trains/200_series/200_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/400_series/400_series.pnml" 1

# 1 "src/trains/400_series/400_series_menu.pnml" 1

/* SUBTYPES */
  switch(FEAT_TRAINS, SELF, sw_400_series_subtypetext, cargo_subtype) {
    0 : string(LV_400_SERIES_ORIGINAL);
    1 : string(LV_400_SERIES_ORIGINAL_2CC);
    2 : string(LV_400_SERIES_REFURB);
    3 : string(LV_400_SERIES_REFURB_2CC);
  }

/* Purchase Menu */
    spriteset (ss_400_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_400_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_400_series_buy;
        }
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_cab01.pnml" 1
/* cab01 */

spriteset(ss_mid_400_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_400_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_400_series_cab01f_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_400_series_cab01b_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_400_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_400_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_400_series_cab01f_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_400_series_cab01b_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_rev(1,51)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_color_2044, cargo_subtype) {3:ss_mid_400_series_cab01f_2cc; }
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_shape_2044, cargo_subtype) {4..5:ss_mid_400_series_cab01f_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_color_204, cargo_subtype) {1:ss_mid_400_series_cab01f_2cc; 4:ss_mid_400_series_cab01f_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_shape_204, cargo_subtype) {3..5:ss_mid_400_series_cab01f_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_color_400, cargo_subtype) {1:ss_mid_400_series_cab01f_2cc; 3:ss_mid_400_series_cab01f_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_shape_400, cargo_subtype) {2..3:ss_mid_400_series_cab01f_rfb;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_color, vehicle_type_id) {400:ss_mid_400_series_cab01f_color_400; 204:ss_mid_400_series_cab01f_color_204; 2044:ss_mid_400_series_cab01f_color_2044;}
	switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01f_shape, vehicle_type_id) {400:ss_mid_400_series_cab01f_shape_400; 204:ss_mid_400_series_cab01f_shape_204; 2044:ss_mid_400_series_cab01f_shape_2044;}

    switch(FEAT_TRAINS, SELF, sw_400_series_cab01f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_400_series_cab01f_shape;		// Mask for Mid
                2: ss_mid_400_series_cab01f_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01b_color, cargo_subtype) {1:ss_mid_400_series_cab01b_2cc; 3:ss_mid_400_series_cab01b_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab01b_shape, cargo_subtype) {2..3:ss_mid_400_series_cab01b_rfb;}

    switch(FEAT_TRAINS, SELF, sw_400_series_cab01b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_400_series_cab01b_shape;		// Mask for Mid
                2: ss_mid_400_series_cab01b_color;		// Mask for Mid
			}
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_cab02.pnml" 1
/* cab02 */

spriteset(ss_mid_400_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_400_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_cab_mid_rev(1,1)}

spriteset(ss_mid_400_series_cab02f_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_400_series_cab02b_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_cab_mid_rev(1,1)}

spriteset(ss_mid_400_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_400_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_cab_mid_rev(1,1)}

spriteset(ss_mid_400_series_cab02f_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_400_series_cab02b_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_cab_mid_rev(1,1)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_color_2044, cargo_subtype) {3:ss_mid_400_series_cab02f_2cc; }
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_shape_2044, cargo_subtype) {4..5:ss_mid_400_series_cab02f_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_color_204, cargo_subtype) {1:ss_mid_400_series_cab02f_2cc; 4:ss_mid_400_series_cab02f_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_shape_204, cargo_subtype) {3..5:ss_mid_400_series_cab02f_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_color_400, cargo_subtype) {1:ss_mid_400_series_cab02f_2cc; 3:ss_mid_400_series_cab02f_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_shape_400, cargo_subtype) {2..3:ss_mid_400_series_cab02f_rfb;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_color, vehicle_type_id) {400:ss_mid_400_series_cab02f_color_400; 204:ss_mid_400_series_cab02f_color_204; 2044:ss_mid_400_series_cab02f_color_2044;}
	switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02f_shape, vehicle_type_id) {400:ss_mid_400_series_cab02f_shape_400; 204:ss_mid_400_series_cab02f_shape_204; 2044:ss_mid_400_series_cab02f_shape_2044;}


    switch(FEAT_TRAINS, SELF, sw_400_series_cab02f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_400_series_cab02f_shape;		// Mask for Mid
                2: ss_mid_400_series_cab02f_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02b_color, cargo_subtype) {1:ss_mid_400_series_cab02b_2cc; 3:ss_mid_400_series_cab02b_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_cab02b_shape, cargo_subtype) {2..3:ss_mid_400_series_cab02b_rfb;}

    switch(FEAT_TRAINS, SELF, sw_400_series_cab02b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_400_series_cab02b_shape;		// Mask for Mid
                2: ss_mid_400_series_cab02b_color;		// Mask for Mid
			}
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_coach.pnml" 1
/* coach */

spriteset(ss_mid_400_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_coachf_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_coachb_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_coachf_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_coachb_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_color_2044, cargo_subtype) {3:ss_mid_400_series_coachf_2cc; }
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_shape_2044, cargo_subtype) {4..5:ss_mid_400_series_coachf_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_color_204, cargo_subtype) {1:ss_mid_400_series_coachf_2cc; 4:ss_mid_400_series_coachf_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_shape_204, cargo_subtype) {3..5:ss_mid_400_series_coachf_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_color_400, cargo_subtype) {1:ss_mid_400_series_coachf_2cc; 3:ss_mid_400_series_coachf_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_shape_400, cargo_subtype) {2..3:ss_mid_400_series_coachf_rfb;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_color, vehicle_type_id) {400:ss_mid_400_series_coachf_color_400; 204:ss_mid_400_series_coachf_color_204; 2044:ss_mid_400_series_coachf_color_2044;}
	switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachf_shape, vehicle_type_id) {400:ss_mid_400_series_coachf_shape_400; 204:ss_mid_400_series_coachf_shape_204; 2044:ss_mid_400_series_coachf_shape_2044;}

    switch(FEAT_TRAINS, SELF, sw_400_series_coachf, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_coachf_irl;       	// Base for Mid
				1: ss_mid_400_series_coachf_shape;		// Mask for Mid
                2: ss_mid_400_series_coachf_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachb_color, cargo_subtype) {1:ss_mid_400_series_coachb_2cc; 3:ss_mid_400_series_coachb_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_coachb_shape, cargo_subtype) {2..3:ss_mid_400_series_coachb_rfb;}

    switch(FEAT_TRAINS, SELF, sw_400_series_coachb, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_coachb_irl;       	// Base for Mid
				1: ss_mid_400_series_coachb_shape;		// Mask for Mid
                2: ss_mid_400_series_coachb_color;		// Mask for Mid
			}
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_panto.pnml" 1
/* panto */

spriteset(ss_mid_400_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_pantof_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_pantob_2cc, "src/trains/400_series/gfx/400_series_2cc.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/400_series/gfx/400_series_refurb.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_400_series_pantof_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_400_series_pantob_rf2, "src/trains/400_series/gfx/400_series_refurb_2cc.png") {tmpl_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_color_2044, cargo_subtype) {3:ss_mid_400_series_pantof_2cc; }
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_shape_2044, cargo_subtype) {4..5:ss_mid_400_series_pantof_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_color_204, cargo_subtype) {1:ss_mid_400_series_pantof_2cc; 4:ss_mid_400_series_pantof_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_shape_204, cargo_subtype) {3..5:ss_mid_400_series_pantof_rfb;}

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_color_400, cargo_subtype) {1:ss_mid_400_series_pantof_2cc; 3:ss_mid_400_series_pantof_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_shape_400, cargo_subtype) {2..3:ss_mid_400_series_pantof_rfb;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_color, vehicle_type_id) {400:ss_mid_400_series_pantof_color_400; 204:ss_mid_400_series_pantof_color_204; 2044:ss_mid_400_series_pantof_color_2044;}
	switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantof_shape, vehicle_type_id) {400:ss_mid_400_series_pantof_shape_400; 204:ss_mid_400_series_pantof_shape_204; 2044:ss_mid_400_series_pantof_shape_2044;}

    switch(FEAT_TRAINS, SELF, sw_400_series_pantof, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_pantof_irl;       	// Base for Mid
				1: ss_mid_400_series_pantof_shape;		// Mask for Mid
                2: ss_mid_400_series_pantof_color;		// Mask for Mid
                3: panto_midsprite_400_f;               // Panto
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantob_color, cargo_subtype) {1:ss_mid_400_series_pantob_2cc; 3:ss_mid_400_series_pantob_rf2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_400_series_pantob_shape, cargo_subtype) {2..3:ss_mid_400_series_pantob_rfb;}

    switch(FEAT_TRAINS, SELF, sw_400_series_pantob, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_400_series_pantob_irl;       	// Base for Mid
				1: ss_mid_400_series_pantob_shape;		// Mask for Mid
                2: ss_mid_400_series_pantob_color;		// Mask for Mid
                3: panto_midsprite_400_b;               // Panto
			}
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_formations.pnml" 1

/* Midcars */
    // Backwards
        // Two and Four
        switch (FEAT_TRAINS, SELF, sw_400_series_backwards_length_large, position_in_consist_from_end ) {				
                2:  sw_400_series_pantob;
                4:  sw_400_series_pantob;
                sw_400_series_coachb;			
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_400_series_backwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_400_series_coachb;
                sw_400_series_pantob;				
            }
	switch (FEAT_TRAINS, SELF, sw_400_series_backwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_400_series_backwards_length_large;
			sw_400_series_backwards_length_small;				
		}
	// Forwards
        // Two and Four
        switch (FEAT_TRAINS, SELF, sw_400_series_forwards_length_large, position_in_consist ) {				
                2:  sw_400_series_pantof;
                4:  sw_400_series_pantof;
                sw_400_series_coachf;		
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_400_series_forwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_400_series_coachf;
                sw_400_series_pantof;				
            }
	switch (FEAT_TRAINS, SELF, sw_400_series_forwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_400_series_forwards_length_large;
			sw_400_series_forwards_length_small;				
		}

	switch (FEAT_TRAINS, PARENT, sw_400_series_midcars, vehicle_is_reversed) {				
			0:  sw_400_series_forwards_length;
			sw_400_series_backwards_length;				
		}

/* Cab selection */
    // Rear cab
    switch (FEAT_TRAINS, PARENT, sw_400_series_rear, vehicle_is_reversed) {				
            1:  sw_400_series_cab01b;                   // cab01	
            sw_400_series_cab02f;                       // cab02
        }

    // Lead cab
    switch (FEAT_TRAINS, PARENT, sw_400_series_lead, vehicle_is_reversed) {				
            1:  sw_400_series_cab02b;                   // cab02
            sw_400_series_cab01f;                       // cab01	
        }

/* Find the cabs */
    switch (FEAT_TRAINS, SELF, sw_400_series_lead_or_rear, position_in_consist) {				
            0:  sw_400_series_lead;
            sw_400_series_rear;				
        }
    
    switch (FEAT_TRAINS, SELF, sw_400_series_graphics, position_in_consist == 0 || position_in_consist_from_end == 0 ) {				
            1:  sw_400_series_lead_or_rear;
            sw_400_series_midcars;				
        }
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "src/trains/400_series/400_series_item.pnml" 1

/*---Coupling Switch---*/
    switch(FEAT_TRAINS, SELF, sw_400_series_attach_vehid, [vehicle_type_id == series_400 || vehicle_type_id == mu_car_ms]) {
        0: return string(MU_UNIQUE);
    }
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_400) {
    property {
        name:                           string(STR_NAME_400_SERIES);
        introduction_date:              date(1992,07,01);
        model_life:                     28;                             // In service until 2010,04,18
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          240 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          4 * 280 hp;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_SPRITE_STACK);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        //dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_400_series_graphics;
	    purchase:                       sw_400_series_purchase;
		additional_text:	            return string(STR_DESC_400_SERIES);
        cargo_subtype_text:             sw_400_series_subtypetext;
        can_attach_wagon:			    sw_400_series_attach_vehid;
        //start_stop:                   ;
        purchase_weight:                42 / 2;
        purchase_power:                 282 * 4;
        /* Stats */
        power:                          max (num_vehs_in_consist - 1 , 0 ) * 282 * 4;               // 210 kW = 282 hp
        weight:                         42 * num_vehs_in_consist;
        cargo_capacity:                 57 * CapacityFactor();							            // 399 / 7 = 57					
		loading_speed:					57 * CapacityFactor() / param_loading_1D;					// Capacity divided by door loading factor
        running_cost_factor:            (445 + 125 * num_vehs_in_consist ) * RunningCostFactor();
        purchase_running_cost_factor:   (445 + 125 ) / 2;	
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_400_series_graphics;
        cargo_capacity:                 57 * CapacityFactor();	
        cargo_age_period:				param_decay_express;
        loading_speed:                  57 * CapacityFactor() / param_loading_1D;
        cargo_subtype_text:             sw_400_series_subtypetext;
        //power:                          4 * 280;
        //weight:                         42;
        //running_cost_factor:            120;
      }
}
# 1 "src/trains/400_series/400_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e1_series/e1_series.pnml" 1

# 1 "src/trains/e1_series/e1_series_menu.pnml" 1
/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_e1_series_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(LV_E1_SERIES_ORIGINAL);
        2: return string(LV_E1_SERIES_REFURB);
        3: return string(LV_E1_SERIES_2CC);
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e1_series_irl_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {template_purchase(233, 1)}
    spriteset (ss_e1_series_rfb_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {template_purchase(233, 1)}

    
    switch(FEAT_TRAINS, SELF, sw_e1_series_year_dep_purchase, current_year) {
			0..2003: ss_e1_series_irl_buy;
			ss_e1_series_rfb_buy;
		}
    
    
    switch(FEAT_TRAINS, SELF, sw_e1_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: sw_e1_series_year_dep_purchase;
        }
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e1_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e1_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e1_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e1_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e1_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e1_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e1_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e1_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_rev(1,51)}

    // Refurb

	// 10/8
	spriteset(ss_std_e1_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e1_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e1_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e1_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e1_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e1_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e1_series_cab01f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e1_series_cab01b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e1_series_cab01f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e1_series_cab01b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e1_series_cab01f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e1_series_cab01b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e1_series_cab01f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e1_series_cab01b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e1_series_cab01f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e1_series_cab01b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_cab01f_yeardep, build_year) {0..2003: ss_frt_e1_series_cab01f_irl; ss_frt_e1_series_cab01f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_cab01f_mask, cargo_subtype) {0:ss_frt_e1_series_cab01f_yeardep; 1:ss_frt_e1_series_cab01f_irl; 2:ss_frt_e1_series_cab01f_rfb; 3:ss_frt_e1_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_cab01f_irl;       	// Base for Front
				1: ss_frt_e1_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e1_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_cab01f_yeardep, build_year) {0..2003: ss_mid_e1_series_cab01f_irl; ss_mid_e1_series_cab01f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_cab01f_mask, cargo_subtype) {0:ss_mid_e1_series_cab01f_yeardep; 1:ss_mid_e1_series_cab01f_irl; 2:ss_mid_e1_series_cab01f_rfb; 3:ss_mid_e1_series_cab01f_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_cab01f_yeardep, build_year) {0..2003: ss_std_e1_series_cab01f_irl; ss_std_e1_series_cab01f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_cab01f_mask, cargo_subtype) {0:ss_std_e1_series_cab01f_yeardep; 1:ss_std_e1_series_cab01f_irl; 2:ss_std_e1_series_cab01f_rfb; 3:ss_std_e1_series_cab01f_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_mid_longsprite, HideLongSprite()) { 0: ss_std_e1_series_cab01f_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_std_longsprite, HideLongSprite()) { 0: ss_std_e1_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_e1_series_cab01f_mask;		// Mask for Mid
				2: sw_e1_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_cab01f_yeardep, build_year) {0..2003: ss_bck_e1_series_cab01f_irl; ss_bck_e1_series_cab01f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_cab01f_mask, cargo_subtype) {0:ss_bck_e1_series_cab01f_yeardep; 1:ss_bck_e1_series_cab01f_irl; 2:ss_bck_e1_series_cab01f_rfb; 3:ss_bck_e1_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_cab01f_irl;       	// Base for Front
				1: ss_bck_e1_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e1_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e1_series_cab01f_frt_longsprite;
            1: sw_e1_series_cab01f_mid_stack;
            2: sw_e1_series_cab01f_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_cab01b_yeardep, build_year) {0..2003: ss_frt_e1_series_cab01b_irl; ss_frt_e1_series_cab01b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_cab01b_mask, cargo_subtype) {0:ss_frt_e1_series_cab01b_yeardep; 1:ss_frt_e1_series_cab01b_irl; 2:ss_frt_e1_series_cab01b_rfb; 3:ss_frt_e1_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_cab01b_irl;       	// Base for Front
				1: ss_frt_e1_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e1_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_cab01b_yeardep, build_year) {0..2003: ss_mid_e1_series_cab01b_irl; ss_mid_e1_series_cab01b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_cab01b_mask, cargo_subtype) {0:ss_mid_e1_series_cab01b_yeardep; 1:ss_mid_e1_series_cab01b_irl; 2:ss_mid_e1_series_cab01b_rfb; 3:ss_mid_e1_series_cab01b_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_cab01b_yeardep, build_year) {0..2003: ss_std_e1_series_cab01b_irl; ss_std_e1_series_cab01b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_cab01b_mask, cargo_subtype) {0:ss_std_e1_series_cab01b_yeardep; 1:ss_std_e1_series_cab01b_irl; 2:ss_std_e1_series_cab01b_rfb; 3:ss_std_e1_series_cab01b_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_cab01b_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_e1_series_cab01b_mask;		// Mask for Mid
				2: sw_e1_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_cab01b_yeardep, build_year) {0..2003: ss_bck_e1_series_cab01b_irl; ss_bck_e1_series_cab01b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_cab01b_mask, cargo_subtype) {0:ss_bck_e1_series_cab01b_yeardep; 1:ss_bck_e1_series_cab01b_irl; 2:ss_bck_e1_series_cab01b_rfb; 3:ss_bck_e1_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_cab01b_irl;       	// Base for Front
				1: ss_bck_e1_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e1_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e1_series_cab01b_frt_longsprite;
            1: sw_e1_series_cab01b_mid_stack;
            2: sw_e1_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e1_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e1_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e1_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e1_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e1_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e1_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e1_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e1_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_cab_bck_rev(1,1)}

    // Refurb

	// 10/8
	spriteset(ss_std_e1_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e1_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e1_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e1_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e1_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e1_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e1_series_cab02f_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e1_series_cab02b_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e1_series_cab02f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e1_series_cab02b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e1_series_cab02f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e1_series_cab02b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e1_series_cab02f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e1_series_cab02b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e1_series_cab02f_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e1_series_cab02b_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_cab02f_yeardep, build_year) {0..2003: ss_frt_e1_series_cab02f_irl; ss_frt_e1_series_cab02f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_cab02f_mask, cargo_subtype) {0:ss_frt_e1_series_cab02f_yeardep; 1:ss_frt_e1_series_cab02f_irl; 2:ss_frt_e1_series_cab02f_rfb; 3:ss_frt_e1_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_cab02f_irl;       	// Base for Front
				1: ss_frt_e1_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e1_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_cab02f_yeardep, build_year) {0..2003: ss_mid_e1_series_cab02f_irl; ss_mid_e1_series_cab02f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_cab02f_mask, cargo_subtype) {0:ss_mid_e1_series_cab02f_yeardep; 1:ss_mid_e1_series_cab02f_irl; 2:ss_mid_e1_series_cab02f_rfb; 3:ss_mid_e1_series_cab02f_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_cab02f_yeardep, build_year) {0..2003: ss_std_e1_series_cab02f_irl; ss_std_e1_series_cab02f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_cab02f_mask, cargo_subtype) {0:ss_std_e1_series_cab02f_yeardep; 1:ss_std_e1_series_cab02f_irl; 2:ss_std_e1_series_cab02f_rfb; 3:ss_std_e1_series_cab02f_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_cab02f_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_e1_series_cab02f_mask;		// Mask for Mid
				2: sw_e1_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_cab02f_yeardep, build_year) {0..2003: ss_bck_e1_series_cab02f_irl; ss_bck_e1_series_cab02f_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_cab02f_mask, cargo_subtype) {0:ss_bck_e1_series_cab02f_yeardep; 1:ss_bck_e1_series_cab02f_irl; 2:ss_bck_e1_series_cab02f_rfb; 3:ss_bck_e1_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_cab02f_irl;       	// Base for Front
				1: ss_bck_e1_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e1_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e1_series_cab02f_frt_longsprite;
            1: sw_e1_series_cab02f_mid_stack;
            2: sw_e1_series_cab02f_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_cab02b_yeardep, build_year) {0..2003: ss_frt_e1_series_cab02b_irl; ss_frt_e1_series_cab02b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_cab02b_mask, cargo_subtype) {0:ss_frt_e1_series_cab02b_yeardep; 1:ss_frt_e1_series_cab02b_irl; 2:ss_frt_e1_series_cab02b_rfb; 3:ss_frt_e1_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_cab02b_irl;       	// Base for Front
				1: ss_frt_e1_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e1_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_cab02b_yeardep, build_year) {0..2003: ss_mid_e1_series_cab02b_irl; ss_mid_e1_series_cab02b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_cab02b_mask, cargo_subtype) {0:ss_mid_e1_series_cab02b_yeardep; 1:ss_mid_e1_series_cab02b_irl; 2:ss_mid_e1_series_cab02b_rfb; 3:ss_mid_e1_series_cab02b_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_cab02b_yeardep, build_year) {0..2003: ss_std_e1_series_cab02b_irl; ss_std_e1_series_cab02b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_cab02b_mask, cargo_subtype) {0:ss_std_e1_series_cab02b_yeardep; 1:ss_std_e1_series_cab02b_irl; 2:ss_std_e1_series_cab02b_rfb; 3:ss_std_e1_series_cab02b_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_mid_longsprite, HideLongSprite()) { 0: ss_std_e1_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_std_longsprite, HideLongSprite()) { 0: ss_std_e1_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_e1_series_cab02b_mask;		// Mask for Mid
				2: sw_e1_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_cab02b_yeardep, build_year) {0..2003: ss_bck_e1_series_cab02b_irl; ss_bck_e1_series_cab02b_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_cab02b_mask, cargo_subtype) {0:ss_bck_e1_series_cab02b_yeardep; 1:ss_bck_e1_series_cab02b_irl; 2:ss_bck_e1_series_cab02b_rfb; 3:ss_bck_e1_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_cab02b_irl;       	// Base for Front
				1: ss_bck_e1_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e1_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e1_series_cab02b_frt_longsprite;
            1: sw_e1_series_cab02b_mid_stack;
            2: sw_e1_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e1_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_e1_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_e1_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_e1_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_e1_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_e1_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_e1_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_e1_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_rev(1,151)}

    // Refurb

	// 10/8
	spriteset(ss_std_e1_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_e1_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_e1_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_e1_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_e1_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_e1_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_e1_series_coachf_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_e1_series_coachb_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_rev(1,151)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e1_series_coachf_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_e1_series_coachb_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_e1_series_coachf_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_e1_series_coachb_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_e1_series_coachf_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_e1_series_coachb_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_e1_series_coachf_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_e1_series_coachb_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_rev(1,151)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_coachf_yeardep, build_year) {0..2003: ss_frt_e1_series_coachf_irl; ss_frt_e1_series_coachf_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_coachf_mask, cargo_subtype) {0:ss_frt_e1_series_coachf_yeardep; 1:ss_frt_e1_series_coachf_irl; 2:ss_frt_e1_series_coachf_rfb; 3:ss_frt_e1_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_coachf_irl;       	// Base for Front
				1: ss_frt_e1_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_e1_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_coachf_yeardep, build_year) {0..2003: ss_mid_e1_series_coachf_irl; ss_mid_e1_series_coachf_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_coachf_mask, cargo_subtype) {0:ss_mid_e1_series_coachf_yeardep; 1:ss_mid_e1_series_coachf_irl; 2:ss_mid_e1_series_coachf_rfb; 3:ss_mid_e1_series_coachf_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_coachf_yeardep, build_year) {0..2003: ss_std_e1_series_coachf_irl; ss_std_e1_series_coachf_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_coachf_mask, cargo_subtype) {0:ss_std_e1_series_coachf_yeardep; 1:ss_std_e1_series_coachf_irl; 2:ss_std_e1_series_coachf_rfb; 3:ss_std_e1_series_coachf_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_mid_longsprite, HideLongSprite()) { 0: ss_std_e1_series_coachf_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_std_longsprite, HideLongSprite()) { 0: ss_std_e1_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_coachf_irl;       	// Base for Mid
				1: ss_mid_e1_series_coachf_mask;		// Mask for Mid
				2: sw_e1_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_coachf_yeardep, build_year) {0..2003: ss_bck_e1_series_coachf_irl; ss_bck_e1_series_coachf_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_coachf_mask, cargo_subtype) {0:ss_bck_e1_series_coachf_yeardep; 1:ss_bck_e1_series_coachf_irl; 2:ss_bck_e1_series_coachf_rfb; 3:ss_bck_e1_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_coachf_irl;       	// Base for Front
				1: ss_bck_e1_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_e1_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_coachf, position_in_consist % 3 ) {				
            0: sw_e1_series_coachf_frt_longsprite;
            1: sw_e1_series_coachf_mid_stack;
            2: sw_e1_series_coachf_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_coachb_yeardep, build_year) {0..2003: ss_frt_e1_series_coachb_irl; ss_frt_e1_series_coachb_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_coachb_mask, cargo_subtype) {0:ss_frt_e1_series_coachb_yeardep; 1:ss_frt_e1_series_coachb_irl; 2:ss_frt_e1_series_coachb_rfb; 3:ss_frt_e1_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_coachb_irl;       	// Base for Front
				1: ss_frt_e1_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_e1_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_coachb_yeardep, build_year) {0..2003: ss_mid_e1_series_coachb_irl; ss_mid_e1_series_coachb_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_coachb_mask, cargo_subtype) {0:ss_mid_e1_series_coachb_yeardep; 1:ss_mid_e1_series_coachb_irl; 2:ss_mid_e1_series_coachb_rfb; 3:ss_mid_e1_series_coachb_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_coachb_yeardep, build_year) {0..2003: ss_std_e1_series_coachb_irl; ss_std_e1_series_coachb_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_coachb_mask, cargo_subtype) {0:ss_std_e1_series_coachb_yeardep; 1:ss_std_e1_series_coachb_irl; 2:ss_std_e1_series_coachb_rfb; 3:ss_std_e1_series_coachb_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_coachb_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_e1_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_coachb_irl;       	// Base for Mid
				1: ss_mid_e1_series_coachb_mask;		// Mask for Mid
				2: sw_e1_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_coachb_yeardep, build_year) {0..2003: ss_bck_e1_series_coachb_irl; ss_bck_e1_series_coachb_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_coachb_mask, cargo_subtype) {0:ss_bck_e1_series_coachb_yeardep; 1:ss_bck_e1_series_coachb_irl; 2:ss_bck_e1_series_coachb_rfb; 3:ss_bck_e1_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_coachb_irl;       	// Base for Front
				1: ss_bck_e1_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_e1_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_e1_series_coachb_frt_longsprite;
            1: sw_e1_series_coachb_mid_stack;
            2: sw_e1_series_coachb_bck_longsprite;
        }

# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e1_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e1_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e1_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e1_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e1_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e1_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e1_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e1_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_irl.png") {tmpl_bck_rev(1,101)}

    // Refurb

	// 10/8
	spriteset(ss_std_e1_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e1_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e1_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e1_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e1_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e1_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e1_series_pantof_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e1_series_pantob_rfb, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e1_series/gfx/e1_series_rfb.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e1_series_pantof_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e1_series_pantob_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e1_series_pantof_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e1_series_pantob_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e1_series_pantof_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e1_series_pantob_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e1_series_pantof_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e1_series_pantob_2cc, "src/trains/e1_series/gfx/e1_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_pantof_yeardep, build_year) {0..2003: ss_frt_e1_series_pantof_irl; ss_frt_e1_series_pantof_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_pantof_mask, cargo_subtype) {0:ss_frt_e1_series_pantof_yeardep; 1:ss_frt_e1_series_pantof_irl; 2:ss_frt_e1_series_pantof_rfb; 3:ss_frt_e1_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_pantof_irl;       	// Base for Front
				1: ss_frt_e1_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e1_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_pantof_yeardep, build_year) {0..2003: ss_mid_e1_series_pantof_irl; ss_mid_e1_series_pantof_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_pantof_mask, cargo_subtype) {0:ss_mid_e1_series_pantof_yeardep; 1:ss_mid_e1_series_pantof_irl; 2:ss_mid_e1_series_pantof_rfb; 3:ss_mid_e1_series_pantof_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_pantof_yeardep, build_year) {0..2003: ss_std_e1_series_pantof_irl; ss_std_e1_series_pantof_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_pantof_mask, cargo_subtype) {0:ss_std_e1_series_pantof_yeardep; 1:ss_std_e1_series_pantof_irl; 2:ss_std_e1_series_pantof_rfb; 3:ss_std_e1_series_pantof_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_mid_longsprite, HideLongSprite()) { 0: ss_std_e1_series_pantof_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_std_longsprite, HideLongSprite()) { 0: ss_std_e1_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_pantof_irl;       	// Base for Mid
				1: ss_mid_e1_series_pantof_mask;		// Mask for Mid
				2: sw_e1_series_pantof_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_pantof_std_longsprite;
				// Pantos
                4: panto_midsprite_e1_f;
                5: panto_longsprite_e1_f;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_pantof_yeardep, build_year) {0..2003: ss_bck_e1_series_pantof_irl; ss_bck_e1_series_pantof_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_pantof_mask, cargo_subtype) {0:ss_bck_e1_series_pantof_yeardep; 1:ss_bck_e1_series_pantof_irl; 2:ss_bck_e1_series_pantof_rfb; 3:ss_bck_e1_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_pantof_irl;       	// Base for Front
				1: ss_bck_e1_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e1_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_pantof, position_in_consist % 3 ) {				
            0: sw_e1_series_pantof_frt_longsprite;
            1: sw_e1_series_pantof_mid_stack;
            2: sw_e1_series_pantof_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e1_series_pantob_yeardep, build_year) {0..2003: ss_frt_e1_series_pantob_irl; ss_frt_e1_series_pantob_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e1_series_pantob_mask, cargo_subtype) {0:ss_frt_e1_series_pantob_yeardep; 1:ss_frt_e1_series_pantob_irl; 2:ss_frt_e1_series_pantob_rfb; 3:ss_frt_e1_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e1_series_pantob_irl;       	// Base for Front
				1: ss_frt_e1_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e1_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e1_series_pantob_yeardep, build_year) {0..2003: ss_mid_e1_series_pantob_irl; ss_mid_e1_series_pantob_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e1_series_pantob_mask, cargo_subtype) {0:ss_mid_e1_series_pantob_yeardep; 1:ss_mid_e1_series_pantob_irl; 2:ss_mid_e1_series_pantob_rfb; 3:ss_mid_e1_series_pantob_2cc; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e1_series_pantob_yeardep, build_year) {0..2003: ss_std_e1_series_pantob_irl; ss_std_e1_series_pantob_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_std_e1_series_pantob_mask, cargo_subtype) {0:ss_std_e1_series_pantob_yeardep; 1:ss_std_e1_series_pantob_irl; 2:ss_std_e1_series_pantob_rfb; 3:ss_std_e1_series_pantob_2cc; }
			
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_mid_longsprite, HideLongSprite()) { 0: ss_std_e1_series_pantob_irl; }
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_std_longsprite, HideLongSprite()) { 0: ss_std_e1_series_pantob_mask; }

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e1_series_pantob_irl;       	// Base for Mid
				1: ss_mid_e1_series_pantob_mask;		// Mask for Mid
				2: sw_e1_series_pantob_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e1_series_pantob_std_longsprite;
				// Pantos
                4: panto_midsprite_e1_b;
                5: panto_longsprite_e1_b;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e1_series_pantob_yeardep, build_year) {0..2003: ss_bck_e1_series_pantob_irl; ss_bck_e1_series_pantob_rfb; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e1_series_pantob_mask, cargo_subtype) {0:ss_bck_e1_series_pantob_yeardep; 1:ss_bck_e1_series_pantob_irl; 2:ss_bck_e1_series_pantob_rfb; 3:ss_bck_e1_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e1_series_pantob_irl;       	// Base for Front
				1: ss_bck_e1_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e1_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e1_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e1_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e1_series_pantob_frt_longsprite;
            1: sw_e1_series_pantob_mid_stack;
            2: sw_e1_series_pantob_bck_longsprite;
        }
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_formations.pnml" 1

/* Forwards */

    switch (FEAT_TRAINS, SELF, sw_e1_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e1_series_pantof;
            sw_e1_series_coachf;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e1_series_forwards_6th_and_3_from_end, CarNumber() == 6 || CarNumberFromEnd()  == 3) {				
            0:  sw_e1_series_coachf;
            sw_e1_series_pantof;				
        }

    switch (FEAT_TRAINS, SELF, sw_e1_series_forwards, num_vehs_in_consist ) {				
            0..35:  sw_e1_series_forwards_panto_in_middle;
               sw_e1_series_forwards_6th_and_3_from_end;				
        }

/* Backwards */

    switch (FEAT_TRAINS, SELF, sw_e1_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e1_series_pantob;
            sw_e1_series_coachb;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e1_series_backwards_6th_and_3_from_end, CarNumberFromEnd() == 6 || CarNumber()  == 3) {				
            0:  sw_e1_series_coachb;
            sw_e1_series_pantob;				
        }

    switch (FEAT_TRAINS, SELF, sw_e1_series_backwards, num_vehs_in_consist ) {				
            0..35:  sw_e1_series_backwards_panto_in_middle;
               sw_e1_series_backwards_6th_and_3_from_end;				
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_e1_series_midcars, vehicle_is_reversed) {				
            0:  sw_e1_series_forwards;
            sw_e1_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e1_series_rear, vehicle_is_reversed) {				
            1: sw_e1_series_cab01b;
            sw_e1_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e1_series_lead, vehicle_is_reversed) {				
            1: sw_e1_series_cab02b;
            sw_e1_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e1_series_cabs, position_in_consist) {				
            0..2: sw_e1_series_lead;
            sw_e1_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e1_series_graphics, IsCab() ) {				
            1:  sw_e1_series_cabs;
            sw_e1_series_midcars;	
        }
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "src/trains/e1_series/e1_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_e1_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_e1;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_e1) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E1_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1994,07,15);
		model_life:                     18;							// In service until 2012,09,28
		vehicle_life:                   30;						
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          241 km/h;					// Operational Top Speed
		power:                          550 * 4 * 6 hp;					// 550 hp (or 410 kW) per motor x 4 motors per car x 6 motorised cars
		weight:                         58 * 12 tons;					// 58t (per JPS) x 12 cars
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_E1_SERIES);
		cargo_subtype_text:				sw_e1_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                58;
        purchase_power:                 550 * 4;
		/* Graphics */
		default:                        sw_e1_series_graphics;
		purchase:                       sw_e1_series_purchase;
		articulated_part:               sw_e1_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        colour_mapping:                 return base_sprite_2cc + CB_RESULT_COLOUR_MAPPING_ADD_CC;
		/* Stats */
		length:                         sw_length_1_8_1;
		power:							NumberCarsInConsist() / 2 * 550 * 4;	// 410 kW
		weight:							NumberCarsInConsist() * 58;
		cargo_capacity:                 34 * CapacityFactor();										// 1235 capacity / (12 cars * 3 parts) is approx 35						
		loading_speed:					34 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    128;
		running_cost_factor:            (295 + 122 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   295 + 122 * NumberCarsInConsist();
	}
	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e1_series_graphics;
        colour_mapping:                 return base_sprite_2cc + CB_RESULT_COLOUR_MAPPING_ADD_CC;
        cargo_capacity:                 34 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					34 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e1_series_running_costs;
      }
}
# 1 "src/trains/e1_series/e1_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e2_series/e2_series.pnml" 1

# 1 "src/trains/e2_series/e2_series_menu.pnml" 1

/* SUBTYPES */

    switch(FEAT_TRAINS, SELF, sw_e2_series_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(LV_E2_SERIES_RED);
        2: return string(LV_E2_SERIES_PINK);
        3: return string(LV_E2_SERIES_200);
        4: return string(LV_E2_SERIES_2CC);
        return CB_RESULT_NO_TEXT;
        }

/* Purchase Menu */

    spriteset (ss_e2_series_red_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {template_purchase(233, 1)}
    spriteset (ss_e2_series_pnk_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {template_purchase(233, 1)}

    
    switch(FEAT_TRAINS, SELF, sw_e2_series_year_dep_purchase, build_year) {2002..9999: ss_e2_series_pnk_buy;}
    
    switch(FEAT_TRAINS, SELF, sw_e2_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e2_series_red_buy;
            2: sw_e2_series_year_dep_purchase;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e2_series_cab01f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e2_series_cab01b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e2_series_cab01f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e2_series_cab01b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e2_series_cab01f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e2_series_cab01b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e2_series_cab01f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e2_series_cab01b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e2_series_cab01f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e2_series_cab01b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e2_series_cab01f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e2_series_cab01b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e2_series_cab01f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e2_series_cab01b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e2_series_cab01f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e2_series_cab01b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_rev(1,51)}

    // Pink Stripe

    // 10/8
	spriteset(ss_std_e2_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e2_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e2_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e2_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e2_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e2_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e2_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e2_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_rev(1,51)}

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_cab01f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e2_series_cab01b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e2_series_cab01f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e2_series_cab01b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e2_series_cab01f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e2_series_cab01b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e2_series_cab01f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e2_series_cab01b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,51)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_cab01f_ydp, build_year) {2002..9999: ss_frt_e2_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab01f_cycle, cargo_subtype % 4) {2:ss_frt_e2_series_cab01f_pnk; 3:ss_frt_e2_series_cab01f_200; 0:ss_frt_e2_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab01f_mask, cargo_subtype) {0:ss_frt_e2_series_cab01f_ydp; ss_frt_e2_series_cab01f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_cab01f_red;       	    // Base for Front
				1: ss_frt_e2_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_cab01f_ydp, build_year) {2002..9999: ss_mid_e2_series_cab01f_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab01f_cycle, cargo_subtype % 4) {2:ss_mid_e2_series_cab01f_pnk; 3:ss_mid_e2_series_cab01f_200; 0:ss_mid_e2_series_cab01f_2cc; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab01f_mask, cargo_subtype) {0:ss_mid_e2_series_cab01f_ydp; ss_mid_e2_series_cab01f_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab01f_red, HideLongSprite() ) { 0: ss_std_e2_series_cab01f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_cab01f_ydp, build_year) {2002..9999: ss_std_e2_series_cab01f_pnk; }
                switch(FEAT_TRAINS, PARENT, ss_std_e2_series_cab01f_cycle, cargo_subtype % 4) {2:ss_std_e2_series_cab01f_pnk; 3:ss_std_e2_series_cab01f_200; 0:ss_std_e2_series_cab01f_2cc; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_cab01f_mask, cargo_subtype) {0:ss_std_e2_series_cab01f_ydp; ss_std_e2_series_cab01f_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab01f_mask, HideLongSprite() ) { 0: ss_std_e2_series_cab01f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_cab01f_red;       	    // Base for Mid
                1: ss_mid_e2_series_cab01f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_cab01f_red;	    // Base for LongSprite
				3: longsprite_e2_series_cab01f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_cab01f_ydp, build_year) {2002..9999: ss_bck_e2_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab01f_cycle, cargo_subtype % 4) {2:ss_bck_e2_series_cab01f_pnk; 3:ss_bck_e2_series_cab01f_200; 0:ss_bck_e2_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab01f_mask, cargo_subtype) {0:ss_bck_e2_series_cab01f_ydp; ss_bck_e2_series_cab01f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_cab01f_red;       	    // Base for Back
				1: ss_bck_e2_series_cab01f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e2_series_cab01f_frt_longsprite;
            1: sw_e2_series_cab01f_mid_stack;
            2: sw_e2_series_cab01f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_cab01b_ydp, build_year) {2002..9999: ss_frt_e2_series_cab01b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab01b_mask, cargo_subtype) {0:ss_frt_e2_series_cab01b_ydp; 2:ss_frt_e2_series_cab01b_pnk;  3:ss_frt_e2_series_cab01b_200; 4:ss_frt_e2_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_cab01b_red;       	    // Base for Front
				1: ss_frt_e2_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_cab01b_ydp, build_year) {2002..9999: ss_mid_e2_series_cab01b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab01b_mask, cargo_subtype) {0:ss_mid_e2_series_cab01b_ydp; 2:ss_mid_e2_series_cab01b_pnk; 3:ss_mid_e2_series_cab01b_200; 4:ss_mid_e2_series_cab01b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab01b_red, HideLongSprite() ) { 0: ss_std_e2_series_cab01b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_cab01b_ydp, build_year) {2002..9999: ss_std_e2_series_cab01b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_cab01b_mask, cargo_subtype) {0:ss_std_e2_series_cab01b_ydp; 2:ss_std_e2_series_cab01b_pnk; 3:ss_std_e2_series_cab01b_200; 4:ss_std_e2_series_cab01b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab01b_mask, HideLongSprite() ) { 0: sw_std_e2_series_cab01b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_cab01b_red;       	    // Base for Mid
                1: ss_mid_e2_series_cab01b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_cab01b_red;	        // Base for LongSprite
				3: longsprite_e2_series_cab01b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_cab01b_ydp, build_year) {2002..9999: ss_bck_e2_series_cab01b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab01b_mask, cargo_subtype) {0:ss_bck_e2_series_cab01b_ydp; 2:ss_bck_e2_series_cab01b_pnk; 3:ss_bck_e2_series_cab01b_200; 4:ss_bck_e2_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_cab01b_red;       	    // Base for Back
				1: ss_bck_e2_series_cab01b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_cab01b_frt_longsprite;
            1: sw_e2_series_cab01b_mid_stack;
            2: sw_e2_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e2_series_cab02f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e2_series_cab02b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e2_series_cab02f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e2_series_cab02b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e2_series_cab02f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e2_series_cab02b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e2_series_cab02f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e2_series_cab02b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e2_series_cab02f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e2_series_cab02b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e2_series_cab02f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e2_series_cab02b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e2_series_cab02f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e2_series_cab02b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e2_series_cab02f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e2_series_cab02b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

    // Pink Stripe

    // 10/8
	spriteset(ss_std_e2_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e2_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e2_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e2_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e2_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e2_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e2_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e2_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_cab_bck_rev(1,1)}

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_cab02f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e2_series_cab02b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e2_series_cab02f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e2_series_cab02b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e2_series_cab02f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e2_series_cab02b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e2_series_cab02f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e2_series_cab02b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_cab_bck_rev(1,1)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_cab02f_ydp, build_year) {2002..9999: ss_frt_e2_series_cab02f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab02f_cycle, cargo_subtype % 4) {2:ss_frt_e2_series_cab02f_pnk; 3:ss_frt_e2_series_cab02f_200; 0:ss_frt_e2_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab02f_mask, cargo_subtype) {0:ss_frt_e2_series_cab02f_ydp; ss_frt_e2_series_cab02f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_cab02f_red;       	    // Base for Front
				1: ss_frt_e2_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_cab02f_ydp, build_year) {2002..9999: ss_mid_e2_series_cab02f_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab02f_cycle, cargo_subtype % 4) {2:ss_mid_e2_series_cab02f_pnk; 3:ss_mid_e2_series_cab02f_200; 0:ss_mid_e2_series_cab02f_2cc; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab02f_mask, cargo_subtype) {0:ss_mid_e2_series_cab02f_ydp; ss_mid_e2_series_cab02f_cycle; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab02f_red, HideLongSprite() ) { 0: ss_std_e2_series_cab02f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_cab02f_ydp, build_year) {2002..9999: ss_std_e2_series_cab02f_pnk; }
                switch(FEAT_TRAINS, PARENT, ss_std_e2_series_cab02f_cycle, cargo_subtype % 4) {2:ss_std_e2_series_cab02f_pnk; 3:ss_std_e2_series_cab02f_200; 0:ss_std_e2_series_cab02f_2cc; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_cab02f_mask, cargo_subtype) {0:ss_std_e2_series_cab02f_ydp; ss_std_e2_series_cab02f_cycle; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab02f_mask, HideLongSprite() ) { 0: ss_std_e2_series_cab02f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_cab02f_red;       	    // Base for Mid
                1: ss_mid_e2_series_cab02f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_cab02f_red;	    // Base for LongSprite
				3: longsprite_e2_series_cab02f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_cab02f_ydp, build_year) {2002..9999: ss_bck_e2_series_cab02f_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab02f_cycle, cargo_subtype % 4) {2:ss_bck_e2_series_cab02f_pnk; 3:ss_bck_e2_series_cab02f_200; 0:ss_bck_e2_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab02f_mask, cargo_subtype) {0:ss_bck_e2_series_cab02f_ydp; ss_bck_e2_series_cab02f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_cab02f_red;       	    // Base for Back
				1: ss_bck_e2_series_cab02f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_cab02f_frt_longsprite;
            1: sw_e2_series_cab02f_mid_stack;
            2: sw_e2_series_cab02f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_cab02b_ydp, build_year) {2002..9999: ss_frt_e2_series_cab02b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_cab02b_mask, cargo_subtype) {0:ss_frt_e2_series_cab02b_ydp; 2:ss_frt_e2_series_cab02b_pnk;  3:ss_frt_e2_series_cab02b_200; 4:ss_frt_e2_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_cab02b_red;       	    // Base for Front
				1: ss_frt_e2_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_cab02b_ydp, build_year) {2002..9999: ss_mid_e2_series_cab02b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_cab02b_mask, cargo_subtype) {0:ss_mid_e2_series_cab02b_ydp; 2:ss_mid_e2_series_cab02b_pnk; 3:ss_mid_e2_series_cab02b_200; 4:ss_mid_e2_series_cab02b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab02b_red, HideLongSprite() ) { 0: ss_std_e2_series_cab02b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_cab02b_ydp, build_year) {2002..9999: ss_std_e2_series_cab02b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_cab02b_mask, cargo_subtype) {0:ss_std_e2_series_cab02b_ydp; 2:ss_std_e2_series_cab02b_pnk; 3:ss_std_e2_series_cab02b_200; 4:ss_std_e2_series_cab02b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_cab02b_mask, HideLongSprite() ) { 0: sw_std_e2_series_cab02b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_cab02b_red;       	    // Base for Mid
                1: ss_mid_e2_series_cab02b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_cab02b_red;	        // Base for LongSprite
				3: longsprite_e2_series_cab02b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_cab02b_ydp, build_year) {2002..9999: ss_bck_e2_series_cab02b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_cab02b_mask, cargo_subtype) {0:ss_bck_e2_series_cab02b_ydp; 2:ss_bck_e2_series_cab02b_pnk; 3:ss_bck_e2_series_cab02b_200; 4:ss_bck_e2_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_cab02b_red;       	    // Base for Back
				1: ss_bck_e2_series_cab02b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e2_series_cab02b_frt_longsprite;
            1: sw_e2_series_cab02b_mid_stack;
            2: sw_e2_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_coac2.pnml" 1

/* coac2 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e2_series_coac2f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_coac2b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_coac2f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_coac2b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_coac2f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_coac2b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_coac2f_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_coac2b_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e2_series_coac2f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_coac2b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_coac2f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_coac2b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_coac2f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_coac2b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_coac2f_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_coac2b_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Pink Stripe

    // 10/8
	spriteset(ss_std_e2_series_coac2f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_coac2b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_coac2f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_coac2b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_coac2f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_coac2b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_coac2f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_coac2b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_rev(1,101)}

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_coac2f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_coac2b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_coac2f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_coac2b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_coac2f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_coac2b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_coac2f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_coac2b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,101)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac2f_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac2f_cycle, cargo_subtype % 4) {2:ss_frt_e2_series_coac2f_pnk; 3:ss_frt_e2_series_coac2f_200; 0:ss_frt_e2_series_coac2f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac2f_mask, cargo_subtype) {0:ss_frt_e2_series_coac2f_ydp; ss_frt_e2_series_coac2f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2f_red;       	    // Base for Front
				1: ss_frt_e2_series_coac2f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2f_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_coac2f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac2f_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2f_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac2f_cycle, cargo_subtype % 4) {2:ss_mid_e2_series_coac2f_pnk; 3:ss_mid_e2_series_coac2f_200; 0:ss_mid_e2_series_coac2f_2cc; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac2f_mask, cargo_subtype) {0:ss_mid_e2_series_coac2f_ydp; ss_mid_e2_series_coac2f_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac2f_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac2f_ydp, build_year) {2002..9999: ss_std_e2_series_coac2f_pnk; }
                switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac2f_cycle, cargo_subtype % 4) {2:ss_std_e2_series_coac2f_pnk; 3:ss_std_e2_series_coac2f_200; 0:ss_std_e2_series_coac2f_2cc; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac2f_mask, cargo_subtype) {0:ss_std_e2_series_coac2f_ydp; ss_std_e2_series_coac2f_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac2f_mask, HideLongSprite() ) { 0: ss_std_e2_series_coac2f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2f_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac2f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac2f_red;	    // Base for LongSprite
				3: longsprite_e2_series_coac2f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac2f_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac2f_cycle, cargo_subtype % 4) {2:ss_bck_e2_series_coac2f_pnk; 3:ss_bck_e2_series_coac2f_200; 0:ss_bck_e2_series_coac2f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac2f_mask, cargo_subtype) {0:ss_bck_e2_series_coac2f_ydp; ss_bck_e2_series_coac2f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2f_red;       	    // Base for Back
				1: ss_bck_e2_series_coac2f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2f_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac2f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac2f, position_in_consist % 3 ) {				
            0: sw_e2_series_coac2f_frt_longsprite;
            1: sw_e2_series_coac2f_mid_stack;
            2: sw_e2_series_coac2f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac2b_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac2b_mask, cargo_subtype) {0:ss_frt_e2_series_coac2b_ydp; 2:ss_frt_e2_series_coac2b_pnk;  3:ss_frt_e2_series_coac2b_200; 4:ss_frt_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2b_red;       	    // Base for Front
				1: ss_frt_e2_series_coac2b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2b_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac2b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac2b_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac2b_mask, cargo_subtype) {0:ss_mid_e2_series_coac2b_ydp; 2:ss_mid_e2_series_coac2b_pnk; 3:ss_mid_e2_series_coac2b_200; 4:ss_mid_e2_series_coac2b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac2b_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac2b_ydp, build_year) {2002..9999: ss_std_e2_series_coac2b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_coac2b_mask, cargo_subtype) {0:ss_std_e2_series_coac2b_ydp; 2:ss_std_e2_series_coac2b_pnk; 3:ss_std_e2_series_coac2b_200; 4:ss_std_e2_series_coac2b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac2b_mask, HideLongSprite() ) { 0: sw_std_e2_series_coac2b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2b_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac2b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac2b_red;	        // Base for LongSprite
				3: longsprite_e2_series_coac2b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac2b_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac2b_mask, cargo_subtype) {0:ss_bck_e2_series_coac2b_ydp; 2:ss_bck_e2_series_coac2b_pnk; 3:ss_bck_e2_series_coac2b_200; 4:ss_bck_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2b_red;       	    // Base for Back
				1: ss_bck_e2_series_coac2b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac2b_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_coac2b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac2b, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_coac2b_frt_longsprite;
            1: sw_e2_series_coac2b_mid_stack;
            2: sw_e2_series_coac2b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_coac3.pnml" 1

/* coac3 */

// Sprites

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_coac3f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,151)}
	spriteset(ss_std_e2_series_coac3b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,151)}

	// Front
	spriteset(ss_frt_e2_series_coac3f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,151)}
	spriteset(ss_frt_e2_series_coac3b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,151)}
	// Mid
	spriteset(ss_mid_e2_series_coac3f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,151)}
	spriteset(ss_mid_e2_series_coac3b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,151)}
	// Back
	spriteset(ss_bck_e2_series_coac3f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,151)}
	spriteset(ss_bck_e2_series_coac3b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,151)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac3f_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac3f_cycle, cargo_subtype % 4) {3:ss_frt_e2_series_coac3f_200;}
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac3f_mask, cargo_subtype) {0:ss_frt_e2_series_coac3f_ydp; ss_frt_e2_series_coac3f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2f_red;       	    // Base for Front
				1: ss_frt_e2_series_coac3f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3f_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_coac3f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac3f_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2f_pnk; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac3f_cycle, cargo_subtype % 4) {3:ss_mid_e2_series_coac3f_200;}
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac3f_mask, cargo_subtype) {0:ss_mid_e2_series_coac3f_ydp; ss_mid_e2_series_coac3f_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac3f_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac3f_ydp, build_year) {2002..9999: ss_std_e2_series_coac2f_pnk; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac3f_cycle, cargo_subtype % 4) {3:ss_std_e2_series_coac3f_200;}
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac3f_mask, cargo_subtype) {0:ss_std_e2_series_coac3f_ydp; ss_std_e2_series_coac3f_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac3f_mask, HideLongSprite() ) { 0: ss_std_e2_series_coac3f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2f_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac3f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac3f_red;	    // Base for LongSprite
				3: longsprite_e2_series_coac3f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac3f_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac3f_cycle, cargo_subtype % 4) {3:ss_bck_e2_series_coac3f_200;}
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac3f_mask, cargo_subtype) {0:ss_bck_e2_series_coac3f_ydp; ss_bck_e2_series_coac3f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2f_red;       	    // Base for Back
				1: ss_bck_e2_series_coac3f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3f_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac3f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac3f, position_in_consist % 3 ) {				
            0: sw_e2_series_coac3f_frt_longsprite;
            1: sw_e2_series_coac3f_mid_stack;
            2: sw_e2_series_coac3f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac3b_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac3b_mask, cargo_subtype) {0:ss_frt_e2_series_coac3b_ydp; 2:ss_frt_e2_series_coac2b_pnk;  3:ss_frt_e2_series_coac3b_200; 4:ss_frt_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2b_red;       	    // Base for Front
				1: ss_frt_e2_series_coac3b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3b_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac3b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac3b_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac3b_mask, cargo_subtype) {0:ss_mid_e2_series_coac3b_ydp; 2:ss_mid_e2_series_coac2b_pnk; 3:ss_mid_e2_series_coac3b_200; 4:ss_mid_e2_series_coac2b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac3b_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac3b_ydp, build_year) {2002..9999: ss_std_e2_series_coac2b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_coac3b_mask, cargo_subtype) {0:ss_std_e2_series_coac3b_ydp; 2:ss_std_e2_series_coac2b_pnk; 3:ss_std_e2_series_coac3b_200; 4:ss_std_e2_series_coac2b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac3b_mask, HideLongSprite() ) { 0: sw_std_e2_series_coac3b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2b_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac3b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac3b_red;	        // Base for LongSprite
				3: longsprite_e2_series_coac3b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac3b_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac3b_mask, cargo_subtype) {0:ss_bck_e2_series_coac3b_ydp; 2:ss_bck_e2_series_coac2b_pnk; 3:ss_bck_e2_series_coac3b_200; 4:ss_bck_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2b_red;       	    // Base for Back
				1: ss_bck_e2_series_coac3b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac3b_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_coac3b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac3b, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_coac3b_frt_longsprite;
            1: sw_e2_series_coac3b_mid_stack;
            2: sw_e2_series_coac3b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_coac4.pnml" 1

/* coac4 */

// Sprites

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_coac4f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,201)}
	spriteset(ss_std_e2_series_coac4b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,201)}

	// Front
	spriteset(ss_frt_e2_series_coac4f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,201)}
	spriteset(ss_frt_e2_series_coac4b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,201)}
	// Mid
	spriteset(ss_mid_e2_series_coac4f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,201)}
	spriteset(ss_mid_e2_series_coac4b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,201)}
	// Back
	spriteset(ss_bck_e2_series_coac4f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,201)}
	spriteset(ss_bck_e2_series_coac4b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,201)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac4f_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac4f_cycle, cargo_subtype % 4) {3:ss_frt_e2_series_coac4f_200;}
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac4f_mask, cargo_subtype) {0:ss_frt_e2_series_coac4f_ydp; ss_frt_e2_series_coac4f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2f_red;       	    // Base for Front
				1: ss_frt_e2_series_coac4f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4f_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_coac4f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac4f_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2f_pnk; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac4f_cycle, cargo_subtype % 4) {3:ss_mid_e2_series_coac4f_200;}
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac4f_mask, cargo_subtype) {0:ss_mid_e2_series_coac4f_ydp; ss_mid_e2_series_coac4f_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac4f_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac4f_ydp, build_year) {2002..9999: ss_std_e2_series_coac2f_pnk; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac4f_cycle, cargo_subtype % 4) {3:ss_std_e2_series_coac4f_200;}
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac4f_mask, cargo_subtype) {0:ss_std_e2_series_coac4f_ydp; ss_std_e2_series_coac4f_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac4f_mask, HideLongSprite() ) { 0: ss_std_e2_series_coac4f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2f_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac4f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac4f_red;	    // Base for LongSprite
				3: longsprite_e2_series_coac4f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac4f_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac4f_cycle, cargo_subtype % 4) {3:ss_bck_e2_series_coac4f_200;}
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac4f_mask, cargo_subtype) {0:ss_bck_e2_series_coac4f_ydp; ss_bck_e2_series_coac4f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2f_red;       	    // Base for Back
				1: ss_bck_e2_series_coac4f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4f_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac4f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac4f, position_in_consist % 3 ) {				
            0: sw_e2_series_coac4f_frt_longsprite;
            1: sw_e2_series_coac4f_mid_stack;
            2: sw_e2_series_coac4f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac4b_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac4b_mask, cargo_subtype) {0:ss_frt_e2_series_coac4b_ydp; 2:ss_frt_e2_series_coac2b_pnk;  3:ss_frt_e2_series_coac4b_200; 4:ss_frt_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2b_red;       	    // Base for Front
				1: ss_frt_e2_series_coac4b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4b_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac4b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac4b_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac4b_mask, cargo_subtype) {0:ss_mid_e2_series_coac4b_ydp; 2:ss_mid_e2_series_coac2b_pnk; 3:ss_mid_e2_series_coac4b_200; 4:ss_mid_e2_series_coac2b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac4b_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac4b_ydp, build_year) {2002..9999: ss_std_e2_series_coac2b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_coac4b_mask, cargo_subtype) {0:ss_std_e2_series_coac4b_ydp; 2:ss_std_e2_series_coac2b_pnk; 3:ss_std_e2_series_coac4b_200; 4:ss_std_e2_series_coac2b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac4b_mask, HideLongSprite() ) { 0: sw_std_e2_series_coac4b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2b_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac4b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac4b_red;	        // Base for LongSprite
				3: longsprite_e2_series_coac4b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac4b_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac4b_mask, cargo_subtype) {0:ss_bck_e2_series_coac4b_ydp; 2:ss_bck_e2_series_coac2b_pnk; 3:ss_bck_e2_series_coac4b_200; 4:ss_bck_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2b_red;       	    // Base for Back
				1: ss_bck_e2_series_coac4b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac4b_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_coac4b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac4b, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_coac4b_frt_longsprite;
            1: sw_e2_series_coac4b_mid_stack;
            2: sw_e2_series_coac4b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_coac6.pnml" 1

/* coac6 */

// Sprites

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_coac6f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,301)}
	spriteset(ss_std_e2_series_coac6b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,301)}

	// Front
	spriteset(ss_frt_e2_series_coac6f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,301)}
	spriteset(ss_frt_e2_series_coac6b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,301)}
	// Mid
	spriteset(ss_mid_e2_series_coac6f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,301)}
	spriteset(ss_mid_e2_series_coac6b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,301)}
	// Back
	spriteset(ss_bck_e2_series_coac6f_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,301)}
	spriteset(ss_bck_e2_series_coac6b_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,301)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac6f_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac6f_cycle, cargo_subtype % 4) {3:ss_frt_e2_series_coac6f_200;}
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac6f_mask, cargo_subtype) {0:ss_frt_e2_series_coac6f_ydp; ss_frt_e2_series_coac6f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2f_red;       	    // Base for Front
				1: ss_frt_e2_series_coac6f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6f_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_coac6f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac6f_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2f_pnk; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac6f_cycle, cargo_subtype % 4) {3:ss_mid_e2_series_coac6f_200;}
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac6f_mask, cargo_subtype) {0:ss_mid_e2_series_coac6f_ydp; ss_mid_e2_series_coac6f_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac6f_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2f_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac6f_ydp, build_year) {2002..9999: ss_std_e2_series_coac2f_pnk; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac6f_cycle, cargo_subtype % 4) {3:ss_std_e2_series_coac6f_200;}
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_coac6f_mask, cargo_subtype) {0:ss_std_e2_series_coac6f_ydp; ss_std_e2_series_coac6f_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac6f_mask, HideLongSprite() ) { 0: ss_std_e2_series_coac6f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2f_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac6f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac6f_red;	    // Base for LongSprite
				3: longsprite_e2_series_coac6f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac6f_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac6f_cycle, cargo_subtype % 4) {3:ss_bck_e2_series_coac6f_200;}
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac6f_mask, cargo_subtype) {0:ss_bck_e2_series_coac6f_ydp; ss_bck_e2_series_coac6f_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2f_red;       	    // Base for Back
				1: ss_bck_e2_series_coac6f_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6f_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac6f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac6f, position_in_consist % 3 ) {				
            0: sw_e2_series_coac6f_frt_longsprite;
            1: sw_e2_series_coac6f_mid_stack;
            2: sw_e2_series_coac6f_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_coac6b_ydp, build_year) {2002..9999: ss_frt_e2_series_coac2b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_coac6b_mask, cargo_subtype) {0:ss_frt_e2_series_coac6b_ydp; 2:ss_frt_e2_series_coac2b_pnk;  3:ss_frt_e2_series_coac6b_200; 4:ss_frt_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_coac2b_red;       	    // Base for Front
				1: ss_frt_e2_series_coac6b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6b_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_coac6b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_coac6b_ydp, build_year) {2002..9999: ss_mid_e2_series_coac2b_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_coac6b_mask, cargo_subtype) {0:ss_mid_e2_series_coac6b_ydp; 2:ss_mid_e2_series_coac2b_pnk; 3:ss_mid_e2_series_coac6b_200; 4:ss_mid_e2_series_coac2b_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac6b_red, HideLongSprite() ) { 0: ss_std_e2_series_coac2b_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_coac6b_ydp, build_year) {2002..9999: ss_std_e2_series_coac2b_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_coac6b_mask, cargo_subtype) {0:ss_std_e2_series_coac6b_ydp; 2:ss_std_e2_series_coac2b_pnk; 3:ss_std_e2_series_coac6b_200; 4:ss_std_e2_series_coac2b_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_coac6b_mask, HideLongSprite() ) { 0: sw_std_e2_series_coac6b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_coac2b_red;       	    // Base for Mid
                1: ss_mid_e2_series_coac6b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_coac6b_red;	        // Base for LongSprite
				3: longsprite_e2_series_coac6b_mask;        // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_coac6b_ydp, build_year) {2002..9999: ss_bck_e2_series_coac2b_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_coac6b_mask, cargo_subtype) {0:ss_bck_e2_series_coac6b_ydp; 2:ss_bck_e2_series_coac2b_pnk; 3:ss_bck_e2_series_coac6b_200; 4:ss_bck_e2_series_coac2b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_coac2b_red;       	    // Base for Back
				1: ss_bck_e2_series_coac6b_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_coac6b_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_coac6b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_coac6b, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_coac6b_frt_longsprite;
            1: sw_e2_series_coac6b_mid_stack;
            2: sw_e2_series_coac6b_bck_longsprite;
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e2_series_pantof_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_pantob_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_pantof_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_pantob_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_pantof_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_pantob_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_pantof_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_pantob_red, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_red.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e2_series_pantof_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_pantob_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_pantof_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_pantob_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_pantof_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_pantob_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_pantof_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_pantob_2cc, "src/trains/e2_series/gfx/e2_series_2cc.png") {tmpl_bck_rev(1,101)}

    // Pink Stripe

    // 10/8
	spriteset(ss_std_e2_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e2_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e2_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e2_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e2_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e2_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e2_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e2_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_pnk.png") {tmpl_bck_rev(1,101)}

    // 200 Series Livery

	// 10/8
	spriteset(ss_std_e2_series_pantof_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_std(1,251)}
	spriteset(ss_std_e2_series_pantob_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_10_rev(1,251)}

	// Front
	spriteset(ss_frt_e2_series_pantof_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_std(1,251)}
	spriteset(ss_frt_e2_series_pantob_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_frt_rev(1,251)}
	// Mid
	spriteset(ss_mid_e2_series_pantof_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_std(1,251)}
	spriteset(ss_mid_e2_series_pantob_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_mid_rev(1,251)}
	// Back
	spriteset(ss_bck_e2_series_pantof_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_std(1,251)}
	spriteset(ss_bck_e2_series_pantob_200, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2_series/gfx/e2_series_200.png") {tmpl_bck_rev(1,251)}


// Sprite Selection

	// Forwards

		// Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_pantof_ydp, build_year) {2002..9999: ss_frt_e2_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_pantof_cycle, cargo_subtype % 4) {2:ss_frt_e2_series_pantof_pnk; 3:ss_frt_e2_series_pantof_200; 0:ss_frt_e2_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_pantof_mask, cargo_subtype) {0:ss_frt_e2_series_pantof_ydp; ss_frt_e2_series_pantof_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_pantof_red;       	    // Base for Front
				1: ss_frt_e2_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e2_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_pantof_ydp, build_year) {2002..9999: ss_mid_e2_series_pantof_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_pantof_cycle, cargo_subtype % 4) {2:ss_mid_e2_series_pantof_pnk; 3:ss_mid_e2_series_pantof_200; 0:ss_mid_e2_series_pantof_2cc; }
			switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_pantof_mask, cargo_subtype) {0:ss_mid_e2_series_pantof_ydp; ss_mid_e2_series_pantof_cycle; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_pantof_red, HideLongSprite() ) { 0: ss_std_e2_series_pantof_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_pantof_ydp, build_year) {2002..9999: ss_std_e2_series_pantof_pnk; }
                switch(FEAT_TRAINS, PARENT, ss_std_e2_series_pantof_cycle, cargo_subtype % 4) {2:ss_std_e2_series_pantof_pnk; 3:ss_std_e2_series_pantof_200; 0:ss_std_e2_series_pantof_2cc; }
				switch(FEAT_TRAINS, PARENT, ss_std_e2_series_pantof_mask, cargo_subtype) {0:ss_std_e2_series_pantof_ydp; ss_std_e2_series_pantof_cycle; }

                switch(FEAT_TRAINS, SELF, longsprite_e2_series_pantof_mask, HideLongSprite() ) { 0: ss_std_e2_series_pantof_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_pantof_red;       	    // Base for Mid
                1: ss_mid_e2_series_pantof_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_pantof_red;	    // Base for LongSprite
				3: longsprite_e2_series_pantof_mask;       // Masks for LongSprite
				 // Pantos
                4: panto_midsprite_e2_f;
                5: panto_longsprite_e2_f;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_pantof_ydp, build_year) {2002..9999: ss_bck_e2_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_pantof_cycle, cargo_subtype % 4) {2:ss_bck_e2_series_pantof_pnk; 3:ss_bck_e2_series_pantof_200; 0:ss_bck_e2_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_pantof_mask, cargo_subtype) {0:ss_bck_e2_series_pantof_ydp; ss_bck_e2_series_pantof_cycle; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_pantof_red;       	    // Base for Back
				1: ss_bck_e2_series_pantof_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e2_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_pantof, position_in_consist % 3 ) {				
            0: sw_e2_series_pantof_frt_longsprite;
            1: sw_e2_series_pantof_mid_stack;
            2: sw_e2_series_pantof_bck_longsprite;
        }

	// Backwards

        // Front
        switch(FEAT_TRAINS, SELF, ss_frt_e2_series_pantob_ydp, build_year) {2002..9999: ss_frt_e2_series_pantob_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e2_series_pantob_mask, cargo_subtype) {0:ss_frt_e2_series_pantob_ydp; 2:ss_frt_e2_series_pantob_pnk;  3:ss_frt_e2_series_pantob_200; 4:ss_frt_e2_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e2_series_pantob_red;       	    // Base for Front
				1: ss_frt_e2_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e2_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, SELF, ss_mid_e2_series_pantob_ydp, build_year) {2002..9999: ss_mid_e2_series_pantob_pnk; }
		    switch(FEAT_TRAINS, PARENT, ss_mid_e2_series_pantob_mask, cargo_subtype) {0:ss_mid_e2_series_pantob_ydp; 2:ss_mid_e2_series_pantob_pnk; 3:ss_mid_e2_series_pantob_200; 4:ss_mid_e2_series_pantob_2cc; }
		
        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_pantob_red, HideLongSprite() ) { 0: ss_std_e2_series_pantob_red; }
            // Masks
                switch(FEAT_TRAINS, SELF, ss_std_e2_series_pantob_ydp, build_year) {2002..9999: ss_std_e2_series_pantob_pnk; }
                switch(FEAT_TRAINS, PARENT, sw_std_e2_series_pantob_mask, cargo_subtype) {0:ss_std_e2_series_pantob_ydp; 2:ss_std_e2_series_pantob_pnk; 3:ss_std_e2_series_pantob_200; 4:ss_std_e2_series_pantob_2cc; }
                
                switch(FEAT_TRAINS, SELF, longsprite_e2_series_pantob_mask, HideLongSprite() ) { 0: sw_std_e2_series_pantob_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e2_series_pantob_red;       	    // Base for Mid
                1: ss_mid_e2_series_pantob_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e2_series_pantob_red;	        // Base for LongSprite
				3: longsprite_e2_series_pantob_mask;        // Masks for LongSprite
				 // Pantos
                4: panto_midsprite_e2_b;
                5: panto_longsprite_e2_b;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e2_series_pantob_ydp, build_year) {2002..9999: ss_bck_e2_series_pantob_pnk; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e2_series_pantob_mask, cargo_subtype) {0:ss_bck_e2_series_pantob_ydp; 2:ss_bck_e2_series_pantob_pnk; 3:ss_bck_e2_series_pantob_200; 4:ss_bck_e2_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e2_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e2_series_pantob_red;       	    // Base for Back
				1: ss_bck_e2_series_pantob_mask;		    // Masks for Back
			}

		switch(FEAT_TRAINS, SELF, sw_e2_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e2_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e2_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e2_series_pantob_frt_longsprite;
            1: sw_e2_series_pantob_mid_stack;
            2: sw_e2_series_pantob_bck_longsprite;
        }



# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_formations.pnml" 1




// 200 Series Livery

         switch (FEAT_TRAINS, SELF, sw_e2_series_200_backwards, ( CarNumberFromEnd() - 2 ) % 8 ) {				
            0: sw_e2_series_coac2b;     // 2
            1: sw_e2_series_coac3b;     // 4
            3: sw_e2_series_coac4b;     // 5
            5: sw_e2_series_coac6b;     // 7
            6: sw_e2_series_coac4b;     // 8
            7: sw_e2_series_coac3b;     // 9
            sw_e2_series_pantob;	    // 3 & 6		
        }
        
        switch (FEAT_TRAINS, SELF, sw_e2_series_200_forwards, ( CarNumber() - 2 ) % 8 ) {				
            0: sw_e2_series_coac2f;     // 2
            1: sw_e2_series_coac3f;     // 4
            3: sw_e2_series_coac4f;     // 5
            5: sw_e2_series_coac6f;     // 7
            6: sw_e2_series_coac4f;     // 8
            7: sw_e2_series_coac3f;     // 9
            sw_e2_series_pantof;	    // 3 & 6		
        }

// Standard Formations

    // Panto in middle

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_panto_in_middle_backwards, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e2_series_pantob;
            sw_e2_series_coac2b;				
        }

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_panto_in_middle_forwards, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e2_series_pantof;
            sw_e2_series_coac2f;				
        }

    // 4th and 6th

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_4th_and_6th_forwards, CarNumber() == 4 || CarNumber()  == 6 ) {				
                0:  sw_e2_series_coac2f;
                sw_e2_series_pantof;				
            }

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_4th_and_6th_backwards, CarNumberFromEnd() == 4 || CarNumberFromEnd()  == 6 ) {				
                0:  sw_e2_series_coac2b;
                sw_e2_series_pantob;				
            }

    // 4th and 5th from end

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_4th_and_5_from_end_forwards, CarNumber() == 4 || CarNumberFromEnd()  == 5 ) {				
                0:  sw_e2_series_coac2f;
                sw_e2_series_pantof;				
            }

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_4th_and_5_from_end_backwards, CarNumberFromEnd() == 4 || CarNumber()  == 5 ) {				
                0:  sw_e2_series_coac2b;
                sw_e2_series_pantob;				
            }

    // Length Check
        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_lengthcheck_backwards, num_vehs_in_consist ) {				
                1..23:  sw_e2_series_standard_panto_in_middle_backwards;
                24..30: sw_e2_series_standard_4th_and_6th_backwards;
                sw_e2_series_standard_4th_and_5_from_end_backwards;				
            }

        switch (FEAT_TRAINS, SELF, sw_e2_series_standard_lengthcheck_forwards, num_vehs_in_consist ) {				
                1..23:  sw_e2_series_standard_panto_in_middle_forwards;
                24..30: sw_e2_series_standard_4th_and_6th_forwards;
                sw_e2_series_standard_4th_and_5_from_end_forwards;				
            }


/* Midcar Direction Switches */

    switch (FEAT_TRAINS, PARENT, sw_e2_series_200_midcars, vehicle_is_reversed) {				
			1:  sw_e2_series_200_backwards;
			sw_e2_series_200_forwards;					
		}

    switch (FEAT_TRAINS, PARENT, sw_e2_series_standard_midcars, vehicle_is_reversed) {				
			1:  sw_e2_series_standard_lengthcheck_backwards;
			sw_e2_series_standard_lengthcheck_forwards;				
		}

    switch (FEAT_TRAINS, PARENT, sw_e2_series_midcars, cargo_subtype) {				
			3:  sw_e2_series_200_midcars;
			sw_e2_series_standard_midcars;				
		}

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e2_series_rear, vehicle_is_reversed) {				
            1: sw_e2_series_cab01b;
            sw_e2_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e2_series_lead, vehicle_is_reversed) {				
            1: sw_e2_series_cab02b;
            sw_e2_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e2_series_cabs, position_in_consist) {				
            0..2: sw_e2_series_lead;
            sw_e2_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e2_series_graphics, IsCab() ) {				
            1:  sw_e2_series_cabs;
            sw_e2_series_midcars;	
        }
# 1 "src/trains/e2_series/e2_series.pnml" 2
# 1 "src/trains/e2_series/e2_series_item.pnml" 1

// Articulation
switch (FEAT_TRAINS, SELF, sw_e2_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_e2;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_e2) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E2_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,22);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          275 km/h;				    // Operational Top Speed
		power:                          8050 kW;                    // Overwritten by callback					
		weight:                         648 tons;                   // Overwritten by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E2_SERIES);
		cargo_subtype_text:				sw_e2_series_subtype_text;
        can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
        purchase_weight:                46;
        purchase_power:                 402 * 4;
		/* Graphics */
        default:                        sw_e2_series_graphics;
		purchase:                       sw_e2_series_purchase;
		articulated_part:               sw_e2_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        power:                          max((NumberCarsInConsist() - 2 ),0) * 402 * 4;
        weight:                        	NumberCarsInConsist() * 46;
		cargo_capacity:                 27 * CapacityFactor();										// 815 capacity / (10 cars * 3 parts) is approx 27						
		loading_speed:					27 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            (290 + 120 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   290 + 120 * NumberCarsInConsist();	
	}

	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e2_series_graphics;
        cargo_capacity:                 27 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:					27 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e2_series_running_costs;
      }
}
# 1 "src/trains/e2_series/e2_series.pnml" 2

# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e3_series/e3_series.pnml" 1

# 1 "src/trains/e3_series/e3_series_menu.pnml" 1
/* SUBTYPES */

	// Pre 1997 subtype text
	switch(FEAT_TRAINS, SELF, sw_e3_series_1997_livery_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
		1: return string(LV_E3_SERIES_R);
        2: return string(LV_E3_SERIES_R_2CC);
		return CB_RESULT_NO_TEXT;
		}

	// Post 1999 subtype text
	switch(FEAT_TRAINS, SELF, sw_e3_series_1999_livery_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
		1: return string(LV_E3_SERIES_R);
        2: return string(LV_E3_SERIES_R_2CC);
		3: return string(LV_E3_SERIES_1000);
        4: return string(LV_E3_SERIES_1000_2CC);
		return CB_RESULT_NO_TEXT;
		}

  // Post 2008 subtype text
	switch(FEAT_TRAINS, SELF, sw_e3_series_2008_livery_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
		1: return string(LV_E3_SERIES_R);
        2: return string(LV_E3_SERIES_R_2CC);
		3: return string(LV_E3_SERIES_1000);
        4: return string(LV_E3_SERIES_1000_2CC);
        5: return string(LV_E3_SERIES_2000);
        6: return string(LV_E3_SERIES_2000_2CC);
		return CB_RESULT_NO_TEXT;
		}

  // Post 2014 subtype text
	switch(FEAT_TRAINS, SELF, sw_e3_series_2014_livery_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
		1: return string(LV_E3_SERIES_R);
        2: return string(LV_E3_SERIES_R_2CC);
		3: return string(LV_E3_SERIES_1000);
        4: return string(LV_E3_SERIES_1000_2CC);
        5: return string(LV_E3_SERIES_2000);
        6: return string(LV_E3_SERIES_2000_2CC);
        7: return string(LV_E3_SERIES_700_TOREIYU);
		return CB_RESULT_NO_TEXT;
		}

	switch(FEAT_TRAINS, SELF, sw_e3_series_year_dep_subtype_text, current_year) {
		0..1998: sw_e3_series_1997_livery_subtype_text;
        1999..2007: sw_e3_series_1999_livery_subtype_text;
        2008..2013: sw_e3_series_2008_livery_subtype_text;
		sw_e3_series_2014_livery_subtype_text;
	}

/* Purchase Menu */
    spriteset (ss_e3_series_r_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {template_purchase(233, 1)}
	spriteset (ss_e3_series_1000_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {template_purchase(233, 1)}
	spriteset (ss_e3_series_2000_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, ss_e3_series_buy, current_year) {
		0..1998: ss_e3_series_r_buy;
        1999..2007: ss_e3_series_1000_buy;
		ss_e3_series_2000_buy;
	}

	switch(FEAT_TRAINS, SELF, sw_e3_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e3_series_buy;
        }
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_cab01.pnml" 1
/* cab01 */

spriteset(ss_mid_e3_series_cab01f_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e3_series_cab01f_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e3_series_cab01b_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,51)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab01f_yeardep, build_year) {0..1998:ss_mid_e3_series_cab01f_rrr; 1999..2007:ss_mid_e3_series_cab01f_1kk; ss_mid_e3_series_cab01f_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color_203, cargo_subtype) {1:ss_mid_e3_series_cab01f_r2c; 4:ss_mid_e3_series_cab01f_1k2; 7:ss_mid_e3_series_cab01f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_cab01f_rrr; 3..5:ss_mid_e3_series_cab01f_1kk; 6..8:ss_mid_e3_series_cab01f_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color_1553, cargo_subtype) {4:ss_mid_e3_series_cab01f_r2c; 8:ss_mid_e3_series_cab01f_1k2; 12:ss_mid_e3_series_cab01f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape_1553, cargo_subtype) {0:sw_e3_series_cab01f_yeardep; 1..4:ss_mid_e3_series_cab01f_rrr; 5..8:ss_mid_e3_series_cab01f_1kk; 9..12:ss_mid_e3_series_cab01f_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color_2043, cargo_subtype) {3:ss_mid_e3_series_cab01f_r2c; 6:ss_mid_e3_series_cab01f_1k2; 9:ss_mid_e3_series_cab01f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape_2043, cargo_subtype) {0:sw_e3_series_cab01f_yeardep; 1..3:ss_mid_e3_series_cab01f_rrr; 4..6:ss_mid_e3_series_cab01f_1kk; 7..9:ss_mid_e3_series_cab01f_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color_2053, cargo_subtype) {2:ss_mid_e3_series_cab01f_r2c; 5:ss_mid_e3_series_cab01f_1k2; 8:ss_mid_e3_series_cab01f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_cab01f_rrr; 3..5:ss_mid_e3_series_cab01f_1kk; 6..8:ss_mid_e3_series_cab01f_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color_2003, cargo_subtype) {2:ss_mid_e3_series_cab01f_r2c; 4:ss_mid_e3_series_cab01f_1k2; 6:ss_mid_e3_series_cab01f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape_2003, cargo_subtype) {0:sw_e3_series_cab01f_yeardep; 1..2:ss_mid_e3_series_cab01f_rrr; 3..4:ss_mid_e3_series_cab01f_1kk; 5..6:ss_mid_e3_series_cab01f_2kk; 7:ss_mid_e3_series_cab01f_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_color, vehicle_type_id) {2003:ss_mid_e3_series_cab01f_color_2003; 2053:ss_mid_e3_series_cab01f_color_2053; 2043:ss_mid_e3_series_cab01f_color_2043; 1553:ss_mid_e3_series_cab01f_color_1553; 203:ss_mid_e3_series_cab01f_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01f_shape, vehicle_type_id) {2003:ss_mid_e3_series_cab01f_shape_2003; 2053:ss_mid_e3_series_cab01f_shape_2053; 2043:ss_mid_e3_series_cab01f_shape_2043; 1553:ss_mid_e3_series_cab01f_shape_1553; 203:ss_mid_e3_series_cab01f_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab01f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_cab01f_shape;		// Mask for Mid
                1: ss_mid_e3_series_cab01f_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01b_color, cargo_subtype) {2:ss_mid_e3_series_cab01b_r2c; 4:ss_mid_e3_series_cab01b_1k2; 6:ss_mid_e3_series_cab01b_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_cab01b_yeardep, build_year) {0..1998:ss_mid_e3_series_cab01b_rrr; 1999..2007:ss_mid_e3_series_cab01b_1kk; ss_mid_e3_series_cab01b_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab01b_shape, cargo_subtype) {0:sw_e3_series_cab01b_yeardep; 1..2:ss_mid_e3_series_cab01b_rrr; 3..4:ss_mid_e3_series_cab01b_1kk; 5..6:ss_mid_e3_series_cab01b_2kk; 7:ss_mid_e3_series_cab01b_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab01b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_cab01b_shape;		// Mask for Mid
                1: ss_mid_e3_series_cab01b_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_cab02.pnml" 1
/* cab02 */

spriteset(ss_mid_e3_series_cab02f_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e3_series_cab02f_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e3_series_cab02b_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_cab_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab02f_yeardep, build_year) {0..1998:ss_mid_e3_series_cab02f_rrr; 1999..2007:ss_mid_e3_series_cab02f_1kk; ss_mid_e3_series_cab02f_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color_203, cargo_subtype) {1:ss_mid_e3_series_cab02f_r2c; 4:ss_mid_e3_series_cab02f_1k2; 7:ss_mid_e3_series_cab02f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_cab02f_rrr; 3..5:ss_mid_e3_series_cab02f_1kk; 6..8:ss_mid_e3_series_cab02f_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color_1553, cargo_subtype) {4:ss_mid_e3_series_cab02f_r2c; 8:ss_mid_e3_series_cab02f_1k2; 12:ss_mid_e3_series_cab02f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape_1553, cargo_subtype) {0:sw_e3_series_cab02f_yeardep; 1..4:ss_mid_e3_series_cab02f_rrr; 5..8:ss_mid_e3_series_cab02f_1kk; 9..12:ss_mid_e3_series_cab02f_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color_2043, cargo_subtype) {3:ss_mid_e3_series_cab02f_r2c; 6:ss_mid_e3_series_cab02f_1k2; 9:ss_mid_e3_series_cab02f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape_2043, cargo_subtype) {0:sw_e3_series_cab02f_yeardep; 1..3:ss_mid_e3_series_cab02f_rrr; 4..6:ss_mid_e3_series_cab02f_1kk; 7..9:ss_mid_e3_series_cab02f_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color_2053, cargo_subtype) {2:ss_mid_e3_series_cab02f_r2c; 5:ss_mid_e3_series_cab02f_1k2; 8:ss_mid_e3_series_cab02f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_cab02f_rrr; 3..5:ss_mid_e3_series_cab02f_1kk; 6..8:ss_mid_e3_series_cab02f_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color_2003, cargo_subtype) {2:ss_mid_e3_series_cab02f_r2c; 4:ss_mid_e3_series_cab02f_1k2; 6:ss_mid_e3_series_cab02f_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape_2003, cargo_subtype) {0:sw_e3_series_cab02f_yeardep; 1..2:ss_mid_e3_series_cab02f_rrr; 3..4:ss_mid_e3_series_cab02f_1kk; 5..6:ss_mid_e3_series_cab02f_2kk; 7:ss_mid_e3_series_cab02f_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_color, vehicle_type_id) {2003:ss_mid_e3_series_cab02f_color_2003; 2053:ss_mid_e3_series_cab02f_color_2053; 2043:ss_mid_e3_series_cab02f_color_2043; 1553:ss_mid_e3_series_cab02f_color_1553; 203:ss_mid_e3_series_cab02f_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02f_shape, vehicle_type_id) {2003:ss_mid_e3_series_cab02f_shape_2003; 2053:ss_mid_e3_series_cab02f_shape_2053; 2043:ss_mid_e3_series_cab02f_shape_2043; 1553:ss_mid_e3_series_cab02f_shape_1553; 203:ss_mid_e3_series_cab02f_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab02f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_cab02f_shape;		// Mask for Mid
                1: ss_mid_e3_series_cab02f_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02b_color, cargo_subtype) {2:ss_mid_e3_series_cab02b_r2c; 4:ss_mid_e3_series_cab02b_1k2; 6:ss_mid_e3_series_cab02b_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_cab02b_yeardep, build_year) {0..1998:ss_mid_e3_series_cab02b_rrr; 1999..2007:ss_mid_e3_series_cab02b_1kk; ss_mid_e3_series_cab02b_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_cab02b_shape, cargo_subtype) {0:sw_e3_series_cab02b_yeardep; 1..2:ss_mid_e3_series_cab02b_rrr; 3..4:ss_mid_e3_series_cab02b_1kk; 5..6:ss_mid_e3_series_cab02b_2kk; 7:ss_mid_e3_series_cab02b_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_cab02b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_cab02b_shape;		// Mask for Mid
                1: ss_mid_e3_series_cab02b_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_clogo.pnml" 1
/* clogo */

spriteset(ss_mid_e3_series_clogof_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e3_series_clogob_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e3_series_clogof_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_clogob_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,201)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_clogof_yeardep, build_year) {0..1998:ss_mid_e3_series_clogof_rrr; 1999..2007:ss_mid_e3_series_clogof_1kk; ss_mid_e3_series_clogof_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color_203, cargo_subtype) {1:ss_mid_e3_series_clogof_r2c; 4:ss_mid_e3_series_clogof_1k2; 7:ss_mid_e3_series_clogof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_clogof_rrr; 3..5:ss_mid_e3_series_clogof_1kk; 6..8:ss_mid_e3_series_clogof_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color_1553, cargo_subtype) {4:ss_mid_e3_series_clogof_r2c; 8:ss_mid_e3_series_clogof_1k2; 12:ss_mid_e3_series_clogof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape_1553, cargo_subtype) {0:sw_e3_series_clogof_yeardep; 1..4:ss_mid_e3_series_clogof_rrr; 5..8:ss_mid_e3_series_clogof_1kk; 9..12:ss_mid_e3_series_clogof_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color_2043, cargo_subtype) {3:ss_mid_e3_series_clogof_r2c; 6:ss_mid_e3_series_clogof_1k2; 9:ss_mid_e3_series_clogof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape_2043, cargo_subtype) {0:sw_e3_series_clogof_yeardep; 1..3:ss_mid_e3_series_clogof_rrr; 4..6:ss_mid_e3_series_clogof_1kk; 7..9:ss_mid_e3_series_clogof_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color_2053, cargo_subtype) {2:ss_mid_e3_series_clogof_r2c; 5:ss_mid_e3_series_clogof_1k2; 8:ss_mid_e3_series_clogof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_clogof_rrr; 3..5:ss_mid_e3_series_clogof_1kk; 6..8:ss_mid_e3_series_clogof_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color_2003, cargo_subtype) {2:ss_mid_e3_series_clogof_r2c; 4:ss_mid_e3_series_clogof_1k2; 6:ss_mid_e3_series_clogof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape_2003, cargo_subtype) {0:sw_e3_series_clogof_yeardep; 1..2:ss_mid_e3_series_clogof_rrr; 3..4:ss_mid_e3_series_clogof_1kk; 5..6:ss_mid_e3_series_clogof_2kk; 7:ss_mid_e3_series_clogof_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_color, vehicle_type_id) {2003:ss_mid_e3_series_clogof_color_2003; 2053:ss_mid_e3_series_clogof_color_2053; 2043:ss_mid_e3_series_clogof_color_2043; 1553:ss_mid_e3_series_clogof_color_1553; 203:ss_mid_e3_series_clogof_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogof_shape, vehicle_type_id) {2003:ss_mid_e3_series_clogof_shape_2003; 2053:ss_mid_e3_series_clogof_shape_2053; 2043:ss_mid_e3_series_clogof_shape_2043; 1553:ss_mid_e3_series_clogof_shape_1553; 203:ss_mid_e3_series_clogof_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_clogof, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_clogof_shape;		// Mask for Mid
                1: ss_mid_e3_series_clogof_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogob_color, cargo_subtype) {2:ss_mid_e3_series_clogob_r2c; 4:ss_mid_e3_series_clogob_1k2; 6:ss_mid_e3_series_clogob_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_clogob_yeardep, build_year) {0..1998:ss_mid_e3_series_clogob_rrr; 1999..2007:ss_mid_e3_series_clogob_1kk; ss_mid_e3_series_clogob_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clogob_shape, cargo_subtype) {0:sw_e3_series_clogob_yeardep; 1..2:ss_mid_e3_series_clogob_rrr; 3..4:ss_mid_e3_series_clogob_1kk; 5..6:ss_mid_e3_series_clogob_2kk; 7:ss_mid_e3_series_clogob_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_clogob, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_clogob_shape;		// Mask for Mid
                1: ss_mid_e3_series_clogob_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_coach.pnml" 1
/* coach */

spriteset(ss_mid_e3_series_coachf_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_coachb_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_coachf_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_coachb_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_coachf_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_coachb_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_coachf_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_coachb_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_coachf_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_coachb_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_coachf_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_coachb_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_coachf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,401)}
spriteset(ss_mid_e3_series_coachb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,401)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_coachf_yeardep, build_year) {0..1998:ss_mid_e3_series_coachf_rrr; 1999..2007:ss_mid_e3_series_coachf_1kk; ss_mid_e3_series_coachf_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color_203, cargo_subtype) {1:ss_mid_e3_series_coachf_r2c; 4:ss_mid_e3_series_coachf_1k2; 7:ss_mid_e3_series_coachf_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_coachf_rrr; 3..5:ss_mid_e3_series_coachf_1kk; 6..8:ss_mid_e3_series_coachf_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color_1553, cargo_subtype) {4:ss_mid_e3_series_coachf_r2c; 8:ss_mid_e3_series_coachf_1k2; 12:ss_mid_e3_series_coachf_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape_1553, cargo_subtype) {0:sw_e3_series_coachf_yeardep; 1..4:ss_mid_e3_series_coachf_rrr; 5..8:ss_mid_e3_series_coachf_1kk; 9..12:ss_mid_e3_series_coachf_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color_2043, cargo_subtype) {3:ss_mid_e3_series_coachf_r2c; 6:ss_mid_e3_series_coachf_1k2; 9:ss_mid_e3_series_coachf_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape_2043, cargo_subtype) {0:sw_e3_series_coachf_yeardep; 1..3:ss_mid_e3_series_coachf_rrr; 4..6:ss_mid_e3_series_coachf_1kk; 7..9:ss_mid_e3_series_coachf_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color_2053, cargo_subtype) {2:ss_mid_e3_series_coachf_r2c; 5:ss_mid_e3_series_coachf_1k2; 8:ss_mid_e3_series_coachf_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_coachf_rrr; 3..5:ss_mid_e3_series_coachf_1kk; 6..8:ss_mid_e3_series_coachf_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color_2003, cargo_subtype) {2:ss_mid_e3_series_coachf_r2c; 4:ss_mid_e3_series_coachf_1k2; 6:ss_mid_e3_series_coachf_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape_2003, cargo_subtype) {0:sw_e3_series_coachf_yeardep; 1..2:ss_mid_e3_series_coachf_rrr; 3..4:ss_mid_e3_series_coachf_1kk; 5..6:ss_mid_e3_series_coachf_2kk; 7:ss_mid_e3_series_coachf_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_color, vehicle_type_id) {2003:ss_mid_e3_series_coachf_color_2003; 2053:ss_mid_e3_series_coachf_color_2053; 2043:ss_mid_e3_series_coachf_color_2043; 1553:ss_mid_e3_series_coachf_color_1553; 203:ss_mid_e3_series_coachf_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachf_shape, vehicle_type_id) {2003:ss_mid_e3_series_coachf_shape_2003; 2053:ss_mid_e3_series_coachf_shape_2053; 2043:ss_mid_e3_series_coachf_shape_2043; 1553:ss_mid_e3_series_coachf_shape_1553; 203:ss_mid_e3_series_coachf_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_coachf, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_coachf_shape;		// Mask for Mid
                1: ss_mid_e3_series_coachf_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachb_color, cargo_subtype) {2:ss_mid_e3_series_coachb_r2c; 4:ss_mid_e3_series_coachb_1k2; 6:ss_mid_e3_series_coachb_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_coachb_yeardep, build_year) {0..1998:ss_mid_e3_series_coachb_rrr; 1999..2007:ss_mid_e3_series_coachb_1kk; ss_mid_e3_series_coachb_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coachb_shape, cargo_subtype) {0:sw_e3_series_coachb_yeardep; 1..2:ss_mid_e3_series_coachb_rrr; 3..4:ss_mid_e3_series_coachb_1kk; 5..6:ss_mid_e3_series_coachb_2kk; 7:ss_mid_e3_series_coachb_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_coachb, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_coachb_shape;		// Mask for Mid
                1: ss_mid_e3_series_coachb_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_corai.pnml" 1
/* corai */

spriteset(ss_mid_e3_series_coraif_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_coraib_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_rev(1,351)}

spriteset(ss_mid_e3_series_coraif_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_coraib_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,251)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_coraif_yeardep, build_year) {0..1998:ss_mid_e3_series_coraif_rrr; 1999..2007:ss_mid_e3_series_coraif_1kk; ss_mid_e3_series_coraif_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color_203, cargo_subtype) {1:ss_mid_e3_series_coraif_r2c; 4:ss_mid_e3_series_coraif_1k2; 7:ss_mid_e3_series_coraif_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_coraif_rrr; 3..5:ss_mid_e3_series_coraif_1kk; 6..8:ss_mid_e3_series_coraif_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color_1553, cargo_subtype) {4:ss_mid_e3_series_coraif_r2c; 8:ss_mid_e3_series_coraif_1k2; 12:ss_mid_e3_series_coraif_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape_1553, cargo_subtype) {0:sw_e3_series_coraif_yeardep; 1..4:ss_mid_e3_series_coraif_rrr; 5..8:ss_mid_e3_series_coraif_1kk; 9..12:ss_mid_e3_series_coraif_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color_2043, cargo_subtype) {3:ss_mid_e3_series_coraif_r2c; 6:ss_mid_e3_series_coraif_1k2; 9:ss_mid_e3_series_coraif_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape_2043, cargo_subtype) {0:sw_e3_series_coraif_yeardep; 1..3:ss_mid_e3_series_coraif_rrr; 4..6:ss_mid_e3_series_coraif_1kk; 7..9:ss_mid_e3_series_coraif_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color_2053, cargo_subtype) {2:ss_mid_e3_series_coraif_r2c; 5:ss_mid_e3_series_coraif_1k2; 8:ss_mid_e3_series_coraif_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_coraif_rrr; 3..5:ss_mid_e3_series_coraif_1kk; 6..8:ss_mid_e3_series_coraif_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color_2003, cargo_subtype) {2:ss_mid_e3_series_coraif_r2c; 4:ss_mid_e3_series_coraif_1k2; 6:ss_mid_e3_series_coraif_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape_2003, cargo_subtype) {0:sw_e3_series_coraif_yeardep; 1..2:ss_mid_e3_series_coraif_rrr; 3..4:ss_mid_e3_series_coraif_1kk; 5..6:ss_mid_e3_series_coraif_2kk; 7:ss_mid_e3_series_coraif_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_color, vehicle_type_id) {2003:ss_mid_e3_series_coraif_color_2003; 2053:ss_mid_e3_series_coraif_color_2053; 2043:ss_mid_e3_series_coraif_color_2043; 1553:ss_mid_e3_series_coraif_color_1553; 203:ss_mid_e3_series_coraif_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraif_shape, vehicle_type_id) {2003:ss_mid_e3_series_coraif_shape_2003; 2053:ss_mid_e3_series_coraif_shape_2053; 2043:ss_mid_e3_series_coraif_shape_2043; 1553:ss_mid_e3_series_coraif_shape_1553; 203:ss_mid_e3_series_coraif_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_coraif, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_coraif_shape;		// Mask for Mid
                1: ss_mid_e3_series_coraif_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraib_color, cargo_subtype) {2:ss_mid_e3_series_coraib_r2c; 4:ss_mid_e3_series_coraib_1k2; 6:ss_mid_e3_series_coraib_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_coraib_yeardep, build_year) {0..1998:ss_mid_e3_series_coraib_rrr; 1999..2007:ss_mid_e3_series_coraib_1kk; ss_mid_e3_series_coraib_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_coraib_shape, cargo_subtype) {0:sw_e3_series_coraib_yeardep; 1..2:ss_mid_e3_series_coraib_rrr; 3..4:ss_mid_e3_series_coraib_1kk; 5..6:ss_mid_e3_series_coraib_2kk; 7:ss_mid_e3_series_coraib_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_coraib, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_coraib_shape;		// Mask for Mid
                1: ss_mid_e3_series_coraib_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_panto.pnml" 1
/* panto */

spriteset(ss_mid_e3_series_pantof_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_pantob_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_pantof_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_pantob_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_pantof_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_pantob_1kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_1000.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_pantof_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e3_series_pantob_1k2, "src/trains/e3_series/gfx/e3_1000_2cc.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e3_series_pantof_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_pantob_2kk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_2000.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_pantof_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e3_series_pantob_2k2, "src/trains/e3_series/gfx/e3_2000_2cc.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e3_series_pantof_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,351)}
spriteset(ss_mid_e3_series_pantob_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,351)}

// FORWARDS

    switch(FEAT_TRAINS, SELF, sw_e3_series_pantof_yeardep, build_year) {0..1998:ss_mid_e3_series_pantof_rrr; 1999..2007:ss_mid_e3_series_pantof_1kk; ss_mid_e3_series_pantof_2kk;}

    // 200 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color_203, cargo_subtype) {1:ss_mid_e3_series_pantof_r2c; 4:ss_mid_e3_series_pantof_1k2; 7:ss_mid_e3_series_pantof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_pantof_rrr; 3..5:ss_mid_e3_series_pantof_1kk; 6..8:ss_mid_e3_series_pantof_2kk;}
    
    // E2 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color_1553, cargo_subtype) {4:ss_mid_e3_series_pantof_r2c; 8:ss_mid_e3_series_pantof_1k2; 12:ss_mid_e3_series_pantof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape_1553, cargo_subtype) {0:sw_e3_series_pantof_yeardep; 1..4:ss_mid_e3_series_pantof_rrr; 5..8:ss_mid_e3_series_pantof_1kk; 9..12:ss_mid_e3_series_pantof_2kk;}
    
    // E4 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color_2043, cargo_subtype) {3:ss_mid_e3_series_pantof_r2c; 6:ss_mid_e3_series_pantof_1k2; 9:ss_mid_e3_series_pantof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape_2043, cargo_subtype) {0:sw_e3_series_pantof_yeardep; 1..3:ss_mid_e3_series_pantof_rrr; 4..6:ss_mid_e3_series_pantof_1kk; 7..9:ss_mid_e3_series_pantof_2kk;}

    // E5 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color_2053, cargo_subtype) {2:ss_mid_e3_series_pantof_r2c; 5:ss_mid_e3_series_pantof_1k2; 8:ss_mid_e3_series_pantof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_pantof_rrr; 3..5:ss_mid_e3_series_pantof_1kk; 6..8:ss_mid_e3_series_pantof_2kk;}

    // Standalone E3 Series
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color_2003, cargo_subtype) {2:ss_mid_e3_series_pantof_r2c; 4:ss_mid_e3_series_pantof_1k2; 6:ss_mid_e3_series_pantof_2k2;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape_2003, cargo_subtype) {0:sw_e3_series_pantof_yeardep; 1..2:ss_mid_e3_series_pantof_rrr; 3..4:ss_mid_e3_series_pantof_1kk; 5..6:ss_mid_e3_series_pantof_2kk; 7:ss_mid_e3_series_pantof_700;}
	
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_color, vehicle_type_id) {2003:ss_mid_e3_series_pantof_color_2003; 2053:ss_mid_e3_series_pantof_color_2053; 2043:ss_mid_e3_series_pantof_color_2043; 1553:ss_mid_e3_series_pantof_color_1553; 203:ss_mid_e3_series_pantof_color_203;}
	switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantof_shape, vehicle_type_id) {2003:ss_mid_e3_series_pantof_shape_2003; 2053:ss_mid_e3_series_pantof_shape_2053; 2043:ss_mid_e3_series_pantof_shape_2043; 1553:ss_mid_e3_series_pantof_shape_1553; 203:ss_mid_e3_series_pantof_shape_203;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_pantof, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_pantof_shape;		// Mask for Mid
                1: ss_mid_e3_series_pantof_color;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantob_color, cargo_subtype) {2:ss_mid_e3_series_pantob_r2c; 4:ss_mid_e3_series_pantob_1k2; 6:ss_mid_e3_series_pantob_2k2;}
    switch(FEAT_TRAINS, SELF, sw_e3_series_pantob_yeardep, build_year) {0..1998:ss_mid_e3_series_pantob_rrr; 1999..2007:ss_mid_e3_series_pantob_1kk; ss_mid_e3_series_pantob_2kk;}
    switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_pantob_shape, cargo_subtype) {0:sw_e3_series_pantob_yeardep; 1..2:ss_mid_e3_series_pantob_rrr; 3..4:ss_mid_e3_series_pantob_1kk; 5..6:ss_mid_e3_series_pantob_2kk; 7:ss_mid_e3_series_pantob_700;}

    switch(FEAT_TRAINS, SELF, sw_e3_series_pantob, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e3_series_pantob_shape;		// Mask for Mid
                1: ss_mid_e3_series_pantob_color;		// Mask for Mid
			}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_r.pnml" 1
// R Set 
        
        // "Clogo" - coach with logo no panto
        spriteset(ss_mid_e3_series_clog2f_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,401)}
        spriteset(ss_mid_e3_series_clog2b_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,401)}           

        // Coach w/ double raise
        spriteset(ss_mid_e3_series_c2raif_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_std(1,451)}
        spriteset(ss_mid_e3_series_c2raib_rrr, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_r.png") {tmpl_mid_rev(1,451)}

// R Set 2cc

        // "Clogo" - coach with logo no panto
        spriteset(ss_mid_e3_series_clog2f_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,401)}
        spriteset(ss_mid_e3_series_clog2b_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,401)}

        // Coach w/ double raise
        spriteset(ss_mid_e3_series_c2raif_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_std(1,451)}
        spriteset(ss_mid_e3_series_c2raib_r2c, "src/trains/e3_series/gfx/e3_r_2cc.png") {tmpl_mid_rev(1,451)}

// FORWARDS

    // clog2

        //switch(FEAT_TRAINS, SELF, sw_e3_series_clog2f_yeardep, build_year) {0..1998:ss_mid_e3_series_clog2f_rrr; 1999..2007:ss_mid_e3_series_clog2f_1kk; ss_mid_e3_series_clog2f_2kk;}

        // 200 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color_203, cargo_subtype) {1:ss_mid_e3_series_clog2f_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_clog2f_rrr; }
        
        // E2 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color_1553, cargo_subtype) {3:ss_mid_e3_series_clog2f_r2c;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape_1553, cargo_subtype) {1..3:ss_mid_e3_series_clog2f_rrr; }
        
        // E4 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color_2043, cargo_subtype) {3:ss_mid_e3_series_clog2f_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape_2043, cargo_subtype) {1..3:ss_mid_e3_series_clog2f_rrr; }

        // E5 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color_2053, cargo_subtype) {2:ss_mid_e3_series_clog2f_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_clog2f_rrr; }

        // Standalone E3 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color_2003, cargo_subtype) {2:ss_mid_e3_series_clog2f_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape_2003, cargo_subtype) {0..2:ss_mid_e3_series_clog2f_rrr; }
        
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_color, vehicle_type_id) {2003:ss_mid_e3_series_clog2f_color_2003; 2053:ss_mid_e3_series_clog2f_color_2053; 2043:ss_mid_e3_series_clog2f_color_2043; 1553:ss_mid_e3_series_clog2f_color_1553; 203:ss_mid_e3_series_clog2f_color_203;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2f_shape, vehicle_type_id) {2003:ss_mid_e3_series_clog2f_shape_2003; 2053:ss_mid_e3_series_clog2f_shape_2053; 2043:ss_mid_e3_series_clog2f_shape_2043; 1553:ss_mid_e3_series_clog2f_shape_1553; 203:ss_mid_e3_series_clog2f_shape_203;}

        switch(FEAT_TRAINS, SELF, sw_e3_series_clog2f, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_mid_e3_series_clog2f_shape;		// Mask for Mid
                    1: ss_mid_e3_series_clog2f_color;		// Mask for Mid
                }

    // c2rai

        //switch(FEAT_TRAINS, SELF, sw_e3_series_c2raif_yeardep, build_year) {0..1998:ss_mid_e3_series_c2raif_rrr; 1999..2007:ss_mid_e3_series_c2raif_1kk; ss_mid_e3_series_c2raif_2kk;}

        // 200 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color_203, cargo_subtype) {1:ss_mid_e3_series_c2raif_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape_203, cargo_subtype) {0..2:ss_mid_e3_series_c2raif_rrr; }
        
        // E2 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color_1553, cargo_subtype) {4:ss_mid_e3_series_c2raif_r2c;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape_1553, cargo_subtype) {1..4:ss_mid_e3_series_c2raif_rrr; }
        
        // E4 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color_2043, cargo_subtype) {3:ss_mid_e3_series_c2raif_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape_2043, cargo_subtype) {1..3:ss_mid_e3_series_c2raif_rrr; }

        // E5 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color_2053, cargo_subtype) {2:ss_mid_e3_series_c2raif_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape_2053, cargo_subtype) {0..2:ss_mid_e3_series_c2raif_rrr; }

        // Standalone E3 Series
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color_2003, cargo_subtype) {2:ss_mid_e3_series_c2raif_r2c; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape_2003, cargo_subtype) {0..2:ss_mid_e3_series_c2raif_rrr;}
        
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_color, vehicle_type_id) {2003:ss_mid_e3_series_c2raif_color_2003; 2053:ss_mid_e3_series_c2raif_color_2053; 2043:ss_mid_e3_series_c2raif_color_2043; 1553:ss_mid_e3_series_c2raif_color_1553; 203:ss_mid_e3_series_c2raif_color_203;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raif_shape, vehicle_type_id) {2003:ss_mid_e3_series_c2raif_shape_2003; 2053:ss_mid_e3_series_c2raif_shape_2053; 2043:ss_mid_e3_series_c2raif_shape_2043; 1553:ss_mid_e3_series_c2raif_shape_1553; 203:ss_mid_e3_series_c2raif_shape_203;}

        switch(FEAT_TRAINS, SELF, sw_e3_series_c2raif, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_mid_e3_series_c2raif_shape;		// Mask for Mid
                    1: ss_mid_e3_series_c2raif_color;		// Mask for Mid
                }

// BACKWARDS

    // clog2
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2b_color, cargo_subtype) {2:ss_mid_e3_series_clog2b_r2c;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_clog2b_shape, cargo_subtype) {1..2:ss_mid_e3_series_clog2b_rrr;}

        switch(FEAT_TRAINS, SELF, sw_e3_series_clog2b, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_mid_e3_series_clog2b_shape;		// Mask for Mid
                    1: ss_mid_e3_series_clog2b_color;		// Mask for Mid
                }
    // c2rai
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raib_color, cargo_subtype) {2:ss_mid_e3_series_c2raib_r2c;}
        switch(FEAT_TRAINS, PARENT, ss_mid_e3_series_c2raib_shape, cargo_subtype) {1..2:ss_mid_e3_series_c2raib_rrr;}

        switch(FEAT_TRAINS, SELF, sw_e3_series_c2raib, [ 
                STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
                    0: ss_mid_e3_series_c2raib_shape;		// Mask for Mid
                    1: ss_mid_e3_series_c2raib_color;		// Mask for Mid
                }
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_toreiyu.pnml" 1
   
  // Coach green going down OR Coach w/ raise
    spriteset(ss_e3_series_grndnf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,251)}
    spriteset(ss_e3_series_grndnb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,251)}      

  // Coach green going up
    spriteset(ss_e3_series_grnupf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,301)}
    spriteset(ss_e3_series_grnupb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,301)}       

  // Coach green
    spriteset(ss_e3_series_greenf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,451)}
    spriteset(ss_e3_series_greenb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,451)}

  // Coach with logo for long consists "2ndco"
    spriteset(ss_e3_series_2ndcof_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,501)}
    spriteset(ss_e3_series_2ndcob_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,501)}

  // Coach panto for long consists
    spriteset(ss_e3_series_pantlf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,551)}
    spriteset(ss_e3_series_pantlb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,551)}    

  // Coach panto in single green corner
    spriteset(ss_e3_series_pantgf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,601)}
    spriteset(ss_e3_series_pantgb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,601)}    

  // Coach with green tip corner
    spriteset(ss_e3_series_coacgf_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_std(1,651)}
    spriteset(ss_e3_series_coacgb_700, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e3_series/gfx/e3_700.png") {tmpl_mid_rev(1,651)}    
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_formations.pnml" 1
// Everything else
switch (FEAT_TRAINS, PARENT, sw_e3_series_everything_else_coaches, vehicle_is_reversed ) {				
		1:  sw_e3_series_coachb;
		sw_e3_series_coachf;				
	}

// 6 CARS

  switch (FEAT_TRAINS, SELF, sw_e3_series_6car_irl_reversed, position_in_consist_from_end % 6) {				
          0: sw_e3_series_cab01b;
          1: sw_e3_series_clogob;
          2: sw_e3_series_c2raib;           
          3: sw_e3_series_coraib;
          4: sw_e3_series_pantob;
          5: sw_e3_series_cab02b; 
          sw_e3_series_coachb;			
        }

  switch (FEAT_TRAINS, SELF, sw_e3_series_6car_irl_not_reversed, position_in_consist % 6 ) {				
          0: sw_e3_series_cab01f;
          1: sw_e3_series_clogof;
          2: sw_e3_series_c2raif;           
          3: sw_e3_series_coraif;
          4: sw_e3_series_pantof;
          5: sw_e3_series_cab02f; 
          sw_e3_series_coachf;			
        }

  switch (FEAT_TRAINS, PARENT, sw_e3_series_6car_irl_reverse_check, vehicle_is_reversed ) {				
    1:  sw_e3_series_6car_irl_reversed;
    sw_e3_series_6car_irl_not_reversed;				
  }
  
  switch (FEAT_TRAINS, SELF, sw_e3_series_6car_reversed, position_in_consist_from_end ) {				
      2: sw_e3_series_c2raib;           
      3: sw_e3_series_coraib;       
      sw_e3_series_coachb;			
    }

  switch (FEAT_TRAINS, SELF, sw_e3_series_6car_not_reversed, position_in_consist ) {				
    2: sw_e3_series_c2raif;           
    3: sw_e3_series_coraif;       
    sw_e3_series_coachf;			
  }

  switch (FEAT_TRAINS, PARENT, sw_e3_series_6car_reverse_check, vehicle_is_reversed ) {				
    1:  sw_e3_series_6car_reversed;
    sw_e3_series_6car_not_reversed;				
  }

  switch (FEAT_TRAINS, SELF, sw_e3_series_6car_length_check, num_vehs_in_consist % 6 ) {				
    0:  sw_e3_series_6car_irl_reverse_check;
    sw_e3_series_6car_reverse_check;				
  }

// 7 CARS
  // IRL coupling
    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_irl_reversed, position_in_consist_from_end % 7 ) {				
          0: sw_e3_series_cab01b;
          1: sw_e3_series_clogob;      
          3: sw_e3_series_pantob;
          4: sw_e3_series_coraib;
          5: sw_e3_series_pantob;
          6: sw_e3_series_cab02b; 
          sw_e3_series_coachb;			
        }
    
    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_irl_not_reversed, position_in_consist % 7 ) {				
          0: sw_e3_series_cab01f;
          1: sw_e3_series_clogof;      
          3: sw_e3_series_pantof;
          4: sw_e3_series_coraif;
          5: sw_e3_series_pantof;
          6: sw_e3_series_cab02f; 
          sw_e3_series_coachf;			
        }
    
    switch (FEAT_TRAINS, PARENT, sw_e3_series_7car_irl_reverse_check, vehicle_is_reversed ) {				
      1:  sw_e3_series_7car_irl_reversed;
      sw_e3_series_7car_irl_not_reversed;				
    }

  // Standard
    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_even_reversed, position_in_consist_from_end - position_in_consist ) {				
        1: sw_e3_series_coraib;           
        -1:  sw_e3_series_pantob;       
        sw_e3_series_coachb;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_even_not_reversed, position_in_consist - position_in_consist_from_end ) {				
        1: sw_e3_series_coraif;
        -1:  sw_e3_series_pantof;
        sw_e3_series_coachf;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_odd_reversed, position_in_consist_from_end - position_in_consist ) {				
        2: sw_e3_series_coraib;        
        0:  sw_e3_series_pantob;       
        sw_e3_series_coachb;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_odd_not_reversed, position_in_consist - position_in_consist_from_end ) {				
        2: sw_e3_series_coraif;
        0:  sw_e3_series_pantof;
        sw_e3_series_coachf;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_oddeven_not_reversed, num_vehs_in_consist % 2) {				
        0:  sw_e3_series_7car_even_not_reversed;       // Even
        sw_e3_series_7car_odd_not_reversed;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_7car_oddeven_reversed, num_vehs_in_consist % 2) {				
        0:  sw_e3_series_7car_even_reversed;       // Even
        sw_e3_series_7car_odd_reversed;			
      }

  switch (FEAT_TRAINS, PARENT, sw_e3_series_7car_reverse_check, vehicle_is_reversed ) {				
      1:  sw_e3_series_7car_oddeven_reversed;
      sw_e3_series_7car_oddeven_not_reversed;				
    }

  switch (FEAT_TRAINS, SELF, sw_e3_series_7car_length_check, num_vehs_in_consist % 7 ) {				
      0:  sw_e3_series_7car_irl_reverse_check;
      sw_e3_series_7car_reverse_check;				
    }

// TOREIYU
      switch (FEAT_TRAINS, SELF, sw_e3_series_toreiyu_reversed, position_in_consist_from_end - position_in_consist ) {				
          -4: ss_e3_series_pantgb_700;
          -3: ss_e3_series_pantgb_700;
          -2: ss_e3_series_grndnb_700;
          -1: ss_e3_series_grndnb_700;
          0:  ss_e3_series_greenb_700;
          1:  ss_e3_series_grnupb_700; 
          2:  ss_e3_series_grnupb_700;   
          3:  ss_e3_series_coacgb_700;    
          4:  ss_e3_series_coacgb_700;  
          sw_e3_series_coachb;			
        }

      switch (FEAT_TRAINS, SELF, sw_e3_series_toreiyu_not_reversed, position_in_consist - position_in_consist_from_end ) {				
          -4: ss_e3_series_pantgf_700;
          -3: ss_e3_series_pantgf_700;
          -2: ss_e3_series_grndnf_700;
          -1: ss_e3_series_grndnf_700;
          0:  ss_e3_series_greenf_700;
          1:  ss_e3_series_grnupf_700;
          2:  ss_e3_series_grnupf_700; 
          3:  ss_e3_series_coacgf_700;  
          4:  ss_e3_series_coacgf_700;  
          sw_e3_series_coachf;			
        }

  // ODD EVEN CHECK!!!

  switch (FEAT_TRAINS, PARENT, sw_e3_series_toreiyu_reverse_check, vehicle_is_reversed ) {				
      1:  sw_e3_series_toreiyu_reversed;
      sw_e3_series_toreiyu_not_reversed;				
    }

  // Toreiyu 5 car check
    switch(FEAT_TRAINS, SELF, sw_e3_series_year_dep_reverse_check, build_year) {
            0..1998: sw_e3_series_6car_length_check;
            sw_e3_series_7car_length_check; 
          }

    switch(FEAT_TRAINS, PARENT, sw_e3_series_midcar_subtype_check, cargo_subtype) {
            0: sw_e3_series_year_dep_reverse_check;
            1..2: sw_e3_series_6car_length_check;
            3..6: sw_e3_series_7car_length_check;
            7: sw_e3_series_toreiyu_reverse_check;   // Toreiyu
            sw_e3_series_everything_else_coaches;
          }
  
  // Five Car Long check

    switch (FEAT_TRAINS, SELF, sw_e3_series_length_5_check, num_vehs_in_consist == 5 ) {				
        1:  sw_e3_series_everything_else_coaches;
        sw_e3_series_midcar_subtype_check;			
      }

  // Second car checks

    // Standard 2nd car checks
    switch (FEAT_TRAINS, SELF, sw_e3_series_2nd_not_reversed, position_in_consist) {				
        1:  sw_e3_series_clogof;     
        sw_e3_series_pantof;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_2nd_reversed, position_in_consist){				
        1:  sw_e3_series_pantob;     
        sw_e3_series_clogob;		  
      }

    switch (FEAT_TRAINS, PARENT, sw_e3_series_2nd_car_reverse_check, vehicle_is_reversed) {				
        1:  sw_e3_series_2nd_reversed;
        sw_e3_series_2nd_not_reversed;				
      }

    // Toreiyu
    switch (FEAT_TRAINS, SELF, sw_e3_series_toreiyu_2nd_not_reversed, position_in_consist) {				
        1:  ss_e3_series_2ndcof_700;     
        ss_e3_series_pantlf_700;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_toreiyu_2nd_reversed, position_in_consist){				
        1:  ss_e3_series_pantlb_700;     
        ss_e3_series_2ndcob_700;		  
      }

    switch (FEAT_TRAINS, PARENT, sw_e3_series_toreiyu_2nd_car_reverse_check, vehicle_is_reversed) {				
        1:  sw_e3_series_toreiyu_2nd_reversed;
        sw_e3_series_toreiyu_2nd_not_reversed;				
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_toreiyu_5_or_6_check, num_vehs_in_consist == 6 || num_vehs_in_consist == 7 ) {				
        1:  sw_e3_series_2nd_car_reverse_check;
        sw_e3_series_toreiyu_2nd_car_reverse_check;				
      }

    // 6car (R Set)
    switch (FEAT_TRAINS, SELF, sw_e3_series_6car_2nd_not_reversed, position_in_consist) {				
        1:  sw_e3_series_clog2f;     
        sw_e3_series_pantof;			
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_6car_2nd_reversed, position_in_consist){				
        1:  sw_e3_series_pantob;     
        sw_e3_series_clog2b;		  
      }

    switch (FEAT_TRAINS, PARENT, sw_e3_series_6car_2nd_car_reverse_check, vehicle_is_reversed) {				
        1:  sw_e3_series_6car_2nd_reversed;
        sw_e3_series_6car_2nd_not_reversed;				
      }

    switch (FEAT_TRAINS, SELF, sw_e3_series_2nd_car_check_for_6car, num_vehs_in_consist == 4 || num_vehs_in_consist == 5) {				
        1:  sw_e3_series_6car_2nd_car_reverse_check;      // 4 or 5 cars, so choose bespoke sprites
        sw_e3_series_2nd_car_reverse_check;				        // > 5 cars, so standard chain
      }

    // Which cargo subtype
    switch(FEAT_TRAINS, SELF, sw_e3_series_year_dep_2nd_car_check, build_year) {
            0..1998: sw_e3_series_2nd_car_check_for_6car; // R Set
            sw_e3_series_2nd_car_reverse_check;           // Not R Set, so send to standard chain
          }

    switch(FEAT_TRAINS, PARENT, sw_e3_series_2nd_car_subtype_check, cargo_subtype) {
            0: sw_e3_series_year_dep_2nd_car_check;       // R Set til '98
            1..2: sw_e3_series_2nd_car_check_for_6car;    // R Set
            7: sw_e3_series_toreiyu_5_or_6_check;         // Toreiyu
            sw_e3_series_2nd_car_reverse_check;
          }
    // Identify the 2nd cars
    switch (FEAT_TRAINS, SELF, sw_e3_series_2nd_car_checks, position_in_consist == 1 || position_in_consist_from_end == 1 ) {				
        1:  sw_e3_series_2nd_car_subtype_check;
        sw_e3_series_length_5_check;
        //sw_e3_series_midcar_subtype_check;				
      }

/* Cab selection */
    // Rear cab
    switch (FEAT_TRAINS, PARENT, sw_e3_series_rear, vehicle_is_reversed) {				
            1:  sw_e3_series_cab01b;                   // cab01	
            sw_e3_series_cab02f;                       // cab02
        }

    // Lead cab
    switch (FEAT_TRAINS, PARENT, sw_e3_series_lead, vehicle_is_reversed) {				
            1:  sw_e3_series_cab02b;                   // cab02
            sw_e3_series_cab01f;                       // cab01	
        }

/* Find the cabs */
    switch (FEAT_TRAINS, SELF, sw_e3_series_lead_or_rear, position_in_consist) {				
            0:  sw_e3_series_lead;
            sw_e3_series_rear;				
        }
    
    switch (FEAT_TRAINS, SELF, sw_e3_series_graphics, position_in_consist == 0 || position_in_consist_from_end == 0 ) {				
            1:  sw_e3_series_lead_or_rear;
            sw_e3_series_2nd_car_checks;				
        }
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "src/trains/e3_series/e3_series_item.pnml" 1
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_attach_vehid, [vehicle_type_id == series_e3 || vehicle_type_id == mu_car_ms]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e3) {
    property {
        name:                           string(STR_NAME_E3_SERIES);
        introduction_date:              date(1997,03,22);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          275 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         43 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        //dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e3_series_graphics;
	      purchase:                       sw_e3_series_purchase;
		    additional_text:	              return string(STR_DESC_E3_SERIES);
        cargo_subtype_text:             sw_e3_series_year_dep_subtype_text;
        can_attach_wagon:			          sw_e3_series_attach_vehid;
        //start_stop:                   ;
        purchase_weight:                43 / 2;
        purchase_power:                 400 * 4;
        /* Stats */
        power:                          max (num_vehs_in_consist - 2 , 0 ) * 400 * 4;     // 300 kW = 400 hp
        weight:                         43 * num_vehs_in_consist;
        cargo_capacity:                 56 * CapacityFactor();										        // Average 338/6, 402/7, 394/7 = 56  					
		    loading_speed:					        56 * CapacityFactor() / param_loading_1D;					// Capacity divided by door loading factor
        running_cost_factor:            (445 + 120 * num_vehs_in_consist ) * RunningCostFactor();
        purchase_running_cost_factor:   (445 + 120) / 2;	
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e3_series_graphics;
        cargo_capacity:                 56 * CapacityFactor();										        // Average 338/6, 402/7, 394/7 = 56  	
        cargo_age_period:				        param_decay_express;
        loading_speed:					        56 * CapacityFactor() / param_loading_1D;					// Capacity divided by door loading factor
        //cargo_subtype_text:             sw_e3_series_subtypetext_mucar;
        //power:                        // Apply power in graphics block to calculate power based on number of motorised cars correctly
        //weight:                         43;
        //running_cost_factor:            120;
      }
}
# 1 "src/trains/e3_series/e3_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e4_series/e4_series.pnml" 1

# 1 "src/trains/e4_series/e4_series_menu.pnml" 1

/* SUBTYPES */ 

	switch(FEAT_TRAINS, SELF, sw_e4_series_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
		1: return string(LV_E4_SERIES_YELLOW);
		2: return string(LV_E4_SERIES_PINK);
        3: return string(LV_E4_SERIES_2CC);
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */

    spriteset (ss_e4_series_yel_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {template_purchase(233, 1)}
    spriteset (ss_e4_series_pnk_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e4_series_year_dep_purchase, current_year) {2015..9999: ss_e4_series_pnk_buy; }
    
    switch(FEAT_TRAINS, SELF, sw_e4_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast;
            1: ss_e4_series_yel_buy;
            2: sw_e4_series_year_dep_purchase;
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e4_series_cab01f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e4_series_cab01b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e4_series_cab01f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e4_series_cab01b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e4_series_cab01f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e4_series_cab01b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e4_series_cab01f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e4_series_cab01b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_rev(1,51)}

    // Refurb

	// 10/8
	spriteset(ss_std_e4_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e4_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e4_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e4_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e4_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e4_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e4_series_cab01f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e4_series_cab01b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e4_series_cab01f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e4_series_cab01b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e4_series_cab01f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e4_series_cab01b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e4_series_cab01f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e4_series_cab01b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e4_series_cab01f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e4_series_cab01b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_cab01f_yeardep, build_year) {2014..9999: ss_frt_e4_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab01f_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_cab01f_pnk; 0:ss_frt_e4_series_cab01f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab01f_mask, cargo_subtype) {0:ss_frt_e4_series_cab01f_yeardep; ss_frt_e4_series_cab01f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_cab01f_yel;       	// Base for Front
				1: ss_frt_e4_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e4_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_cab01f_yeardep, build_year) {2014..9999: ss_mid_e4_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab01f_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_cab01f_pnk; 0:ss_mid_e4_series_cab01f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab01f_mask, cargo_subtype) {0:ss_mid_e4_series_cab01f_yeardep; ss_mid_e4_series_cab01f_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_cab01f_yeardep, build_year) {2014..9999: ss_std_e4_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab01f_cycle, cargo_subtype % 3) {2:ss_std_e4_series_cab01f_pnk; 0:ss_std_e4_series_cab01f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab01f_mask, cargo_subtype) {0:ss_std_e4_series_cab01f_yeardep; ss_std_e4_series_cab01f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_mid_longsprite, HideLongSprite()) { 0: ss_std_e4_series_cab01f_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_std_longsprite, HideLongSprite()) { 0: ss_std_e4_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_cab01f_yel;       	// Base for Mid
				1: ss_mid_e4_series_cab01f_mask;		// Mask for Mid
				2: sw_e4_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_cab01f_yeardep, build_year) {2014..9999: ss_bck_e4_series_cab01f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab01f_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_cab01f_pnk; 0:ss_bck_e4_series_cab01f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab01f_mask, cargo_subtype) {0:ss_bck_e4_series_cab01f_yeardep; ss_bck_e4_series_cab01f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_cab01f_yel;       	// Base for Front
				1: ss_bck_e4_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e4_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e4_series_cab01f_frt_longsprite;
            1: sw_e4_series_cab01f_mid_stack;
            2: sw_e4_series_cab01f_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_cab01b_yeardep, build_year) {2014..9999: ss_frt_e4_series_cab01b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab01b_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_cab01b_pnk; 0:ss_frt_e4_series_cab01b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab01b_mask, cargo_subtype) {0:ss_frt_e4_series_cab01b_yeardep; ss_frt_e4_series_cab01b_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_cab01b_yel;       	// Base for Front
				1: ss_frt_e4_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e4_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_cab01b_yeardep, build_year) {2014..9999: ss_mid_e4_series_cab01b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab01b_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_cab01b_pnk; 0:ss_mid_e4_series_cab01b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab01b_mask, cargo_subtype) {0:ss_mid_e4_series_cab01b_yeardep; ss_mid_e4_series_cab01b_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_cab01b_yeardep, build_year) {2014..9999: ss_std_e4_series_cab01b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab01b_cycle, cargo_subtype % 3) {2:ss_std_e4_series_cab01b_pnk; 0:ss_std_e4_series_cab01b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab01b_mask, cargo_subtype) {0:ss_std_e4_series_cab01b_yeardep; ss_std_e4_series_cab01b_cycle; }
			
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_cab01b_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_cab01b_yel;       	// Base for Mid
				1: ss_mid_e4_series_cab01b_mask;		// Mask for Mid
				2: sw_e4_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_cab01b_yeardep, build_year) {2014..9999: ss_bck_e4_series_cab01b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab01b_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_cab01b_pnk; 0:ss_bck_e4_series_cab01b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab01b_mask, cargo_subtype) {0:ss_bck_e4_series_cab01b_yeardep; ss_bck_e4_series_cab01b_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_cab01b_yel;       	// Base for Front
				1: ss_bck_e4_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e4_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e4_series_cab01b_frt_longsprite;
            1: sw_e4_series_cab01b_mid_stack;
            2: sw_e4_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e4_series_cab02f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e4_series_cab02b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e4_series_cab02f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e4_series_cab02b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e4_series_cab02f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e4_series_cab02b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e4_series_cab02f_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e4_series_cab02b_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_cab_bck_rev(1,1)}

    // Refurb

	// 10/8
	spriteset(ss_std_e4_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e4_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e4_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e4_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e4_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e4_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e4_series_cab02f_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e4_series_cab02b_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e4_series_cab02f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e4_series_cab02b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e4_series_cab02f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e4_series_cab02b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e4_series_cab02f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e4_series_cab02b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e4_series_cab02f_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e4_series_cab02b_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_cab02f_yeardep, build_year) {2014..9999: ss_frt_e4_series_cab02f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab02f_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_cab02f_pnk; 0:ss_frt_e4_series_cab02f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab02f_mask, cargo_subtype) {0:ss_frt_e4_series_cab02f_yeardep; ss_frt_e4_series_cab02f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_cab02f_yel;       	// Base for Front
				1: ss_frt_e4_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e4_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_cab02f_yeardep, build_year) {2014..9999: ss_mid_e4_series_cab02f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab02f_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_cab02f_pnk; 0:ss_mid_e4_series_cab02f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab02f_mask, cargo_subtype) {0:ss_mid_e4_series_cab02f_yeardep; ss_mid_e4_series_cab02f_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_cab02f_yeardep, build_year) {2014..9999: ss_std_e4_series_cab02f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab02f_cycle, cargo_subtype % 3) {2:ss_std_e4_series_cab02f_pnk; 0:ss_std_e4_series_cab02f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab02f_mask, cargo_subtype) {0:ss_std_e4_series_cab02f_yeardep; ss_std_e4_series_cab02f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_mid_longsprite, HideLongSprite()) { 0: ss_std_e4_series_cab02f_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_std_longsprite, HideLongSprite()) { 0: ss_std_e4_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_cab02f_yel;       	// Base for Mid
				1: ss_mid_e4_series_cab02f_mask;		// Mask for Mid
				2: sw_e4_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_cab02f_yeardep, build_year) {2014..9999: ss_bck_e4_series_cab02f_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab02f_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_cab02f_pnk; 0:ss_bck_e4_series_cab02f_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab02f_mask, cargo_subtype) {0:ss_bck_e4_series_cab02f_yeardep; ss_bck_e4_series_cab02f_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_cab02f_yel;       	// Base for Front
				1: ss_bck_e4_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e4_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e4_series_cab02f_frt_longsprite;
            1: sw_e4_series_cab02f_mid_stack;
            2: sw_e4_series_cab02f_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_cab02b_yeardep, build_year) {2014..9999: ss_frt_e4_series_cab02b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab02b_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_cab02b_pnk; 0:ss_frt_e4_series_cab02b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_cab02b_mask, cargo_subtype) {0:ss_frt_e4_series_cab02b_yeardep; ss_frt_e4_series_cab02b_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_cab02b_yel;       	// Base for Front
				1: ss_frt_e4_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e4_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_cab02b_yeardep, build_year) {2014..9999: ss_mid_e4_series_cab02b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab02b_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_cab02b_pnk; 0:ss_mid_e4_series_cab02b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_cab02b_mask, cargo_subtype) {0:ss_mid_e4_series_cab02b_yeardep; ss_mid_e4_series_cab02b_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_cab02b_yeardep, build_year) {2014..9999: ss_std_e4_series_cab02b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab02b_cycle, cargo_subtype % 3) {2:ss_std_e4_series_cab02b_pnk; 0:ss_std_e4_series_cab02b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_cab02b_mask, cargo_subtype) {0:ss_std_e4_series_cab02b_yeardep; ss_std_e4_series_cab02b_cycle; }
			
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_cab02b_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_cab02b_yel;       	// Base for Mid
				1: ss_mid_e4_series_cab02b_mask;		// Mask for Mid
				2: sw_e4_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_cab02b_yeardep, build_year) {2014..9999: ss_bck_e4_series_cab02b_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab02b_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_cab02b_pnk; 0:ss_bck_e4_series_cab02b_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_cab02b_mask, cargo_subtype) {0:ss_bck_e4_series_cab02b_yeardep; ss_bck_e4_series_cab02b_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_cab02b_yel;       	// Base for Front
				1: ss_bck_e4_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e4_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e4_series_cab02b_frt_longsprite;
            1: sw_e4_series_cab02b_mid_stack;
            2: sw_e4_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e4_series_coachf_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_coachb_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_coachf_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_coachb_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_coachf_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_coachb_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_coachf_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_coachb_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_rev(1,101)}

    // Refurb

	// 10/8
	spriteset(ss_std_e4_series_coachf_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_coachb_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_coachf_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_coachb_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_coachf_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_coachb_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_coachf_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_coachb_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e4_series_coachf_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_coachb_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_coachf_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_coachb_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_coachf_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_coachb_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_coachf_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_coachb_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_coachf_yeardep, build_year) {2014..9999: ss_frt_e4_series_coachf_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_coachf_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_coachf_pnk; 0:ss_frt_e4_series_coachf_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_coachf_mask, cargo_subtype) {0:ss_frt_e4_series_coachf_yeardep; ss_frt_e4_series_coachf_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_coachf_yel;       	// Base for Front
				1: ss_frt_e4_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_e4_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_coachf_yeardep, build_year) {2014..9999: ss_mid_e4_series_coachf_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_coachf_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_coachf_pnk; 0:ss_mid_e4_series_coachf_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_coachf_mask, cargo_subtype) {0:ss_mid_e4_series_coachf_yeardep; ss_mid_e4_series_coachf_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_coachf_yeardep, build_year) {2014..9999: ss_std_e4_series_coachf_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_coachf_cycle, cargo_subtype % 3) {2:ss_std_e4_series_coachf_pnk; 0:ss_std_e4_series_coachf_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_coachf_mask, cargo_subtype) {0:ss_std_e4_series_coachf_yeardep; ss_std_e4_series_coachf_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_mid_longsprite, HideLongSprite()) { 0: ss_std_e4_series_coachf_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_std_longsprite, HideLongSprite()) { 0: ss_std_e4_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_coachf_yel;       	// Base for Mid
				1: ss_mid_e4_series_coachf_mask;		// Mask for Mid
				2: sw_e4_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_coachf_yeardep, build_year) {2014..9999: ss_bck_e4_series_coachf_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_coachf_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_coachf_pnk; 0:ss_bck_e4_series_coachf_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_coachf_mask, cargo_subtype) {0:ss_bck_e4_series_coachf_yeardep; ss_bck_e4_series_coachf_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_coachf_yel;       	// Base for Front
				1: ss_bck_e4_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_e4_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_coachf, position_in_consist % 3 ) {				
            0: sw_e4_series_coachf_frt_longsprite;
            1: sw_e4_series_coachf_mid_stack;
            2: sw_e4_series_coachf_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_coachb_yeardep, build_year) {2014..9999: ss_frt_e4_series_coachb_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_coachb_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_coachb_pnk; 0:ss_frt_e4_series_coachb_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_coachb_mask, cargo_subtype) {0:ss_frt_e4_series_coachb_yeardep; ss_frt_e4_series_coachb_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_coachb_yel;       	// Base for Front
				1: ss_frt_e4_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_e4_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_coachb_yeardep, build_year) {2014..9999: ss_mid_e4_series_coachb_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_coachb_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_coachb_pnk; 0:ss_mid_e4_series_coachb_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_coachb_mask, cargo_subtype) {0:ss_mid_e4_series_coachb_yeardep; ss_mid_e4_series_coachb_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_coachb_yeardep, build_year) {2014..9999: ss_std_e4_series_coachb_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_coachb_cycle, cargo_subtype % 3) {2:ss_std_e4_series_coachb_pnk; 0:ss_std_e4_series_coachb_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_coachb_mask, cargo_subtype) {0:ss_std_e4_series_coachb_yeardep; ss_std_e4_series_coachb_cycle; }
			
		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_coachb_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_coachb_yel;       	// Base for Mid
				1: ss_mid_e4_series_coachb_mask;		// Mask for Mid
				2: sw_e4_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_coachb_yeardep, build_year) {2014..9999: ss_bck_e4_series_coachb_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_coachb_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_coachb_pnk; 0:ss_bck_e4_series_coachb_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_coachb_mask, cargo_subtype) {0:ss_bck_e4_series_coachb_yeardep; ss_bck_e4_series_coachb_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_coachb_yel;       	// Base for Front
				1: ss_bck_e4_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_e4_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_e4_series_coachb_frt_longsprite;
            1: sw_e4_series_coachb_mid_stack;
            2: sw_e4_series_coachb_bck_longsprite;
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_panto.pnml" 1


/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e4_series_pantof_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_pantob_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_pantof_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_pantob_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_pantof_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_pantob_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_pantof_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_pantob_yel, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_yellow.png") {tmpl_bck_rev(1,101)}

    // Refurb

	// 10/8
	spriteset(ss_std_e4_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_pantof_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_pantob_pnk, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4_series/gfx/e4_series_pink.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e4_series_pantof_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e4_series_pantob_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e4_series_pantof_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e4_series_pantob_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e4_series_pantof_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e4_series_pantob_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e4_series_pantof_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e4_series_pantob_2cc, "src/trains/e4_series/gfx/e4_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

    // Forwards

		// Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_pantof_yeardep, build_year) {2014..9999: ss_frt_e4_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_pantof_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_pantof_pnk; 0:ss_frt_e4_series_pantof_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_pantof_mask, cargo_subtype) {0:ss_frt_e4_series_pantof_yeardep; ss_frt_e4_series_pantof_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_pantof_yel;       	// Base for Front
				1: ss_frt_e4_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e4_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_pantof_yeardep, build_year) {2014..9999: ss_mid_e4_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_pantof_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_pantof_pnk; 0:ss_mid_e4_series_pantof_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_pantof_mask, cargo_subtype) {0:ss_mid_e4_series_pantof_yeardep; ss_mid_e4_series_pantof_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_pantof_yeardep, build_year) {2014..9999: ss_std_e4_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_pantof_cycle, cargo_subtype % 3) {2:ss_std_e4_series_pantof_pnk; 0:ss_std_e4_series_pantof_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_pantof_mask, cargo_subtype) {0:ss_std_e4_series_pantof_yeardep; ss_std_e4_series_pantof_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_mid_longsprite, HideLongSprite()) { 0: ss_std_e4_series_pantof_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_std_longsprite, HideLongSprite()) { 0: ss_std_e4_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_pantof_yel;       	// Base for Mid
				1: ss_mid_e4_series_pantof_mask;		// Mask for Mid
				2: sw_e4_series_pantof_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_pantof_std_longsprite;
                // Pantos
                4: panto_midsprite_e1_f;
                5: panto_longsprite_e1_f;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_pantof_yeardep, build_year) {2014..9999: ss_bck_e4_series_pantof_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_pantof_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_pantof_pnk; 0:ss_bck_e4_series_pantof_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_pantof_mask, cargo_subtype) {0:ss_bck_e4_series_pantof_yeardep; ss_bck_e4_series_pantof_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_pantof_yel;       	// Base for Front
				1: ss_bck_e4_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e4_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_pantof, position_in_consist % 3 ) {				
            0: sw_e4_series_pantof_frt_longsprite;
            1: sw_e4_series_pantof_mid_stack;
            2: sw_e4_series_pantof_bck_longsprite;
        }

    // Backwards

        // Front
		switch(FEAT_TRAINS, SELF, ss_frt_e4_series_pantob_yeardep, build_year) {2014..9999: ss_frt_e4_series_pantob_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_pantob_cycle, cargo_subtype % 3) {2:ss_frt_e4_series_pantob_pnk; 0:ss_frt_e4_series_pantob_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_frt_e4_series_pantob_mask, cargo_subtype) {0:ss_frt_e4_series_pantob_yeardep; ss_frt_e4_series_pantob_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e4_series_pantob_yel;       	// Base for Front
				1: ss_frt_e4_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e4_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, SELF, ss_mid_e4_series_pantob_yeardep, build_year) {2014..9999: ss_mid_e4_series_pantob_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_pantob_cycle, cargo_subtype % 3) {2:ss_mid_e4_series_pantob_pnk; 0:ss_mid_e4_series_pantob_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_mid_e4_series_pantob_mask, cargo_subtype) {0:ss_mid_e4_series_pantob_yeardep; ss_mid_e4_series_pantob_cycle; }
		
        switch(FEAT_TRAINS, SELF, ss_std_e4_series_pantob_yeardep, build_year) {2014..9999: ss_std_e4_series_pantob_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_std_e4_series_pantob_cycle, cargo_subtype % 3) {2:ss_std_e4_series_pantob_pnk; 0:ss_std_e4_series_pantob_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_std_e4_series_pantob_mask, cargo_subtype) {0:ss_std_e4_series_pantob_yeardep; ss_std_e4_series_pantob_cycle; }
			
		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_mid_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_pantob_yel; }
		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_std_longsprite, HideLongSprite() ) { 0: ss_std_e4_series_pantob_mask; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e4_series_pantob_yel;       	// Base for Mid
				1: ss_mid_e4_series_pantob_mask;		// Mask for Mid
				2: sw_e4_series_pantob_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e4_series_pantob_std_longsprite;
                // Pantos
                4: panto_midsprite_e1_b;
                5: panto_longsprite_e1_b;
			}

		// Back
		switch(FEAT_TRAINS, SELF, ss_bck_e4_series_pantob_yeardep, build_year) {2014..9999: ss_bck_e4_series_pantob_pnk; }
		switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_pantob_cycle, cargo_subtype % 3) {2:ss_bck_e4_series_pantob_pnk; 0:ss_bck_e4_series_pantob_2cc; }
        switch(FEAT_TRAINS, PARENT, ss_bck_e4_series_pantob_mask, cargo_subtype) {0:ss_bck_e4_series_pantob_yeardep; ss_bck_e4_series_pantob_cycle; }

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e4_series_pantob_yel;       	// Base for Front
				1: ss_bck_e4_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e4_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e4_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e4_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e4_series_pantob_frt_longsprite;
            1: sw_e4_series_pantob_mid_stack;
            2: sw_e4_series_pantob_bck_longsprite;
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_formations.pnml" 1


/* Panto in middle */

    switch (FEAT_TRAINS, SELF, sw_e4_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e4_series_pantof;
            sw_e4_series_coachf;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e4_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e4_series_pantob;
            sw_e4_series_coachb;  				
        }    

/* Long */

    switch (FEAT_TRAINS, SELF, sw_e4_series_forwards_long, CarNumber() == 3 || CarNumberFromEnd()  == 4 ) {				
            0:  sw_e4_series_coachf;
            sw_e4_series_pantof;				
        }

    switch (FEAT_TRAINS, SELF, sw_e4_series_backwards_long, CarNumberFromEnd() == 3 || CarNumber()  == 4 ) {				
            0:  sw_e4_series_coachb;
            sw_e4_series_pantob;				
        }

/* Repeating 8 */

    switch (FEAT_TRAINS, SELF, sw_e4_series_forwards_multi, CarNumber() % 8 ) {				
            1:  sw_e4_series_cab01f;
            4:  sw_e4_series_pantof; 
            6:  sw_e4_series_pantof;
            0:  sw_e4_series_cab02f;
            sw_e4_series_coachf;			
        }

    switch (FEAT_TRAINS, SELF, sw_e4_series_backwards_multi, CarNumberFromEnd() % 8 ) {				
            1:  sw_e4_series_cab01b;
            4:  sw_e4_series_pantob; 
            6:  sw_e4_series_pantob;
            0:  sw_e4_series_cab02b;
            sw_e4_series_coachb;			
        }

/* Length Checks */

    switch (FEAT_TRAINS, SELF, sw_e4_series_forwards, NumberCarsInConsist() ) {				
            0..7:   sw_e4_series_forwards_panto_in_middle;  
            16:     sw_e4_series_forwards_multi;
            24:     sw_e4_series_forwards_multi;  
            sw_e4_series_forwards_long;				
        }

    switch (FEAT_TRAINS, SELF, sw_e4_series_backwards, NumberCarsInConsist() ) {				
            0..7:   sw_e4_series_backwards_panto_in_middle;  
            16:     sw_e4_series_backwards_multi;
            24:     sw_e4_series_backwards_multi;  
            sw_e4_series_backwards_long;				
        }

/* Forwards or Backwards */
    switch (FEAT_TRAINS, PARENT, sw_e4_series_midcars, vehicle_is_reversed) {				
            0:  sw_e4_series_forwards;
            sw_e4_series_backwards;				
        }

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e4_series_rear, vehicle_is_reversed) {				
            1: sw_e4_series_cab01b;
            sw_e4_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e4_series_lead, vehicle_is_reversed) {				
            1: sw_e4_series_cab02b;
            sw_e4_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e4_series_cabs, position_in_consist) {				
            0..2: sw_e4_series_lead;
            sw_e4_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e4_series_graphics, IsCab() ) {				
            1:  sw_e4_series_cabs;
            sw_e4_series_midcars;	
        }
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "src/trains/e4_series/e4_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_e4_series_articulated_part, extra_callback_info1) {
		1 .. 2: return series_e4;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

item(FEAT_TRAINS, series_e4) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E4_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,12,20);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          241 km/h;					// Operational Top Speed
		power:                          560 * 4 * 8 hp;				// Agreed to Wikipedia
		weight:                         54 * 8 tons;				// Agreed to Wikipedia 
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E4_SERIES);
        cargo_subtype_text:             sw_e4_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                54;
        purchase_power:                 563 * 4;
        /* Graphics */
        default:                        sw_e4_series_graphics;
		purchase:                       sw_e4_series_purchase;
		articulated_part:               sw_e4_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
		power:							NumberCarsInConsist() / 2 * 563 * 4;	// 420 kW = 563 hp
		weight:							NumberCarsInConsist() * 54;
		cargo_capacity:                 35 * CapacityFactor();										// 817 capacity / (8 cars * 3 parts) is approx 35						
		loading_speed:					35 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    105;
        running_cost_factor:            (295 + 120 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   295 + 120 * NumberCarsInConsist();
	}

	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e4_series_graphics;
        cargo_capacity:                 35 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  35 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
        //weight:						// Apply weight in graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e4_series_running_costs;
      }
}
# 1 "src/trains/e4_series/e4_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e5_series/e5_series.pnml" 1

# 1 "src/trains/e5_series/e5_series_menu.pnml" 1

/* SUBTYPES */ 
	switch(FEAT_TRAINS, SELF, sw_e5_series_subtype_text, cargo_subtype) {
		0: return string(LV_E5_SERIES_E5);
		1: return string(LV_E5_SERIES_H5);
		2: return string(LV_E5_SERIES_2CC);
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e5_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e5_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e5_series_buy;
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e5_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e5_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e5_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e5_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e5_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e5_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e5_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e5_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_rev(1,51)}

    // Purple

    // 10/8
	spriteset(ss_std_e5_series_cab01f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e5_series_cab01b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e5_series_cab01f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e5_series_cab01b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e5_series_cab01f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e5_series_cab01b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e5_series_cab01f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e5_series_cab01b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e5_series_cab01f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e5_series_cab01b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e5_series_cab01f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e5_series_cab01b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e5_series_cab01f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e5_series_cab01b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e5_series_cab01f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e5_series_cab01b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_cab01f_mask, cargo_subtype) {1:ss_frt_e5_series_cab01f_pur; 2:ss_frt_e5_series_cab01f_2cc; 4:ss_frt_e5_series_cab01f_pur; 5:ss_frt_e5_series_cab01f_2cc; 7:ss_frt_e5_series_cab01f_pur; 8:ss_frt_e5_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_e5_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e5_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_cab01f_mask, cargo_subtype) {1:ss_mid_e5_series_cab01f_pur; 2:ss_mid_e5_series_cab01f_2cc; 4:ss_mid_e5_series_cab01f_pur; 5:ss_mid_e5_series_cab01f_2cc; 7:ss_mid_e5_series_cab01f_pur; 8:ss_mid_e5_series_cab01f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_e5_series_cab01f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_cab01f_mask, cargo_subtype) {1:ss_std_e5_series_cab01f_pur; 2:ss_std_e5_series_cab01f_2cc; 4:ss_std_e5_series_cab01f_pur; 5:ss_std_e5_series_cab01f_2cc; 7:ss_std_e5_series_cab01f_pur; 8:ss_std_e5_series_cab01f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab01f_mask, HideLongSprite() ) { 0: sw_std_e5_series_cab01f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_cab01f_irl;       	    // Base for Mid
                1: ss_mid_e5_series_cab01f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_cab01f_irl;	    // Base for LongSprite
				3: longsprite_e5_series_cab01f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_cab01f_mask, cargo_subtype) {1:ss_bck_e5_series_cab01f_pur; 2:ss_bck_e5_series_cab01f_2cc; 4:ss_bck_e5_series_cab01f_pur; 5:ss_bck_e5_series_cab01f_2cc; 7:ss_bck_e5_series_cab01f_pur; 8:ss_bck_e5_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_cab01f_irl;       	    // Base for Front
				1: ss_bck_e5_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e5_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e5_series_cab01f_frt_longsprite;
            1: sw_e5_series_cab01f_mid_stack;
            2: sw_e5_series_cab01f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_cab01b_mask, cargo_subtype) {1:ss_frt_e5_series_cab01b_pur; 2:ss_frt_e5_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_e5_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e5_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_cab01b_mask, cargo_subtype) {1:ss_mid_e5_series_cab01b_pur; 2:ss_mid_e5_series_cab01b_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_e5_series_cab01b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_cab01b_mask, cargo_subtype) {1:ss_std_e5_series_cab01b_pur; 2:ss_std_e5_series_cab01b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab01b_mask, HideLongSprite() ) { 0: sw_std_e5_series_cab01b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_cab01b_irl;       	    // Base for Mid
                1: ss_mid_e5_series_cab01b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_cab01b_irl;	    // Base for LongSprite
				3: longsprite_e5_series_cab01b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_cab01b_mask, cargo_subtype) {1:ss_bck_e5_series_cab01b_pur; 2:ss_bck_e5_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_cab01b_irl;       	    // Base for Front
				1: ss_bck_e5_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e5_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e5_series_cab01b_frt_longsprite;
            1: sw_e5_series_cab01b_mid_stack;
            2: sw_e5_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e5_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e5_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e5_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e5_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e5_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e5_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e5_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e5_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_cab_bck_rev(1,1)}

    // Purple

    // 10/8
	spriteset(ss_std_e5_series_cab02f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e5_series_cab02b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e5_series_cab02f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e5_series_cab02b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e5_series_cab02f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e5_series_cab02b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e5_series_cab02f_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e5_series_cab02b_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e5_series_cab02f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e5_series_cab02b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e5_series_cab02f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e5_series_cab02b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e5_series_cab02f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e5_series_cab02b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e5_series_cab02f_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e5_series_cab02b_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_cab02f_mask, cargo_subtype) {1:ss_frt_e5_series_cab02f_pur; 2:ss_frt_e5_series_cab02f_2cc; 4:ss_frt_e5_series_cab02f_pur; 5:ss_frt_e5_series_cab02f_2cc; 7:ss_frt_e5_series_cab02f_pur; 8:ss_frt_e5_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_cab02f_irl;       	    // Base for Front
				1: ss_frt_e5_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e5_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_cab02f_mask, cargo_subtype) {1:ss_mid_e5_series_cab02f_pur; 2:ss_mid_e5_series_cab02f_2cc; 4:ss_mid_e5_series_cab02f_pur; 5:ss_mid_e5_series_cab02f_2cc; 7:ss_mid_e5_series_cab02f_pur; 8:ss_mid_e5_series_cab02f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_e5_series_cab02f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_cab02f_mask, cargo_subtype) {1:ss_std_e5_series_cab02f_pur; 2:ss_std_e5_series_cab02f_2cc; 4:ss_std_e5_series_cab02f_pur; 5:ss_std_e5_series_cab02f_2cc; 7:ss_std_e5_series_cab02f_pur; 8:ss_std_e5_series_cab02f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab02f_mask, HideLongSprite() ) { 0: sw_std_e5_series_cab02f_mask; }     
           
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_cab02f_irl;       	    // Base for Mid
                1: ss_mid_e5_series_cab02f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_cab02f_irl;	    // Base for LongSprite
				3: longsprite_e5_series_cab02f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_cab02f_mask, cargo_subtype) {1:ss_bck_e5_series_cab02f_pur; 2:ss_bck_e5_series_cab02f_2cc; 4:ss_bck_e5_series_cab02f_pur; 5:ss_bck_e5_series_cab02f_2cc; 7:ss_bck_e5_series_cab02f_pur; 8:ss_bck_e5_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_cab02f_irl;       	    // Base for Front
				1: ss_bck_e5_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e5_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e5_series_cab02f_frt_longsprite;
            1: sw_e5_series_cab02f_mid_stack;
            2: sw_e5_series_cab02f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_cab02b_mask, cargo_subtype) {1:ss_frt_e5_series_cab02b_pur; 2:ss_frt_e5_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_cab02b_irl;       	    // Base for Front
				1: ss_frt_e5_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e5_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_cab02b_mask, cargo_subtype) {1:ss_mid_e5_series_cab02b_pur; 2:ss_mid_e5_series_cab02b_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_e5_series_cab02b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_cab02b_mask, cargo_subtype) {1:ss_std_e5_series_cab02b_pur; 2:ss_std_e5_series_cab02b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_cab02b_mask, HideLongSprite() ) { 0: sw_std_e5_series_cab02b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_cab02b_irl;       	    // Base for Mid
                1: ss_mid_e5_series_cab02b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_cab02b_irl;	    // Base for LongSprite
				3: longsprite_e5_series_cab02b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_cab02b_mask, cargo_subtype) {1:ss_bck_e5_series_cab02b_pur; 2:ss_bck_e5_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_cab02b_irl;       	    // Base for Front
				1: ss_bck_e5_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e5_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e5_series_cab02b_frt_longsprite;
            1: sw_e5_series_cab02b_mid_stack;
            2: sw_e5_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e5_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_rev(1,101)}

    // Purple

    // 10/8
	spriteset(ss_std_e5_series_coachf_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_coachb_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_coachf_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_coachb_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_coachf_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_coachb_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_coachf_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_coachb_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e5_series_coachf_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_coachb_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_coachf_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_coachb_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_coachf_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_coachb_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_coachf_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_coachb_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_coachf_mask, cargo_subtype) {1:ss_frt_e5_series_coachf_pur; 2:ss_frt_e5_series_coachf_2cc; 4:ss_frt_e5_series_coachf_pur; 5:ss_frt_e5_series_coachf_2cc; 7:ss_frt_e5_series_coachf_pur; 8:ss_frt_e5_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_coachf_irl;       	    // Base for Front
				1: ss_frt_e5_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_e5_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_coachf_mask, cargo_subtype) {1:ss_mid_e5_series_coachf_pur; 2:ss_mid_e5_series_coachf_2cc; 4:ss_mid_e5_series_coachf_pur; 5:ss_mid_e5_series_coachf_2cc; 7:ss_mid_e5_series_coachf_pur; 8:ss_mid_e5_series_coachf_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_coachf_irl, HideLongSprite() ) { 0: ss_std_e5_series_coachf_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_coachf_mask, cargo_subtype) {1:ss_std_e5_series_coachf_pur; 2:ss_std_e5_series_coachf_2cc; 4:ss_std_e5_series_coachf_pur; 5:ss_std_e5_series_coachf_2cc; 7:ss_std_e5_series_coachf_pur; 8:ss_std_e5_series_coachf_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_coachf_mask, HideLongSprite() ) { 0: sw_std_e5_series_coachf_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_e5_series_coachf_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_e5_series_coachf_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_coachf_mask, cargo_subtype) {1:ss_bck_e5_series_coachf_pur; 2:ss_bck_e5_series_coachf_2cc; 4:ss_bck_e5_series_coachf_pur; 5:ss_bck_e5_series_coachf_2cc; 7:ss_bck_e5_series_coachf_pur; 8:ss_bck_e5_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_coachf_irl;       	    // Base for Front
				1: ss_bck_e5_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_e5_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_coachf, position_in_consist % 3 ) {				
            0: sw_e5_series_coachf_frt_longsprite;
            1: sw_e5_series_coachf_mid_stack;
            2: sw_e5_series_coachf_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_coachb_mask, cargo_subtype) {1:ss_frt_e5_series_coachb_pur; 2:ss_frt_e5_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_coachb_irl;       	    // Base for Front
				1: ss_frt_e5_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_e5_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_coachb_mask, cargo_subtype) {1:ss_mid_e5_series_coachb_pur; 2:ss_mid_e5_series_coachb_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_coachb_irl, HideLongSprite() ) { 0: ss_std_e5_series_coachb_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_coachb_mask, cargo_subtype) {1:ss_std_e5_series_coachb_pur; 2:ss_std_e5_series_coachb_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_coachb_mask, HideLongSprite() ) { 0: sw_std_e5_series_coachb_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_e5_series_coachb_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_e5_series_coachb_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_coachb_mask, cargo_subtype) {1:ss_bck_e5_series_coachb_pur; 2:ss_bck_e5_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_coachb_irl;       	    // Base for Front
				1: ss_bck_e5_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_e5_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_e5_series_coachb_frt_longsprite;
            1: sw_e5_series_coachb_mid_stack;
            2: sw_e5_series_coachb_bck_longsprite;
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e5_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_pink.png") {tmpl_bck_rev(1,101)}

    // Purple

    // 10/8
	spriteset(ss_std_e5_series_pantof_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_pantob_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_pantof_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_pantob_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_pantof_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_pantob_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_pantof_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_pantob_pur, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5_series/gfx/e5_series_purple.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e5_series_pantof_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e5_series_pantob_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e5_series_pantof_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e5_series_pantob_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e5_series_pantof_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e5_series_pantob_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e5_series_pantof_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e5_series_pantob_2cc, "src/trains/e5_series/gfx/e5_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_pantof_mask, cargo_subtype) {1:ss_frt_e5_series_pantof_pur; 2:ss_frt_e5_series_pantof_2cc; 4:ss_frt_e5_series_pantof_pur; 5:ss_frt_e5_series_pantof_2cc; 7:ss_frt_e5_series_pantof_pur; 8:ss_frt_e5_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_pantof_irl;       	    // Base for Front
				1: ss_frt_e5_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e5_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_pantof_mask, cargo_subtype) {1:ss_mid_e5_series_pantof_pur; 2:ss_mid_e5_series_pantof_2cc; 4:ss_mid_e5_series_pantof_pur; 5:ss_mid_e5_series_pantof_2cc; 7:ss_mid_e5_series_pantof_pur; 8:ss_mid_e5_series_pantof_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_pantof_irl, HideLongSprite() ) { 0: ss_std_e5_series_pantof_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_pantof_mask, cargo_subtype) {1:ss_std_e5_series_pantof_pur; 2:ss_std_e5_series_pantof_2cc; 4:ss_std_e5_series_pantof_pur; 5:ss_std_e5_series_pantof_2cc; 7:ss_std_e5_series_pantof_pur; 8:ss_std_e5_series_pantof_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_pantof_mask, HideLongSprite() ) { 0: sw_std_e5_series_pantof_mask; }      
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_pantof_irl;       	    // Base for Mid
                1: ss_mid_e5_series_pantof_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_pantof_irl;	        // Base for LongSprite
				3: longsprite_e5_series_pantof_mask;        // Masks for LongSprite
                // Pantos
                4: panto_midsprite_e5_f;
                5: panto_longsprite_e5_f;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_pantof_mask, cargo_subtype) {1:ss_bck_e5_series_pantof_pur; 2:ss_bck_e5_series_pantof_2cc; 4:ss_bck_e5_series_pantof_pur; 5:ss_bck_e5_series_pantof_2cc; 7:ss_bck_e5_series_pantof_pur; 8:ss_bck_e5_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_pantof_irl;       	    // Base for Front
				1: ss_bck_e5_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e5_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_pantof, position_in_consist % 3 ) {				
            0: sw_e5_series_pantof_frt_longsprite;
            1: sw_e5_series_pantof_mid_stack;
            2: sw_e5_series_pantof_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e5_series_pantob_mask, cargo_subtype) {1:ss_frt_e5_series_pantob_pur; 2:ss_frt_e5_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e5_series_pantob_irl;       	    // Base for Front
				1: ss_frt_e5_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e5_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e5_series_pantob_mask, cargo_subtype) {1:ss_mid_e5_series_pantob_pur; 2:ss_mid_e5_series_pantob_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_pantob_irl, HideLongSprite() ) { 0: ss_std_e5_series_pantob_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e5_series_pantob_mask, cargo_subtype) {1:ss_std_e5_series_pantob_pur; 2:ss_std_e5_series_pantob_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e5_series_pantob_mask, HideLongSprite() ) { 0: sw_std_e5_series_pantob_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e5_series_pantob_irl;       	    // Base for Mid
                1: ss_mid_e5_series_pantob_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e5_series_pantob_irl;	        // Base for LongSprite
				3: longsprite_e5_series_pantob_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_e5_b;
                5: panto_longsprite_e5_b;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e5_series_pantob_mask, cargo_subtype) {1:ss_bck_e5_series_pantob_pur; 2:ss_bck_e5_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e5_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e5_series_pantob_irl;       	    // Base for Front
				1: ss_bck_e5_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e5_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e5_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e5_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e5_series_pantob_frt_longsprite;
            1: sw_e5_series_pantob_mid_stack;
            2: sw_e5_series_pantob_bck_longsprite;
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_formations.pnml" 1

 /* Panto in middle */

    switch (FEAT_TRAINS, SELF, sw_e5_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e5_series_pantof;
            sw_e5_series_coachf;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e5_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e5_series_pantob;
            sw_e5_series_coachb;  				
        }       

 /* Long */

    switch (FEAT_TRAINS, SELF, sw_e5_series_forwards_length_large, CarNumber() == 3 || CarNumberFromEnd()  == 4 ) {				
			1:  sw_e5_series_pantof; 
            sw_e5_series_coachf;					
		}       

    switch (FEAT_TRAINS, SELF, sw_e5_series_backwards_length_large, CarNumberFromEnd() == 3 || CarNumber()  == 4 ) {				
			1:  sw_e5_series_pantob; 
            sw_e5_series_coachb;					
		}    
    
/* Direction & Length Checks */    
    
    switch (FEAT_TRAINS, SELF, sw_e5_series_backwards_length, NumberCarsInConsist()  < 10 ) {				
			0:  sw_e5_series_backwards_length_large;
			sw_e5_series_backwards_panto_in_middle;				
		}
    
    switch (FEAT_TRAINS, SELF, sw_e5_series_forwards_length, NumberCarsInConsist()  < 10 ) {				
			0:  sw_e5_series_forwards_length_large;
			sw_e5_series_forwards_panto_in_middle;				
		}

	switch (FEAT_TRAINS, PARENT, sw_e5_series_midcars, vehicle_is_reversed) {				
			0:  sw_e5_series_forwards_length;
			sw_e5_series_backwards_length;				
		}

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e5_series_rear, vehicle_is_reversed) {				
            1: sw_e5_series_cab01b;
            sw_e5_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e5_series_lead, vehicle_is_reversed) {				
            1: sw_e5_series_cab02b;
            sw_e5_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e5_series_cabs, position_in_consist) {				
            0..2: sw_e5_series_lead;
            sw_e5_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e5_series_graphics, IsCab() ) {				
            1:  sw_e5_series_cabs;
            sw_e5_series_midcars;	
        }
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "src/trains/e5_series/e5_series_item.pnml" 1

/*---Articulation---*/
	switch (FEAT_TRAINS, SELF, sw_e5_series_articulated_part, extra_callback_info1) {
			1 .. 2: return series_e5;									
			return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
		}


item(FEAT_TRAINS, series_e5) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E5_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          321 km/h;					// Operational Top Speed
		power:                          1290 hp;					// Overwritten by callback
		weight:                         45;
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_E5_SERIES);
		cargo_subtype_text:             sw_e5_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                45;
        purchase_power:                 402 * 4;
		/* Graphics */
		default:                        sw_e5_series_graphics;
		purchase:                       sw_e5_series_purchase;
		articulated_part:               sw_e5_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
		power:							max ((NumberCarsInConsist() - 2 ),0) * 402 * 4 ;
		weight:							NumberCarsInConsist() * 45;
		cargo_capacity:                 25 * CapacityFactor();										// 731 capacity / (10 cars * 3 parts) is approx 25						
		loading_speed:					25 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            (298 + 127 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   298 + 127 * NumberCarsInConsist();	
	}

	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e5_series_graphics;
        cargo_capacity:                 25 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  25 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e5_series_running_costs;
      }
}
# 1 "src/trains/e5_series/e5_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e6_series/e6_series.pnml" 1

# 1 "src/trains/e6_series/e6_series_menu.pnml" 1

/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_e6_series_subtype_text, cargo_subtype) {
		0: return string(LV_E6_SERIES_ORIGINAL);                     
		1: return string(LV_E6_SERIES_2CC);                      
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e6_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e6_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e6_series_buy;
        }
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_cab01.pnml" 1
/* cab01 */

spriteset(ss_mid_e6_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e6_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e6_series_cab01f_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e6_series_cab01b_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e6_series_cab01f_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e6_series_cab01b_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_mid_rev(1,51)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab01f_mask_e6, cargo_subtype) {1: ss_mid_e6_series_cab01f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab01f_mask_e5e6, cargo_subtype) {2:ss_mid_e6_series_cab01f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab01f_mask, vehicle_type_id) {2006:ss_mid_e6_series_cab01f_mask_e6; 2056:ss_mid_e6_series_cab01f_mask_e5e6; }

    switch(FEAT_TRAINS, SELF, sw_e6_series_cab01f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_e6_series_cab01f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab01b_mask, cargo_subtype) {1: ss_mid_e6_series_cab01b_2cc; 2:ss_mid_e6_series_cab01b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e6_series_cab01b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_e6_series_cab01b_mask;		// Mask for Mid
			}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_cab02.pnml" 1
/* cab02 */

spriteset(ss_mid_e6_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e6_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e6_series_cab02f_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e6_series_cab02b_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e6_series_cab02f_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_std(1,151)}
spriteset(ss_mid_e6_series_cab02b_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab02f_mask_e6, cargo_subtype) {1: ss_mid_e6_series_cab02f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab02f_mask_e5e6, cargo_subtype) {2:ss_mid_e6_series_cab02f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab02f_mask, vehicle_type_id) {2006:ss_mid_e6_series_cab02f_mask_e6; 2056:ss_mid_e6_series_cab02f_mask_e5e6; }

    switch(FEAT_TRAINS, SELF, sw_e6_series_cab02f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_e6_series_cab02f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_cab02b_mask, cargo_subtype) {1: ss_mid_e6_series_cab02b_2cc; 2:ss_mid_e6_series_cab02b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e6_series_cab02b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_e6_series_cab02b_mask;		// Mask for Mid
			}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_coach.pnml" 1
/* coach */

spriteset(ss_mid_e6_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e6_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e6_series_coachf_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_std(1,251)}
spriteset(ss_mid_e6_series_coachb_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_rev(1,251)}

spriteset(ss_mid_e6_series_coachf_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_std(1,251)}
spriteset(ss_mid_e6_series_coachb_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_rev(1,251)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_coachf_mask_e6, cargo_subtype) {1: ss_mid_e6_series_coachf_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_coachf_mask_e5e6, cargo_subtype) {2:ss_mid_e6_series_coachf_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_coachf_mask, vehicle_type_id) {2006:ss_mid_e6_series_coachf_mask_e6; 2056:ss_mid_e6_series_coachf_mask_e5e6; }

    switch(FEAT_TRAINS, SELF, sw_e6_series_coachf, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_coachf_irl;       	// Base for Mid
				1: ss_mid_e6_series_coachf_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_coachb_mask, cargo_subtype) {1: ss_mid_e6_series_coachb_2cc; 2:ss_mid_e6_series_coachb_grn;}

    switch(FEAT_TRAINS, SELF, sw_e6_series_coachb, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_coachb_irl;       	// Base for Mid
				1: ss_mid_e6_series_coachb_mask;		// Mask for Mid
			}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_pant1.pnml" 1
/* pant1 */

spriteset(ss_mid_e6_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e6_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e6_series_pant1f_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_std(1,201)}
spriteset(ss_mid_e6_series_pant1b_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_rev(1,201)}

spriteset(ss_mid_e6_series_pant1f_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_std(1,201)}
spriteset(ss_mid_e6_series_pant1b_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_rev(1,201)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant1f_mask_e6, cargo_subtype) {1: ss_mid_e6_series_pant1f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant1f_mask_e5e6, cargo_subtype) {2:ss_mid_e6_series_pant1f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant1f_mask, vehicle_type_id) {2006:ss_mid_e6_series_pant1f_mask_e6; 2056:ss_mid_e6_series_pant1f_mask_e5e6; }

    switch(FEAT_TRAINS, SELF, sw_e6_series_pant1f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_pant1f_irl;       	// Base for Mid
				1: ss_mid_e6_series_pant1f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant1b_mask, cargo_subtype) {1: ss_mid_e6_series_pant1b_2cc; 2:ss_mid_e6_series_pant1b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e6_series_pant1b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_pant1b_irl;       	// Base for Mid
				1: ss_mid_e6_series_pant1b_mask;		// Mask for Mid
			}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_pant2.pnml" 1
/* pant2 */

spriteset(ss_mid_e6_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e6_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e6_series/gfx/e6_series.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e6_series_pant2f_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_std(1,301)}
spriteset(ss_mid_e6_series_pant2b_2cc, "src/trains/e6_series/gfx/e6_series_2cc.png") {tmpl_mid_rev(1,301)}

spriteset(ss_mid_e6_series_pant2f_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_std(1,301)}
spriteset(ss_mid_e6_series_pant2b_grn, "src/trains/e6_series/gfx/e6_series_green.png") {tmpl_cab_mid_rev(1,301)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant2f_mask_e6, cargo_subtype) {1: ss_mid_e6_series_pant2f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant2f_mask_e5e6, cargo_subtype) {2:ss_mid_e6_series_pant2f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant2f_mask, vehicle_type_id) {2006:ss_mid_e6_series_pant2f_mask_e6; 2056:ss_mid_e6_series_pant2f_mask_e5e6; }

    switch(FEAT_TRAINS, SELF, sw_e6_series_pant2f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_pant2f_irl;       	// Base for Mid
				1: ss_mid_e6_series_pant2f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e6_series_pant2b_mask, cargo_subtype) {1: ss_mid_e6_series_pant2b_2cc; 2:ss_mid_e6_series_pant2b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e6_series_pant2b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e6_series_pant2b_irl;       	// Base for Mid
				1: ss_mid_e6_series_pant2b_mask;		// Mask for Mid
			}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_formations.pnml" 1

/* Midcars */
    // Backwards
        // Penultipantos
        switch (FEAT_TRAINS, SELF, sw_e6_series_pantos_large_backwards, position_in_consist_from_end ) {
                1:  sw_e6_series_pant1b;
                sw_e6_series_pant2b;				
            }
        switch (FEAT_TRAINS, SELF, sw_e6_series_backwards_length_large, (position_in_consist == 1) || (position_in_consist_from_end == 1 )) {				
                1:  sw_e6_series_pantos_large_backwards;
                sw_e6_series_coachb;			
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_e6_series_backwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_e6_series_coachb;
                sw_e6_series_pant1b;				
            }
	switch (FEAT_TRAINS, SELF, sw_e6_series_backwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_e6_series_backwards_length_large;
			sw_e6_series_backwards_length_small;				
		}
	// Forwards
        // Penultipantos
        switch (FEAT_TRAINS, SELF, sw_e6_series_pantos_large_forwards, position_in_consist ) {				
                1:  sw_e6_series_pant1f;
                sw_e6_series_pant2f;				
            }

        switch (FEAT_TRAINS, SELF, sw_e6_series_forwards_length_large, (position_in_consist == 1) || (position_in_consist_from_end == 1 )) {				
                1:  sw_e6_series_pantos_large_forwards;
                sw_e6_series_coachf;		
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_e6_series_forwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_e6_series_coachf;
                sw_e6_series_pant1f;				
            }
	switch (FEAT_TRAINS, SELF, sw_e6_series_forwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_e6_series_forwards_length_large;
			sw_e6_series_forwards_length_small;				
		}

	switch (FEAT_TRAINS, PARENT, sw_e6_series_midcars, vehicle_is_reversed) {				
			0:  sw_e6_series_forwards_length;
			sw_e6_series_backwards_length;				
		}

/* Cab selection */
    // Rear cab
    switch (FEAT_TRAINS, PARENT, sw_e6_series_rear, vehicle_is_reversed) {				
            1:  sw_e6_series_cab01b;                   // cab01	
            sw_e6_series_cab02f;                       // cab02
        }

    // Lead cab
    switch (FEAT_TRAINS, PARENT, sw_e6_series_lead, vehicle_is_reversed) {				
            1:  sw_e6_series_cab02b;                   // cab02
            sw_e6_series_cab01f;                       // cab01	
        }

/* Find the cabs */
    switch (FEAT_TRAINS, SELF, sw_e6_series_lead_or_rear, position_in_consist) {				
            0:  sw_e6_series_lead;
            sw_e6_series_rear;				
        }
    
    switch (FEAT_TRAINS, SELF, sw_e6_series_graphics, position_in_consist == 0 || position_in_consist_from_end == 0 ) {				
            1:  sw_e6_series_lead_or_rear;
            sw_e6_series_midcars;				
        }
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "src/trains/e6_series/e6_series_item.pnml" 1

/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e6, 2006) {
    property {
        name:                           string(STR_NAME_E6_SERIES);
        introduction_date:              date(2013,03,16);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   24;
        reliability_decay:              23;

        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;

        speed:                          321 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         42 ton;

        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_SPRITE_STACK);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        //dual_headed:                    1;
        ai_engine_rank:                 0;

        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);

        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e6_series_graphics;
		    purchase:                       sw_e6_series_purchase;
		    additional_text:	              return string(STR_DESC_E6_SERIES);
        cargo_subtype_text:             sw_e6_series_subtype_text;
        can_attach_wagon:			          sw_attach_mu_car_ms;
        //start_stop:                   ;
        purchase_weight:                42 / 2;
        purchase_power:                 400 * 4;
        /* Stats */
        power:                          max (num_vehs_in_consist - 2 , 0 ) * 400 * 4;
        weight:                         42 * num_vehs_in_consist;
        cargo_capacity:                 48 * CapacityFactor();										        // 338 capacity / 7 cars  is approx 48						
		    loading_speed:					        48 * CapacityFactor() / param_loading_1D;					// Capacity divided by door loading factor
        cargo_age_period:				        param_decay_express;
        running_cost_factor:            (450 + 127 * num_vehs_in_consist ) * RunningCostFactor();
        purchase_running_cost_factor:   (450 + 127) / 2;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e6_series_graphics;
        cargo_capacity:                 48 * CapacityFactor();
        cargo_age_period:				        param_decay_express;
        loading_speed:                  48 * CapacityFactor() / param_loading_1D;
        //cargo_subtype_text:           sw_e6_series_subtypetext_mucar;
        //power:                        // Apply power in graphics block to calculate power based on number of motorised cars correctly
        //weight:                         42;
        //running_cost_factor:            120;
      }
}
# 1 "src/trains/e6_series/e6_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e7_series/e7_series.pnml" 1

# 1 "src/trains/e7_series/e7_series_menu.pnml" 1
/* SUBTYPES */

    switch(FEAT_TRAINS, SELF, sw_e7_series_subtype_text, cargo_subtype) {
        0: return string(LV_E7_SERIES_E7);
	    1: return string(LV_E7_SERIES_W7);
        2: return string(LV_E7_SERIES_2CC);
        return CB_RESULT_NO_TEXT;
        }

/* Purchase Menu */
    spriteset (ss_e7_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e7_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e7_series_buy;
        }
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e7_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e7_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e7_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e7_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e7_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e7_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e7_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e7_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_rev(1,51)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e7_series_cab01f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e7_series_cab01b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e7_series_cab01f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e7_series_cab01b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e7_series_cab01f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e7_series_cab01b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e7_series_cab01f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e7_series_cab01b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_cab01f_mask, cargo_subtype) {2:ss_frt_e7_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_cab01f_irl;       	// Base for Front
				1: ss_frt_e7_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e7_series_cab01f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_cab01f_mask, cargo_subtype) {2:ss_mid_e7_series_cab01f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_cab01f_mask, cargo_subtype) {2:ss_std_e7_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab01f_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab01f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_e7_series_cab01f_mask;		// Mask for Mid
				2: sw_e7_series_cab01f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_cab01f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_cab01f_mask, cargo_subtype) {2:ss_bck_e7_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_cab01f_irl;       	// Base for Front
				1: ss_bck_e7_series_cab01f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e7_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e7_series_cab01f_frt_longsprite;
            1: sw_e7_series_cab01f_mid_stack;
            2: sw_e7_series_cab01f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_cab01b_mask, cargo_subtype) {2:ss_frt_e7_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_cab01b_irl;       	// Base for Front
				1: ss_frt_e7_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e7_series_cab01b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_cab01b_mask, cargo_subtype) {2:ss_mid_e7_series_cab01b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_cab01b_mask, cargo_subtype) {2:ss_std_e7_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab01b_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab01b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_e7_series_cab01b_mask;		// Mask for Mid
				2: sw_e7_series_cab01b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_cab01b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_cab01b_mask, cargo_subtype) {2:ss_bck_e7_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_cab01b_irl;       	// Base for Front
				1: ss_bck_e7_series_cab01b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e7_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e7_series_cab01b_frt_longsprite;
            1: sw_e7_series_cab01b_mid_stack;
            2: sw_e7_series_cab01b_bck_longsprite;
        }
		
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e7_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e7_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e7_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e7_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e7_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e7_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e7_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e7_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e7_series_cab02f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e7_series_cab02b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e7_series_cab02f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e7_series_cab02b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e7_series_cab02f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e7_series_cab02b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e7_series_cab02f_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e7_series_cab02b_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_cab02f_mask, cargo_subtype) {2:ss_frt_e7_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_cab02f_irl;       	// Base for Front
				1: ss_frt_e7_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e7_series_cab02f_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_cab02f_mask, cargo_subtype) {2:ss_mid_e7_series_cab02f_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_cab02f_mask, cargo_subtype) {2:ss_std_e7_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab02f_irl; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab02f_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_e7_series_cab02f_mask;		// Mask for Mid
				2: sw_e7_series_cab02f_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_cab02f_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_cab02f_mask, cargo_subtype) {2:ss_bck_e7_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_cab02f_irl;       	// Base for Front
				1: ss_bck_e7_series_cab02f_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e7_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e7_series_cab02f_frt_longsprite;
            1: sw_e7_series_cab02f_mid_stack;
            2: sw_e7_series_cab02f_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_cab02b_mask, cargo_subtype) {2:ss_frt_e7_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_cab02b_irl;       	// Base for Front
				1: ss_frt_e7_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e7_series_cab02b_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_cab02b_mask, cargo_subtype) {2:ss_mid_e7_series_cab02b_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_cab02b_mask, cargo_subtype) {2:ss_std_e7_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab02b_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_cab02b_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_e7_series_cab02b_mask;		// Mask for Mid
				2: sw_e7_series_cab02b_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_cab02b_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_cab02b_mask, cargo_subtype) {2:ss_bck_e7_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_cab02b_irl;       	// Base for Front
				1: ss_bck_e7_series_cab02b_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e7_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e7_series_cab02b_frt_longsprite;
            1: sw_e7_series_cab02b_mid_stack;
            2: sw_e7_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e7_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e7_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e7_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e7_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e7_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e7_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e7_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e7_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e7_series_coachf_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e7_series_coachb_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e7_series_coachf_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e7_series_coachb_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e7_series_coachf_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e7_series_coachb_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e7_series_coachf_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e7_series_coachb_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_coachf_mask, cargo_subtype) {2:ss_frt_e7_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_coachf_irl;       	// Base for Front
				1: ss_frt_e7_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_e7_series_coachf_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_coachf_mask, cargo_subtype) {2:ss_mid_e7_series_coachf_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_coachf_mask, cargo_subtype) {2:ss_std_e7_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_coachf_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_coachf_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_coachf_irl;       	// Base for Mid
				1: ss_mid_e7_series_coachf_mask;		// Mask for Mid
				2: sw_e7_series_coachf_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_coachf_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_coachf_mask, cargo_subtype) {2:ss_bck_e7_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_coachf_irl;       	// Base for Front
				1: ss_bck_e7_series_coachf_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_e7_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_coachf, position_in_consist % 3 ) {				
            0: sw_e7_series_coachf_frt_longsprite;
            1: sw_e7_series_coachf_mid_stack;
            2: sw_e7_series_coachf_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_coachb_mask, cargo_subtype) {2:ss_frt_e7_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_coachb_irl;       	// Base for Front
				1: ss_frt_e7_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_e7_series_coachb_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_coachb_mask, cargo_subtype) {2:ss_mid_e7_series_coachb_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_coachb_mask, cargo_subtype) {2:ss_std_e7_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_coachb_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_coachb_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_coachb_irl;       	// Base for Mid
				1: ss_mid_e7_series_coachb_mask;		// Mask for Mid
				2: sw_e7_series_coachb_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_coachb_std_longsprite;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_coachb_mask, cargo_subtype) {2:ss_bck_e7_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_coachb_irl;       	// Base for Front
				1: ss_bck_e7_series_coachb_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_e7_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_e7_series_coachb_frt_longsprite;
            1: sw_e7_series_coachb_mid_stack;
            2: sw_e7_series_coachb_bck_longsprite;
        }
		
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e7_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e7_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e7_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e7_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e7_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e7_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e7_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e7_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e7_series/gfx/e7_series.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e7_series_pantof_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e7_series_pantob_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e7_series_pantof_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e7_series_pantob_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e7_series_pantof_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e7_series_pantob_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e7_series_pantof_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e7_series_pantob_2cc, "src/trains/e7_series/gfx/e7_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_pantof_mask, cargo_subtype) {2:ss_frt_e7_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_pantof_irl;       	// Base for Front
				1: ss_frt_e7_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e7_series_pantof_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_pantof_mask, cargo_subtype) {2:ss_mid_e7_series_pantof_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_pantof_mask, cargo_subtype) {2:ss_std_e7_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_pantof_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_pantof_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_pantof_irl;       	// Base for Mid
				1: ss_mid_e7_series_pantof_mask;		// Mask for Mid
				2: sw_e7_series_pantof_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_pantof_std_longsprite;
                // Pantos
                4: panto_midsprite_e7_f;
                5: panto_longsprite_e7_f;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_pantof_mask, cargo_subtype) {2:ss_bck_e7_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_pantof_irl;       	// Base for Front
				1: ss_bck_e7_series_pantof_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e7_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_pantof, position_in_consist % 3 ) {				
            0: sw_e7_series_pantof_frt_longsprite;
            1: sw_e7_series_pantof_mid_stack;
            2: sw_e7_series_pantof_bck_longsprite;
        }

	// Backwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e7_series_pantob_mask, cargo_subtype) {2:ss_frt_e7_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e7_series_pantob_irl;       	// Base for Front
				1: ss_frt_e7_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e7_series_pantob_frt_stack; dummy_sprites; }

		// Mid
		switch(FEAT_TRAINS, PARENT, ss_mid_e7_series_pantob_mask, cargo_subtype) {2:ss_mid_e7_series_pantob_2cc; }
		switch(FEAT_TRAINS, PARENT, ss_std_e7_series_pantob_mask, cargo_subtype) {2:ss_std_e7_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_mid_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_pantob_irl; }
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_std_longsprite, HideLongSprite() ) { 0: ss_std_e7_series_pantob_mask; }

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e7_series_pantob_irl;       	// Base for Mid
				1: ss_mid_e7_series_pantob_mask;		// Mask for Mid
				2: sw_e7_series_pantob_mid_longsprite;	// Long Sprite for Corners and Hills
				3: sw_e7_series_pantob_std_longsprite;
                // Pantos
                4: panto_midsprite_e7_b;
                5: panto_longsprite_e7_b;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e7_series_pantob_mask, cargo_subtype) {2:ss_bck_e7_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e7_series_pantob_irl;       	// Base for Front
				1: ss_bck_e7_series_pantob_mask;		// Mask for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e7_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e7_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e7_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e7_series_pantob_frt_longsprite;
            1: sw_e7_series_pantob_mid_stack;
            2: sw_e7_series_pantob_bck_longsprite;
        }
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_formations.pnml" 1

 /* Panto in middle */

    switch (FEAT_TRAINS, SELF, sw_e7_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e7_series_pantof;
            sw_e7_series_coachf;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e7_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e7_series_pantob;
            sw_e7_series_coachb;  				
        }       

 /* Long */

    switch (FEAT_TRAINS, SELF, sw_e7_series_forwards_length_large, CarNumber() == 3 || CarNumberFromEnd()  == 4 ) {				
			1:  sw_e7_series_pantof; 
            sw_e7_series_coachf;					
		}       

    switch (FEAT_TRAINS, SELF, sw_e7_series_backwards_length_large, CarNumberFromEnd() == 3 || CarNumber()  == 4 ) {				
			1:  sw_e7_series_pantob; 
            sw_e7_series_coachb;					
		}    
    
/* Direction & Length Checks */    
    
    switch (FEAT_TRAINS, SELF, sw_e7_series_backwards_length, num_vehs_in_consist < 30 ) {				
			0:  sw_e7_series_backwards_length_large;
			sw_e7_series_backwards_panto_in_middle;				
		}
    
    switch (FEAT_TRAINS, SELF, sw_e7_series_forwards_length, num_vehs_in_consist < 30 ) {				
			0:  sw_e7_series_forwards_length_large;
			sw_e7_series_forwards_panto_in_middle;				
		}

	switch (FEAT_TRAINS, PARENT, sw_e7_series_midcars, vehicle_is_reversed) {				
			0:  sw_e7_series_forwards_length;
			sw_e7_series_backwards_length;				
		}

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e7_series_rear, vehicle_is_reversed) {				
            1: sw_e7_series_cab01b;
            sw_e7_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e7_series_lead, vehicle_is_reversed) {				
            1: sw_e7_series_cab02b;
            sw_e7_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e7_series_cabs, position_in_consist) {				
            0..2: sw_e7_series_lead;
            sw_e7_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e7_series_graphics, IsCab() ) {				
            1:  sw_e7_series_cabs;
            sw_e7_series_midcars;	
        }
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "src/trains/e7_series/e7_series_item.pnml" 1

	switch (FEAT_TRAINS, SELF, sw_e7_series_articulated_part, extra_callback_info1) {
			1 .. 2: return series_e7;									
			return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
		}


item(FEAT_TRAINS, series_e7) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E7_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2014,03,15);
		model_life:                     VEHICLE_NEVER_EXPIRES;
		vehicle_life:                   30;
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;                          // Overwritten by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          275 km/h;				    // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen
		power:                          12000 kW;                   // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen					
		weight:                         540 tons;	                // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen				
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E7_SERIES);
        cargo_subtype_text:             sw_e7_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                45;
        purchase_power:                 335 * 4;
        /* Graphics */
        default:                        sw_e7_series_graphics;
		purchase:                       sw_e7_series_purchase;
		articulated_part:               sw_e7_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_1_8_1;
        power:                          max ((NumberCarsInConsist() - 2 ),0) * 335 * 4;
        weight:                         NumberCarsInConsist() * 45;
		cargo_capacity:                 26 * CapacityFactor();										// 934 capacity / (12 cars * 3 parts) is approx 26						
		loading_speed:					26 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    130;
		running_cost_factor:            (295 + 120 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   295 + 120 * NumberCarsInConsist();	
	}

	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e7_series_graphics;
        cargo_capacity:                 26 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  26 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e7_series_running_costs;
      }
}
# 1 "src/trains/e7_series/e7_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e8_series/e8_series.pnml" 1

# 1 "src/trains/e8_series/e8_series_menu.pnml" 1
/* Subtypes */

	switch(FEAT_TRAINS, SELF, sw_e8_series_subtype_text, cargo_subtype) {
		0: return string(LV_E8_SERIES_ORIGINAL);                     
		1: return string(LV_E8_SERIES_2CC);                      
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e8_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e8_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e8_series_buy;
        }
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_cab01.pnml" 1
/* cab01 */

spriteset(ss_mid_e8_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e8_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e8_series_cab01f_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e8_series_cab01b_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_rev(1,51)}

spriteset(ss_mid_e8_series_cab01f_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_std(1,1)}
spriteset(ss_mid_e8_series_cab01b_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_rev(1,51)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab01f_mask_e8, cargo_subtype) {1: ss_mid_e8_series_cab01f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab01f_mask_e5e8, cargo_subtype) {2:ss_mid_e8_series_cab01f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab01f_mask, vehicle_type_id) {2008:ss_mid_e8_series_cab01f_mask_e8; 2058:ss_mid_e8_series_cab01f_mask_e5e8; }

    switch(FEAT_TRAINS, SELF, sw_e8_series_cab01f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_cab01f_irl;       	// Base for Mid
				1: ss_mid_e8_series_cab01f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab01b_mask, cargo_subtype) {1: ss_mid_e8_series_cab01b_2cc; 2:ss_mid_e8_series_cab01b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e8_series_cab01b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_cab01b_irl;       	// Base for Mid
				1: ss_mid_e8_series_cab01b_mask;		// Mask for Mid
			}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_cab02.pnml" 1
/* cab02 */

spriteset(ss_mid_e8_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_e8_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_cab_mid_rev(1,1)}

spriteset(ss_mid_e8_series_cab02f_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_e8_series_cab02b_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_cab_mid_rev(1,1)}

spriteset(ss_mid_e8_series_cab02f_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_cab_mid_std(1,51)}
spriteset(ss_mid_e8_series_cab02b_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_cab_mid_rev(1,1)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab02f_mask_e8, cargo_subtype) {1: ss_mid_e8_series_cab02f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab02f_mask_e5e8, cargo_subtype) {2:ss_mid_e8_series_cab02f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab02f_mask, vehicle_type_id) {2008:ss_mid_e8_series_cab02f_mask_e8; 2058:ss_mid_e8_series_cab02f_mask_e5e8; }

    switch(FEAT_TRAINS, SELF, sw_e8_series_cab02f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_cab02f_irl;       	// Base for Mid
				1: ss_mid_e8_series_cab02f_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_cab02b_mask, cargo_subtype) {1: ss_mid_e8_series_cab02b_2cc; 2:ss_mid_e8_series_cab02b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e8_series_cab02b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_cab02b_irl;       	// Base for Mid
				1: ss_mid_e8_series_cab02b_mask;		// Mask for Mid
			}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_coach.pnml" 1
/* coach */

spriteset(ss_mid_e8_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_std(1,151)}
spriteset(ss_mid_e8_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_rev(1,151)}

spriteset(ss_mid_e8_series_coachf_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_std(1,151)}
spriteset(ss_mid_e8_series_coachb_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_rev(1,151)}

spriteset(ss_mid_e8_series_coachf_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_std(1,151)}
spriteset(ss_mid_e8_series_coachb_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_rev(1,151)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_coachf_mask_e8, cargo_subtype) {1: ss_mid_e8_series_coachf_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_coachf_mask_e5e8, cargo_subtype) {2:ss_mid_e8_series_coachf_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_coachf_mask, vehicle_type_id) {2008:ss_mid_e8_series_coachf_mask_e8; 2058:ss_mid_e8_series_coachf_mask_e5e8; }

    switch(FEAT_TRAINS, SELF, sw_e8_series_coachf, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_coachf_irl;       	// Base for Mid
				1: ss_mid_e8_series_coachf_mask;		// Mask for Mid
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_coachb_mask, cargo_subtype) {1: ss_mid_e8_series_coachb_2cc; 2:ss_mid_e8_series_coachb_grn;}

    switch(FEAT_TRAINS, SELF, sw_e8_series_coachb, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_coachb_irl;       	// Base for Mid
				1: ss_mid_e8_series_coachb_mask;		// Mask for Mid
			}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_pant1.pnml" 1
/* pant1 */

spriteset(ss_mid_e8_series_pant1f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant1b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_e8_series_pant1f_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant1b_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_mid_rev(1,101)}

spriteset(ss_mid_e8_series_pant1f_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant1b_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant1f_mask_e8, cargo_subtype) {1: ss_mid_e8_series_pant1f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant1f_mask_e5e8, cargo_subtype) {2:ss_mid_e8_series_pant1f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant1f_mask, vehicle_type_id) {2008:ss_mid_e8_series_pant1f_mask_e8; 2058:ss_mid_e8_series_pant1f_mask_e5e8; }

    switch(FEAT_TRAINS, SELF, sw_e8_series_pant1f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_pant1f_irl;       	// Base for Mid
				1: ss_mid_e8_series_pant1f_mask;		// Mask for Mid
				2: panto_midsprite_e8_f;				// Panto
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant1b_mask, cargo_subtype) {1: ss_mid_e8_series_pant1b_2cc; 2:ss_mid_e8_series_pant1b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e8_series_pant1b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_pant1b_irl;       	// Base for Mid
				1: ss_mid_e8_series_pant1b_mask;		// Mask for Mid
				2: panto_midsprite_e8_b;				// Panto
			}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_pant2.pnml" 1
/* pant2 */

spriteset(ss_mid_e8_series_pant2f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_cab_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant2b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e8_series/gfx/e8_series.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e8_series_pant2f_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_cab_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant2b_2cc, "src/trains/e8_series/gfx/e8_series_2cc.png") {tmpl_cab_mid_rev(1,101)}

spriteset(ss_mid_e8_series_pant2f_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_cab_mid_std(1,101)}
spriteset(ss_mid_e8_series_pant2b_grn, "src/trains/e8_series/gfx/e8_series_green.png") {tmpl_cab_mid_rev(1,101)}

// FORWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant2f_mask_e8, cargo_subtype) {1: ss_mid_e8_series_pant2f_2cc; }
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant2f_mask_e5e8, cargo_subtype) {2:ss_mid_e8_series_pant2f_grn;}
	
	switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant2f_mask, vehicle_type_id) {2008:ss_mid_e8_series_pant2f_mask_e8; 2058:ss_mid_e8_series_pant2f_mask_e5e8; }

    switch(FEAT_TRAINS, SELF, sw_e8_series_pant2f, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_pant2f_irl;       	// Base for Mid
				1: ss_mid_e8_series_pant2f_mask;		// Mask for Mid
                2: panto_midsprite_e8_b;				// Panto
			}

// BACKWARDS

    switch(FEAT_TRAINS, PARENT, ss_mid_e8_series_pant2b_mask, cargo_subtype) {1: ss_mid_e8_series_pant2b_2cc; 2:ss_mid_e8_series_pant2b_grn;}

    switch(FEAT_TRAINS, SELF, sw_e8_series_pant2b, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_mid_e8_series_pant2b_irl;       	// Base for Mid
				1: ss_mid_e8_series_pant2b_mask;		// Mask for Mid
                2: panto_midsprite_e8_f;				// Panto
			}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_formations.pnml" 1

/* Midcars */
    // Backwards
        // Penultipantos
        switch (FEAT_TRAINS, SELF, sw_e8_series_pantos_large_backwards, position_in_consist_from_end ) {
                1:  sw_e8_series_pant1b;
                sw_e8_series_pant2b;				
            }
        switch (FEAT_TRAINS, SELF, sw_e8_series_backwards_length_large, (position_in_consist == 1) || (position_in_consist_from_end == 1 )) {				
                1:  sw_e8_series_pantos_large_backwards;
                sw_e8_series_coachb;			
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_e8_series_backwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_e8_series_coachb;
                sw_e8_series_pant1b;				
            }
	switch (FEAT_TRAINS, SELF, sw_e8_series_backwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_e8_series_backwards_length_large;
			sw_e8_series_backwards_length_small;				
		}
	// Forwards
        // Penultipantos
        switch (FEAT_TRAINS, SELF, sw_e8_series_pantos_large_forwards, position_in_consist ) {				
                1:  sw_e8_series_pant1f;
                sw_e8_series_pant2f;				
            }

        switch (FEAT_TRAINS, SELF, sw_e8_series_forwards_length_large, (position_in_consist == 1) || (position_in_consist_from_end == 1 )) {				
                1:  sw_e8_series_pantos_large_forwards;
                sw_e8_series_coachf;		
            }
        // Panto in Middle
        switch (FEAT_TRAINS, SELF, sw_e8_series_forwards_length_small, (position_in_consist == position_in_consist_from_end ) || (position_in_consist - 1 == position_in_consist_from_end) ) {				
                0:  sw_e8_series_coachf;
                sw_e8_series_pant1f;				
            }
	switch (FEAT_TRAINS, SELF, sw_e8_series_forwards_length, num_vehs_in_consist < 7 ) {				
			0:  sw_e8_series_forwards_length_large;
			sw_e8_series_forwards_length_small;				
		}

	switch (FEAT_TRAINS, PARENT, sw_e8_series_midcars, vehicle_is_reversed) {				
			0:  sw_e8_series_forwards_length;
			sw_e8_series_backwards_length;				
		}

/* Cab selection */
    // Rear cab
    switch (FEAT_TRAINS, PARENT, sw_e8_series_rear, vehicle_is_reversed) {				
            1:  sw_e8_series_cab01b;                   // cab01	
            sw_e8_series_cab02f;                       // cab02
        }

    // Lead cab
    switch (FEAT_TRAINS, PARENT, sw_e8_series_lead, vehicle_is_reversed) {				
            1:  sw_e8_series_cab02b;                   // cab02
            sw_e8_series_cab01f;                       // cab01	
        }

/* Find the cabs */
    switch (FEAT_TRAINS, SELF, sw_e8_series_lead_or_rear, position_in_consist) {				
            0:  sw_e8_series_lead;
            sw_e8_series_rear;				
        }
    
    switch (FEAT_TRAINS, SELF, sw_e8_series_graphics, position_in_consist == 0 || position_in_consist_from_end == 0 ) {				
            1:  sw_e8_series_lead_or_rear;
            sw_e8_series_midcars;				
        }
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "src/trains/e8_series/e8_series_item.pnml" 1


switch(FEAT_TRAINS, SELF, sw_e8_series_attach_vehid, [vehicle_type_id == series_e8 || vehicle_type_id == mu_car_ms]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e8) {
    property {
        name:                           string(STR_NAME_E8_SERIES);
        introduction_date:              date(2024,01,01);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          300 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        //dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e8_series_graphics;
	      purchase:                       sw_e8_series_purchase;
		    additional_text:	              return string(STR_DESC_E8_SERIES);
        cargo_subtype_text:             sw_e8_series_subtype_text;
        cargo_age_period:				        param_decay_express;
        can_attach_wagon:			          sw_e8_series_attach_vehid;
        //start_stop:                   ;
        purchase_weight:                42 / 2;
        purchase_power:                 400 * 4;
        /* Stats */
        power:                          max (num_vehs_in_consist - 2 , 0 ) * 400 * 4;
        weight:                         42 * num_vehs_in_consist;
        cargo_capacity:                 48 * CapacityFactor();										        // 338 capacity / 7 cars  is approx 48						
		    loading_speed:					        48 * CapacityFactor() / param_loading_1D;					// Capacity divided by door loading factor
        running_cost_factor:            (445 + 130 * num_vehs_in_consist ) * RunningCostFactor();
        purchase_running_cost_factor:   (445 + 130) / 2; 	
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e8_series_graphics;
        cargo_capacity:                 48 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  48 * CapacityFactor() / param_loading_1D;
        //cargo_subtype_text:             sw_e8_series_subtypetext_mucar;
        //power:                        // Apply power in graphics block to calculate power based on number of motorised cars correctly
        //weight:                         42;
        //running_cost_factor:            120;
      }
}
# 1 "src/trains/e8_series/e8_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e10_series/e10_series.pnml" 1

# 1 "src/trains/e10_series/e10_series_menu.pnml" 1

/* SUBTYPES */ 
	switch(FEAT_TRAINS, SELF, sw_e10_series_subtype_text, cargo_subtype) {
		0: return string(LV_E10_SERIES);
		1: return string(LV_E10_SERIES_2CC);
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e10_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e10_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e10_series_buy;
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_cab01.pnml" 1

/* cab01 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e10_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e10_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e10_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e10_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e10_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e10_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e10_series_cab01f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e10_series_cab01b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_rev(1,51)}


	// 2cc Mask

	// 10/8
	spriteset(ss_std_e10_series_cab01f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_std(1,1)}
	spriteset(ss_std_e10_series_cab01b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_rev(1,51)}

	// Front
	spriteset(ss_frt_e10_series_cab01f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_std(1,1)}
	spriteset(ss_frt_e10_series_cab01b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_rev(1,51)}
	// Mid
	spriteset(ss_mid_e10_series_cab01f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_std(1,1)}
	spriteset(ss_mid_e10_series_cab01b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_rev(1,51)}
	// Back
	spriteset(ss_bck_e10_series_cab01f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_std(1,1)}
	spriteset(ss_bck_e10_series_cab01b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_rev(1,51)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_cab01f_mask, cargo_subtype) {1:ss_frt_e10_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_cab01f_irl;       	    // Base for Front
				1: ss_frt_e10_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01f_frt_longsprite, NextPartSame() ) { 1: sw_e10_series_cab01f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_cab01f_mask, cargo_subtype) {1:ss_mid_e10_series_cab01f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab01f_irl, HideLongSprite() ) { 0: ss_std_e10_series_cab01f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_cab01f_mask, cargo_subtype) {1:ss_std_e10_series_cab01f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab01f_mask, HideLongSprite() ) { 0: sw_std_e10_series_cab01f_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_cab01f_irl;       	    // Base for Mid
                1: ss_mid_e10_series_cab01f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_cab01f_irl;	    // Base for LongSprite
				3: longsprite_e10_series_cab01f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_cab01f_mask, cargo_subtype) {1:ss_bck_e10_series_cab01f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_cab01f_irl;       	    // Base for Front
				1: ss_bck_e10_series_cab01f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01f_bck_longsprite, PrevPartSame() ) { 1: sw_e10_series_cab01f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_cab01f, position_in_consist % 3 ) {				
            0: sw_e10_series_cab01f_frt_longsprite;
            1: sw_e10_series_cab01f_mid_stack;
            2: sw_e10_series_cab01f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_cab01b_mask, cargo_subtype) {1:ss_frt_e10_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_cab01b_irl;       	    // Base for Front
				1: ss_frt_e10_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01b_frt_longsprite, PrevPartSame() ) { 1: sw_e10_series_cab01b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_cab01b_mask, cargo_subtype) {1:ss_mid_e10_series_cab01b_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab01b_irl, HideLongSprite() ) { 0: ss_std_e10_series_cab01b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_cab01b_mask, cargo_subtype) {1:ss_std_e10_series_cab01b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab01b_mask, HideLongSprite() ) { 0: sw_std_e10_series_cab01b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_cab01b_irl;       	    // Base for Mid
                1: ss_mid_e10_series_cab01b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_cab01b_irl;	    // Base for LongSprite
				3: longsprite_e10_series_cab01b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_cab01b_mask, cargo_subtype) {1:ss_bck_e10_series_cab01b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_cab01b_irl;       	    // Base for Front
				1: ss_bck_e10_series_cab01b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab01b_bck_longsprite, NextPartSame() ) { 1: sw_e10_series_cab01b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_cab01b, position_in_consist_from_end % 3 ) {				
            0: sw_e10_series_cab01b_frt_longsprite;
            1: sw_e10_series_cab01b_mid_stack;
            2: sw_e10_series_cab01b_bck_longsprite;
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_cab02.pnml" 1

/* cab02 */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e10_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e10_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e10_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e10_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e10_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e10_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e10_series_cab02f_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e10_series_cab02b_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_cab_bck_rev(1,1)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e10_series_cab02f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_cab_std(1,51)}
	spriteset(ss_std_e10_series_cab02b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_cab_rev(1,1)}

	// Front
	spriteset(ss_frt_e10_series_cab02f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_frt_std(1,51)}
	spriteset(ss_frt_e10_series_cab02b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_frt_rev(1,1)}
	// Mid
	spriteset(ss_mid_e10_series_cab02f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_mid_std(1,51)}
	spriteset(ss_mid_e10_series_cab02b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_mid_rev(1,1)}
	// Back
	spriteset(ss_bck_e10_series_cab02f_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_bck_std(1,51)}
	spriteset(ss_bck_e10_series_cab02b_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_cab_bck_rev(1,1)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_cab02f_mask, cargo_subtype) {1:ss_frt_e10_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02f_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_cab02f_irl;       	    // Base for Front
				1: ss_frt_e10_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02f_frt_longsprite, PrevPartSame() ) { 1: sw_e10_series_cab02f_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_cab02f_mask, cargo_subtype) {1:ss_mid_e10_series_cab02f_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab02f_irl, HideLongSprite() ) { 0: ss_std_e10_series_cab02f_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_cab02f_mask, cargo_subtype) {1:ss_std_e10_series_cab02f_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab02f_mask, HideLongSprite() ) { 0: sw_std_e10_series_cab02f_mask; }     
           
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02f_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_cab02f_irl;       	    // Base for Mid
                1: ss_mid_e10_series_cab02f_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_cab02f_irl;	    // Base for LongSprite
				3: longsprite_e10_series_cab02f_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_cab02f_mask, cargo_subtype) {1:ss_bck_e10_series_cab02f_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02f_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_cab02f_irl;       	    // Base for Front
				1: ss_bck_e10_series_cab02f_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02f_bck_longsprite, NextPartSame() ) { 1: sw_e10_series_cab02f_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_cab02f, position_in_consist_from_end % 3 ) {				
            0: sw_e10_series_cab02f_frt_longsprite;
            1: sw_e10_series_cab02f_mid_stack;
            2: sw_e10_series_cab02f_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_cab02b_mask, cargo_subtype) {1:ss_frt_e10_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02b_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_cab02b_irl;       	    // Base for Front
				1: ss_frt_e10_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02b_frt_longsprite, NextPartSame() ) { 1: sw_e10_series_cab02b_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_cab02b_mask, cargo_subtype) {1:ss_mid_e10_series_cab02b_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab02b_irl, HideLongSprite() ) { 0: ss_std_e10_series_cab02b_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_cab02b_mask, cargo_subtype) {1:ss_std_e10_series_cab02b_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_cab02b_mask, HideLongSprite() ) { 0: sw_std_e10_series_cab02b_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02b_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_cab02b_irl;       	    // Base for Mid
                1: ss_mid_e10_series_cab02b_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_cab02b_irl;	    // Base for LongSprite
				3: longsprite_e10_series_cab02b_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_cab02b_mask, cargo_subtype) {1:ss_bck_e10_series_cab02b_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02b_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_cab02b_irl;       	    // Base for Front
				1: ss_bck_e10_series_cab02b_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_cab02b_bck_longsprite, PrevPartSame() ) { 1: sw_e10_series_cab02b_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_cab02b, position_in_consist % 3 ) {				
            0: sw_e10_series_cab02b_frt_longsprite;
            1: sw_e10_series_cab02b_mid_stack;
            2: sw_e10_series_cab02b_bck_longsprite;
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_coach.pnml" 1

/* coach */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e10_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e10_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e10_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e10_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e10_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e10_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e10_series_coachf_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e10_series_coachb_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_rev(1,101)}

	// 2cc Mask

	// 10/8
	spriteset(ss_std_e10_series_coachf_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e10_series_coachb_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e10_series_coachf_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e10_series_coachb_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e10_series_coachf_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e10_series_coachb_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e10_series_coachf_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e10_series_coachb_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_coachf_mask, cargo_subtype) {1:ss_frt_e10_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachf_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_coachf_irl;       	    // Base for Front
				1: ss_frt_e10_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_coachf_frt_longsprite, NextPartSame() ) { 1: sw_e10_series_coachf_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_coachf_mask, cargo_subtype) {1:ss_mid_e10_series_coachf_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_coachf_irl, HideLongSprite() ) { 0: ss_std_e10_series_coachf_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_coachf_mask, cargo_subtype) {1:ss_std_e10_series_coachf_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_coachf_mask, HideLongSprite() ) { 0: sw_std_e10_series_coachf_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachf_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_coachf_irl;       	    // Base for Mid
                1: ss_mid_e10_series_coachf_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_coachf_irl;	    // Base for LongSprite
				3: longsprite_e10_series_coachf_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_coachf_mask, cargo_subtype) {1:ss_bck_e10_series_coachf_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachf_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_coachf_irl;       	    // Base for Front
				1: ss_bck_e10_series_coachf_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_coachf_bck_longsprite, PrevPartSame() ) { 1: sw_e10_series_coachf_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_coachf, position_in_consist % 3 ) {				
            0: sw_e10_series_coachf_frt_longsprite;
            1: sw_e10_series_coachf_mid_stack;
            2: sw_e10_series_coachf_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_coachb_mask, cargo_subtype) {1:ss_frt_e10_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachb_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_coachb_irl;       	    // Base for Front
				1: ss_frt_e10_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_coachb_frt_longsprite, PrevPartSame() ) { 1: sw_e10_series_coachb_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_coachb_mask, cargo_subtype) {1:ss_mid_e10_series_coachb_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_coachb_irl, HideLongSprite() ) { 0: ss_std_e10_series_coachb_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_coachb_mask, cargo_subtype) {1:ss_std_e10_series_coachb_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_coachb_mask, HideLongSprite() ) { 0: sw_std_e10_series_coachb_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachb_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_coachb_irl;       	    // Base for Mid
                1: ss_mid_e10_series_coachb_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_coachb_irl;	    // Base for LongSprite
				3: longsprite_e10_series_coachb_mask;       // Masks for LongSprite
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_coachb_mask, cargo_subtype) {1:ss_bck_e10_series_coachb_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_coachb_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_coachb_irl;       	    // Base for Front
				1: ss_bck_e10_series_coachb_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_coachb_bck_longsprite, NextPartSame() ) { 1: sw_e10_series_coachb_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_coachb, position_in_consist_from_end % 3 ) {				
            0: sw_e10_series_coachb_frt_longsprite;
            1: sw_e10_series_coachb_mid_stack;
            2: sw_e10_series_coachb_bck_longsprite;
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_panto.pnml" 1

/* panto */

// Sprites

	// Base

	// 10/8
	spriteset(ss_std_e10_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e10_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e10_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e10_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e10_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e10_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e10_series_pantof_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e10_series_pantob_irl, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e10_series/gfx/e10_series_irl.png") {tmpl_bck_rev(1,101)}


	// 2cc Mask

	// 10/8
	spriteset(ss_std_e10_series_pantof_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_std(1,101)}
	spriteset(ss_std_e10_series_pantob_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_10_rev(1,101)}

	// Front
	spriteset(ss_frt_e10_series_pantof_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_std(1,101)}
	spriteset(ss_frt_e10_series_pantob_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_frt_rev(1,101)}
	// Mid
	spriteset(ss_mid_e10_series_pantof_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_std(1,101)}
	spriteset(ss_mid_e10_series_pantob_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_mid_rev(1,101)}
	// Back
	spriteset(ss_bck_e10_series_pantof_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_std(1,101)}
	spriteset(ss_bck_e10_series_pantob_2cc, "src/trains/e10_series/gfx/e10_series_2cc.png") {tmpl_bck_rev(1,101)}

// Sprite Selection

	// Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_pantof_mask, cargo_subtype) {1:ss_frt_e10_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantof_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_pantof_irl;       	    // Base for Front
				1: ss_frt_e10_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_pantof_frt_longsprite, NextPartSame() ) { 1: sw_e10_series_pantof_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_pantof_mask, cargo_subtype) {1:ss_mid_e10_series_pantof_2cc; }

        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_pantof_irl, HideLongSprite() ) { 0: ss_std_e10_series_pantof_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_pantof_mask, cargo_subtype) {1:ss_std_e10_series_pantof_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_pantof_mask, HideLongSprite() ) { 0: sw_std_e10_series_pantof_mask; }      
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantof_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_pantof_irl;       	    // Base for Mid
                1: ss_mid_e10_series_pantof_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_pantof_irl;	        // Base for LongSprite
				3: longsprite_e10_series_pantof_mask;        // Masks for LongSprite
                // Pantos
                4: panto_midsprite_e10_f;
                5: panto_longsprite_e10_f;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_pantof_mask, cargo_subtype) {1:ss_bck_e10_series_pantof_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantof_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_pantof_irl;       	    // Base for Front
				1: ss_bck_e10_series_pantof_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_pantof_bck_longsprite, PrevPartSame() ) { 1: sw_e10_series_pantof_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_pantof, position_in_consist % 3 ) {				
            0: sw_e10_series_pantof_frt_longsprite;
            1: sw_e10_series_pantof_mid_stack;
            2: sw_e10_series_pantof_bck_longsprite;
        }

	// Backwards

        // Forwards

		// Front
		switch(FEAT_TRAINS, PARENT, ss_frt_e10_series_pantob_mask, cargo_subtype) {1:ss_frt_e10_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantob_frt_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_frt_e10_series_pantob_irl;       	    // Base for Front
				1: ss_frt_e10_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_pantob_frt_longsprite, PrevPartSame() ) { 1: sw_e10_series_pantob_frt_stack; dummy_sprites; }

		/* MID */

        // Mid Parts
            switch(FEAT_TRAINS, PARENT, ss_mid_e10_series_pantob_mask, cargo_subtype) {1:ss_mid_e10_series_pantob_2cc; }


        // Mid LongSprite
            // Base
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_pantob_irl, HideLongSprite() ) { 0: ss_std_e10_series_pantob_irl; }
            // Masks
                switch(FEAT_TRAINS, PARENT, sw_std_e10_series_pantob_mask, cargo_subtype) {1:ss_std_e10_series_pantob_2cc; }
                switch(FEAT_TRAINS, SELF, longsprite_e10_series_pantob_mask, HideLongSprite() ) { 0: sw_std_e10_series_pantob_mask; }     
            
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantob_mid_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				// Parts
                0: ss_mid_e10_series_pantob_irl;       	    // Base for Mid
                1: ss_mid_e10_series_pantob_mask;		    // Masks for Mid
                // Long Sprite
				2: longsprite_e10_series_pantob_irl;	        // Base for LongSprite
				3: longsprite_e10_series_pantob_mask;       // Masks for LongSprite
                // Pantos
                4: panto_midsprite_e10_b;
                5: panto_longsprite_e10_b;
			}

		// Back
		switch(FEAT_TRAINS, PARENT, ss_bck_e10_series_pantob_mask, cargo_subtype) {1:ss_bck_e10_series_pantob_2cc; }
		
		switch(FEAT_TRAINS, SELF, sw_e10_series_pantob_bck_stack, [ 
			STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
				0: ss_bck_e10_series_pantob_irl;       	    // Base for Front
				1: ss_bck_e10_series_pantob_mask;		    // Masks for Front
			}

		switch(FEAT_TRAINS, SELF, sw_e10_series_pantob_bck_longsprite, NextPartSame() ) { 1: sw_e10_series_pantob_bck_stack; dummy_sprites; }

		switch (FEAT_TRAINS, SELF, sw_e10_series_pantob, position_in_consist_from_end % 3 ) {				
            0: sw_e10_series_pantob_frt_longsprite;
            1: sw_e10_series_pantob_mid_stack;
            2: sw_e10_series_pantob_bck_longsprite;
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_formations.pnml" 1

 /* Panto in middle */

    switch (FEAT_TRAINS, SELF, sw_e10_series_forwards_panto_in_middle, CarNumberFromEnd() - CarNumber() ) {				
            0..1:  sw_e10_series_pantof;
            sw_e10_series_coachf;  				
        }

    switch (FEAT_TRAINS, SELF, sw_e10_series_backwards_panto_in_middle, CarNumber() - CarNumberFromEnd() ) {				
            0..1:  sw_e10_series_pantob;
            sw_e10_series_coachb;  				
        }       

 /* Long */

    switch (FEAT_TRAINS, SELF, sw_e10_series_forwards_length_large, CarNumber() == 3 || CarNumberFromEnd()  == 4 ) {				
			1:  sw_e10_series_pantof; 
            sw_e10_series_coachf;					
		}       

    switch (FEAT_TRAINS, SELF, sw_e10_series_backwards_length_large, CarNumberFromEnd() == 3 || CarNumber()  == 4 ) {				
			1:  sw_e10_series_pantob; 
            sw_e10_series_coachb;					
		}    
    
/* Direction & Length Checks */    
    
    switch (FEAT_TRAINS, SELF, sw_e10_series_backwards_length, NumberCarsInConsist()  < 10 ) {				
			0:  sw_e10_series_backwards_length_large;
			sw_e10_series_backwards_panto_in_middle;				
		}
    
    switch (FEAT_TRAINS, SELF, sw_e10_series_forwards_length, NumberCarsInConsist()  < 10 ) {				
			0:  sw_e10_series_forwards_length_large;
			sw_e10_series_forwards_panto_in_middle;				
		}

	switch (FEAT_TRAINS, PARENT, sw_e10_series_midcars, vehicle_is_reversed) {				
			0:  sw_e10_series_forwards_length;
			sw_e10_series_backwards_length;				
		}

/* Cab selection */

/* Find the cabs */

    switch (FEAT_TRAINS, PARENT, sw_e10_series_rear, vehicle_is_reversed) {				
            1: sw_e10_series_cab01b;
            sw_e10_series_cab02f;
        }

    switch (FEAT_TRAINS, PARENT, sw_e10_series_lead, vehicle_is_reversed) {				
            1: sw_e10_series_cab02b;
            sw_e10_series_cab01f;
        }

    switch (FEAT_TRAINS, SELF, sw_e10_series_cabs, position_in_consist) {				
            0..2: sw_e10_series_lead;
            sw_e10_series_rear;
        }
    
    switch (FEAT_TRAINS, SELF, sw_e10_series_graphics, IsCab() ) {				
            1:  sw_e10_series_cabs;
            sw_e10_series_midcars;	
        }
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "src/trains/e10_series/e10_series_item.pnml" 1

/*---Articulation---*/
	switch (FEAT_TRAINS, SELF, sw_e10_series_articulated_part, extra_callback_info1) {
			1 .. 2: return series_e10;									
			return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
		}


item(FEAT_TRAINS, series_e10) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E10_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_2CC, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2027,01,01); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          321 km/h;					// Operational Top Speed
		power:                          1290 hp;					// Overwritten by callback
		weight:                         45;
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_E10_SERIES);
		cargo_subtype_text:             sw_e10_series_subtype_text;
		can_attach_wagon:				sw_attach_mu_car_full;
		start_stop:						sw_stop_start_full_length_4;
		purchase_weight:                45;
        purchase_power:                 402 * 4;
		/* Graphics */
		default:                        sw_e10_series_graphics;
		purchase:                       sw_e10_series_purchase;
		articulated_part:               sw_e10_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_1_8_1;
		power:							max ((NumberCarsInConsist() - 2 ),0) * 402 * 4 ;
		weight:							NumberCarsInConsist() * 45;
		cargo_capacity:                 25 * CapacityFactor();										// 731 capacity / (10 cars * 3 parts) is approx 25						
		loading_speed:					25 * CapacityFactor() / param_loading_2D;					// Capacity divided by door loading factor
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            (298 + 127 * NumberCarsInConsist() ) * RunningCostFactor();
		purchase_running_cost_factor:   298 + 127 * NumberCarsInConsist();	
	}

	/*Multiple Unit Car*/
	
      livery_override(mu_car_full){
        default:                        sw_e10_series_graphics;
        cargo_capacity:                 25 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  25 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e10_series_running_costs;
      }
}
# 1 "src/trains/e10_series/e10_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

/*---COUPLED TRAINS---*/
# 1 "src/trains/e5e3_series/e5e3_series.pnml" 1

# 1 "src/trains/e5e3_series/e5e3_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e5e3_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_E5_SERIES_E5),string(AND),string(LV_E3_SERIES_R));
		1: return string(STR_CONCAT_3, string(LV_E5_SERIES_H5),string(AND),string(LV_E3_SERIES_R));
        2: return string(STR_CONCAT_3, string(LV_E5_SERIES_2CC),string(AND),string(LV_E3_SERIES_R_2CC));
        3: return string(STR_CONCAT_3, string(LV_E5_SERIES_E5),string(AND),string(LV_E3_SERIES_1000));
		4: return string(STR_CONCAT_3, string(LV_E5_SERIES_H5),string(AND),string(LV_E3_SERIES_1000));
        5: return string(STR_CONCAT_3, string(LV_E5_SERIES_2CC),string(AND),string(LV_E3_SERIES_1000_2CC));
        6: return string(STR_CONCAT_3, string(LV_E5_SERIES_E5),string(AND),string(LV_E3_SERIES_2000));
		7: return string(STR_CONCAT_3, string(LV_E5_SERIES_H5),string(AND),string(LV_E3_SERIES_2000));
        8: return string(STR_CONCAT_3, string(LV_E5_SERIES_2CC),string(AND),string(LV_E3_SERIES_2000_2CC));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e5e3_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5e3_series/gfx/e5e3_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e5e3_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e5e3_series_buy;
        }
# 1 "src/trains/e5e3_series/e5e3_series.pnml" 2
# 1 "src/trains/e5e3_series/e5e3_series_formations.pnml" 1

switch (FEAT_TRAINS, PARENT, sw_e3_series_e5e3_clogocheck, cargo_subtype ) {				
        0..2: sw_e3_series_clog2f;
        sw_e3_series_clogof;
	}

switch (FEAT_TRAINS, SELF, sw_e5e3_series_graphics, position_in_consist ) {				
		// E5
        0..2:   sw_e5_series_cab01f;
        3..5:   sw_e5_series_coachf;
        6..8:   sw_e5_series_pantof;
        9..11:  sw_e5_series_coachf;
        12..14: sw_e5_series_coachf;
        15..17: sw_e5_series_coachf;
        18..20: sw_e5_series_pantof;
        21..23: sw_e5_series_coachf;
        24..26: sw_e5_series_coachf;
        27:     sw_e5_series_cab02f_bck_longsprite;
        28:     sw_e5_series_cab02f_mid_stack;
        29:     sw_e5_series_cab02f_frt_longsprite;
        // E3
        30: sw_e3_series_cab01f;
        31: sw_e3_series_e5e3_clogocheck;
        32: sw_e3_series_coachf;
        33: sw_e3_series_pantof;
        34: sw_e3_series_coraif;
        35: sw_e3_series_pantof;
		36: sw_e3_series_cab02f;
	}

switch (FEAT_TRAINS, SELF, sw_e5e3_series_length, position_in_consist ) {				
		// E5
        0..29: sw_length_1_8_1;
        // E3
        30..36: return 8;
	}
# 1 "src/trains/e5e3_series/e5e3_series.pnml" 2
# 1 "src/trains/e5e3_series/e5e3_series_item.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e5e3_series_articulated_part, extra_callback_info1) {
		1 .. 36: return series_e5e3;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e5e3_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e5e3) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E5_E3_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					2005;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          275 km/h;					// Operational Top Speed
		power:                          (8046 + 12864) hp;			
		weight:                         (453 + 301) tons;			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E5_SERIES),string(AND),string(STR_NAME_E3_SERIES),string(LIVERIES_MENU),string(LENGTH98));
		cargo_subtype_text:             sw_e5e3_series_subtype_text;
		can_attach_wagon:				sw_e5e3_series_irl_attach_vehid;
		//start_stop:						sw_e5e3_series_stop_start;
		/* Graphics */
		default:                        sw_e5e3_series_graphics;
		purchase:                       sw_e5e3_series_purchase;
		articulated_part:               sw_e5e3_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e5e3_series_length;
		cargo_capacity:                 (731 + 402)/36 * CapacityFactor();
		loading_speed:					15 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((298 + 127 * 10 ) + (445 + 120 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (298 + 127 * 10 ) + (445 + 120 * 7 );	
	}
}
# 1 "src/trains/e5e3_series/e5e3_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e5e6_series/e5e6_series.pnml" 1

# 1 "src/trains/e5e6_series/e5e6_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e5e6_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_E5_SERIES_E5),string(AND),string(LV_E6_SERIES_ORIGINAL));
		1: return string(STR_CONCAT_3, string(LV_E5_SERIES_H5),string(AND),string(LV_E6_SERIES_ORIGINAL));
        2: return string(STR_CONCAT_3, string(LV_E5_SERIES_2CC),string(AND),string(LV_E6_SERIES_2CC));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e5e6_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5e6_series/gfx/e5e6_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e5e6_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e5e6_series_buy;
        }
# 1 "src/trains/e5e6_series/e5e6_series.pnml" 2
# 1 "src/trains/e5e6_series/e5e6_series_formations.pnml" 1


switch (FEAT_TRAINS, SELF, sw_e5e6_series_graphics, position_in_consist ) {				
		// E5
        0..2:   sw_e5_series_cab01f;
        3..5:   sw_e5_series_coachf;
        6..8:   sw_e5_series_pantof;
        9..11:  sw_e5_series_coachf;
        12..14: sw_e5_series_coachf;
        15..17: sw_e5_series_coachf;
        18..20: sw_e5_series_pantof;
        21..23: sw_e5_series_coachf;
        24..26: sw_e5_series_coachf;
        27:     sw_e5_series_cab02f_bck_longsprite;
        28:     sw_e5_series_cab02f_mid_stack;
        29:     sw_e5_series_cab02f_frt_longsprite;
        // E6
        30: sw_e6_series_cab01f;
        31: sw_e6_series_pant1f;
        32: sw_e6_series_coachf;
        33: sw_e6_series_coachf;
        34: sw_e6_series_coachf;
        35: sw_e6_series_pant2f;
		36: sw_e6_series_cab02f;

	}

switch (FEAT_TRAINS, SELF, sw_e5e6_series_length, position_in_consist ) {				
		// E5
        0..29: sw_length_1_8_1;
        // E6
        30..36: return 8;
	}
# 1 "src/trains/e5e6_series/e5e6_series.pnml" 2
# 1 "src/trains/e5e6_series/e5e6_series_item.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e5e6_series_articulated_part, extra_callback_info1) {
		1 .. 36: return series_e5e6;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e5e6_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e5e6) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E5_E6_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					2005;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2013,03,16); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 731 + 338;
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          321 km/h;					// Operational Top Speed
		power:                          (8064 + 12864) hp;			// Agreed to https://en.wikipedia.org/wiki/E5_and_H5_Series_Shinkansen
		weight:                         (453 + 306) tons;					// Agreed to https://en.wikipedia.org/wiki/E5_and_H5_Series_Shinkansen
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E5_SERIES),string(AND),string(STR_NAME_E6_SERIES),string(LIVERIES_MENU),string(LENGTH98));
		cargo_subtype_text:             sw_e5e6_series_subtype_text;
		can_attach_wagon:				sw_e5e6_series_irl_attach_vehid;
		//start_stop:						sw_e5e6_series_stop_start;
		/* Graphics */
		default:                        sw_e5e6_series_graphics;
		purchase:                       sw_e5e6_series_purchase;
		articulated_part:               sw_e5e6_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e5e6_series_length;
		cargo_capacity:                 (731 + 338)/36 * CapacityFactor();
		loading_speed:					15 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            (298 + 127 * 17 ) * RunningCostFactor();
		purchase_running_cost_factor:   298 + 127 * 17;	
	}
}
# 1 "src/trains/e5e6_series/e5e6_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e5e8_series/e5e8_series.pnml" 1

# 1 "src/trains/e5e8_series/e5e8_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e5e8_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_E5_SERIES_E5),string(AND),string(LV_E8_SERIES_ORIGINAL));
		1: return string(STR_CONCAT_3, string(LV_E5_SERIES_H5),string(AND),string(LV_E8_SERIES_ORIGINAL));
        2: return string(STR_CONCAT_3, string(LV_E5_SERIES_2CC),string(AND),string(LV_E8_SERIES_2CC));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e5e8_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e5e8_series/gfx/e5e8_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e5e8_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e5e8_series_buy;
        }
# 1 "src/trains/e5e8_series/e5e8_series.pnml" 2
# 1 "src/trains/e5e8_series/e5e8_series_formations.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e5e8_series_graphics, position_in_consist ) {				
		// E5
        0..2:   sw_e5_series_cab01f;
        3..5:   sw_e5_series_coachf;
        6..8:   sw_e5_series_pantof;
        9..11:  sw_e5_series_coachf;
        12..14: sw_e5_series_coachf;
        15..17: sw_e5_series_coachf;
        18..20: sw_e5_series_pantof;
        21..23: sw_e5_series_coachf;
        24..26: sw_e5_series_coachf;
        27:     sw_e5_series_cab02f_bck_longsprite;
        28:     sw_e5_series_cab02f_mid_stack;
        29:     sw_e5_series_cab02f_frt_longsprite;
        // E8
        30: sw_e8_series_cab01f;
        31: sw_e8_series_pant1f;
        32: sw_e8_series_coachf;
        33: sw_e8_series_coachf;
        34: sw_e8_series_coachf;
        35: sw_e8_series_pant2f;
		36: sw_e8_series_cab02f;

	}

switch (FEAT_TRAINS, SELF, sw_e5e8_series_length, position_in_consist ) {				
		// E5
        0..29: sw_length_1_8_1;
        // E6
        30..36: return 8;
	}
# 1 "src/trains/e5e8_series/e5e8_series.pnml" 2
# 1 "src/trains/e5e8_series/e5e8_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_e5e8_series_articulated_part, extra_callback_info1) {
		1 .. 36: return series_e5e8;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e5e8_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e5e8) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E5_E8_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					2005;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2024,01,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          300 km/h;					
		power:                          (12864 + 8064) hp;			
		weight:                         (453 + 294) tons;			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E5_SERIES),string(AND),string(STR_NAME_E8_SERIES),string(LIVERIES_MENU),string(LENGTH98));
		cargo_subtype_text:             sw_e5e8_series_subtype_text;
		can_attach_wagon:				sw_e5e8_series_irl_attach_vehid;
		//start_stop:						sw_e5e8_series_stop_start;
		/* Graphics */
		default:                        sw_e5e8_series_graphics;
		purchase:                       sw_e5e8_series_purchase;
		articulated_part:               sw_e5e8_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e5e8_series_length;
		cargo_capacity:                 (731 + 355)/36 * CapacityFactor();
		loading_speed:					15 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((298 + 127 * 8 ) + (445 + 130 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (298 + 127 * 8 ) + (445 + 130 * 7 );	
	}
    /*
    livery_override(mu_car_full){
        default:                        sw_e5_series_graphics;
        cargo_capacity:                 25 * CapacityFactor();
        cargo_age_period:				param_decay_express;
        loading_speed:                  25 * CapacityFactor() / param_loading_2D;
		articulated_part:				sw_mucar_full_articulated_part;
		length:							sw_length_1_8_1;
		//power:						// Apply power in graphics block to calculate power based on number of motorised cars correctly
		//weight:						// Apply weight to graphics block to calculate Max T.E. correctly
        //running_cost_factor:            sw_e5_series_running_costs;
      }
      */
}
# 1 "src/trains/e5e8_series/e5e8_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

# 1 "src/trains/200&400_series/200&400_series.pnml" 1

# 1 "src/trains/200&400_series/200&400_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_200n400_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL),string(AND),string(LV_400_SERIES_ORIGINAL));
		1: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL_2CC),string(AND),string(LV_400_SERIES_ORIGINAL_2CC));
        2: return string(STR_CONCAT_3, string(LV_200_SERIES_REFURB),string(AND),string(LV_400_SERIES_ORIGINAL));
        3: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL),string(AND),string(LV_400_SERIES_REFURB));
		4: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL_2CC),string(AND),string(LV_400_SERIES_REFURB_2CC));
        5: return string(STR_CONCAT_3, string(LV_200_SERIES_REFURB),string(AND),string(LV_400_SERIES_REFURB));

		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_200n400_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200&400_series/gfx/200&400_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_200n400_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_200n400_series_buy;
        }
# 1 "src/trains/200&400_series/200&400_series.pnml" 2
# 1 "src/trains/200&400_series/200&400_series_formations.pnml" 1


switch (FEAT_TRAINS, SELF, sw_200n400_series_graphics, position_in_consist ) {				
		// 200
        0..2:   sw_200_series_cab01f;
        3..5:   sw_200_series_pantof;
        6..8:   sw_200_series_coachf;
        9..11:  sw_200_series_pantof;
        12..14: sw_200_series_coachf;
        15..17: sw_200_series_pantof;
        18..20: sw_200_series_coachf;
        21..23: sw_200_series_pantof;
        24..26: sw_200_series_coachf;
        27..29: sw_200_series_pantof;
        30..32: sw_200_series_coachf;
        33:     sw_200_series_cab02f_bck_longsprite;
        34:     sw_200_series_cab02f_mid_stack;
        35:     sw_200_series_cab02f_frt_longsprite;
        // 400
        36: sw_400_series_cab01f;
        37: sw_400_series_pantof;
        38: sw_400_series_coachf;
        39: sw_400_series_coachf;
        40: sw_400_series_coachf;
        41: sw_400_series_pantof;
		42: sw_400_series_cab02f;

	}

switch (FEAT_TRAINS, SELF, sw_200n400_series_length, position_in_consist ) {				
		// 200
        0..35: sw_length_1_8_1;
        // 400
        36..42: return 8;
	}
# 1 "src/trains/200&400_series/200&400_series.pnml" 2
# 1 "src/trains/200&400_series/200&400_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_200n400_series_articulated_part, extra_callback_info1) {
		1 .. 42: return series_200400;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_200n400_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_200400) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_400_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					series_200;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1992,07,01); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;						
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;						
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          240 km/h;
		power:                          (14784 + 6768) hp;			
		weight:                         (12*58 + 7*42) tons;			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_200_SERIES),string(AND),string(STR_NAME_400_SERIES),string(LIVERIES_MENU),string(LENGTH110));
		cargo_subtype_text:             sw_200n400_series_subtype_text;
		can_attach_wagon:				sw_200n400_series_irl_attach_vehid;
		//start_stop:						sw_200n400_series_stop_start;
		/* Graphics */
		default:                        sw_200n400_series_graphics;
		purchase:                       sw_200n400_series_purchase;
		articulated_part:               sw_200n400_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_200n400_series_length;
		cargo_capacity:                 31 * CapacityFactor();						// (936 + ~400) / 43 is approx 38
		loading_speed:					31 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((300 + 130 * 12 ) + (445 + 125 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (300 + 130 * 12 ) + (445 + 125 * 7 );	
	}
}
# 1 "src/trains/200&400_series/200&400_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/200e3_series/200e3_series.pnml" 1

# 1 "src/trains/200e3_series/200e3_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_200e3_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL),string(AND),string(LV_E3_SERIES_R));
		1: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL_2CC),string(AND),string(LV_E3_SERIES_R_2CC));
        2: return string(STR_CONCAT_3, string(LV_200_SERIES_REFURB),string(AND),string(LV_E3_SERIES_R));
        3: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL),string(AND),string(LV_E3_SERIES_1000));
		4: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL_2CC),string(AND),string(LV_E3_SERIES_1000_2CC));
        5: return string(STR_CONCAT_3, string(LV_200_SERIES_REFURB),string(AND),string(LV_E3_SERIES_1000));
        6: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL),string(AND),string(LV_E3_SERIES_2000));
		7: return string(STR_CONCAT_3, string(LV_200_SERIES_ORIGINAL_2CC),string(AND),string(LV_E3_SERIES_2000_2CC));
        8: return string(STR_CONCAT_3, string(LV_200_SERIES_REFURB),string(AND),string(LV_E3_SERIES_2000));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_200e3_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/200e3_series/gfx/200e3_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_200e3_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_200e3_series_buy;
        }
# 1 "src/trains/200e3_series/200e3_series.pnml" 2
# 1 "src/trains/200e3_series/200e3_series_formations.pnml" 1

switch (FEAT_TRAINS, PARENT, sw_e3_series_200e3_clogocheck, cargo_subtype ) {				
        0..2: sw_e3_series_clog2f;
        sw_e3_series_clogof;
	}

switch (FEAT_TRAINS, SELF, sw_200e3_series_graphics, position_in_consist ) {				
		// 200
        0..2:   sw_200_series_cab01f;
        3..5:   sw_200_series_pantof;
        6..8:   sw_200_series_coachf;
        9..11:  sw_200_series_pantof;
        12..14: sw_200_series_coachf;
        15..17: sw_200_series_pantof;
        18..20: sw_200_series_coachf;
        21..23: sw_200_series_pantof;
        24..26: sw_200_series_coachf;
        27..29: sw_200_series_pantof;
        30..32: sw_200_series_coachf;
        33:     sw_200_series_cab02f_bck_longsprite;
        34:     sw_200_series_cab02f_mid_stack;
        35:     sw_200_series_cab02f_frt_longsprite;
        // E3
        36: sw_e3_series_cab01f;
        37: sw_e3_series_200e3_clogocheck;
        38: sw_e3_series_coachf;
        39: sw_e3_series_pantof;
        40: sw_e3_series_coraif;
        41: sw_e3_series_pantof;
		42: sw_e3_series_cab02f;

	}

switch (FEAT_TRAINS, SELF, sw_200e3_series_length, position_in_consist ) {				
		// 200
        0..35: sw_length_1_8_1;
        // 400
        36..42: return 8;
	}
# 1 "src/trains/200e3_series/200e3_series.pnml" 2
# 1 "src/trains/200e3_series/200e3_series_item.pnml" 1

switch (FEAT_TRAINS, SELF, sw_200e3_series_articulated_part, extra_callback_info1) {
		1 .. 42: return series_200e3;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_200e3_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_200e3) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_E3_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					series_200;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,22); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          240 km/h;				
		power:                          (8064 + 12864) hp;			
		weight:                         (453 + 306) tons;			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_200_SERIES),string(AND),string(STR_NAME_E3_SERIES),string(LIVERIES_MENU),string(LENGTH110));
		cargo_subtype_text:             sw_200e3_series_subtype_text;
		can_attach_wagon:				sw_200e3_series_irl_attach_vehid;
		//start_stop:						sw_200e3_series_stop_start;
		/* Graphics */
		default:                        sw_200e3_series_graphics;
		purchase:                       sw_200e3_series_purchase;
		articulated_part:               sw_200e3_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_200e3_series_length;						
		cargo_capacity:                 31 * CapacityFactor();
		loading_speed:					31 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((300 + 130 * 12 ) + (445 + 120 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (300 + 130 * 12 ) + (445 + 120 * 7 );	
	}
}
# 1 "src/trains/200e3_series/200e3_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

# 1 "src/trains/e4&400_series/e4&400_series.pnml" 1

# 1 "src/trains/e4&400_series/e4&400_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e4n400_series_subtype_text, cargo_subtype) {
		0: return string(STR_CONCAT_3, string(LV_YEAR_DEP_LIVERY),string(AND),string(LV_400_SERIES_ORIGINAL));
		1: return string(STR_CONCAT_3, string(LV_E4_SERIES_YELLOW),string(AND),string(LV_400_SERIES_ORIGINAL));
        2: return string(STR_CONCAT_3, string(LV_E4_SERIES_PINK),string(AND),string(LV_400_SERIES_ORIGINAL));
        3: return string(STR_CONCAT_3, string(LV_E4_SERIES_2CC),string(AND),string(LV_400_SERIES_ORIGINAL_2CC));
        4: return string(STR_CONCAT_3, string(LV_E4_SERIES_YELLOW),string(AND),string(LV_400_SERIES_REFURB));
        5: return string(STR_CONCAT_3, string(LV_E4_SERIES_PINK),string(AND),string(LV_400_SERIES_REFURB));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e4n400_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4&400_series/gfx/e4&400_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e4n400_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e4n400_series_buy;
        }
# 1 "src/trains/e4&400_series/e4&400_series.pnml" 2
# 1 "src/trains/e4&400_series/e4&400_series_formations.pnml" 1


switch (FEAT_TRAINS, SELF, sw_e4n400_series_graphics, position_in_consist ) {				
		// E4
        0..2:   sw_e4_series_cab01f;
        3..5:   sw_e4_series_coachf;
        6..8:   sw_e4_series_coachf;
        9..11:  sw_e4_series_pantof;
        12..14: sw_e4_series_coachf;
        15..17: sw_e4_series_pantof;
        18..20: sw_e4_series_coachf;
        21:     sw_e4_series_cab02f_bck_longsprite;
        22:     sw_e4_series_cab02f_mid_stack;
        23:     sw_e4_series_cab02f_frt_longsprite;
        // 400
        24: sw_400_series_cab01f;
        25: sw_400_series_pantof;
        26: sw_400_series_coachf;
        27: sw_400_series_coachf;
        28: sw_400_series_coachf;
        29: sw_400_series_pantof;
		30: sw_400_series_cab02f;

	}

switch (FEAT_TRAINS, SELF, sw_e4n400_series_length, position_in_consist ) {				
		// E4
        0..23: sw_length_1_8_1;
        // 400
        24..30: return 8;
	}
# 1 "src/trains/e4&400_series/e4&400_series.pnml" 2
# 1 "src/trains/e4&400_series/e4&400_series_item.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e4n400_series_articulated_part, extra_callback_info1) {
		1 .. 30: return series_e4400;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e4n400_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e4400) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E4_400_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					series_e4;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,12,20);
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          240 km/h;					// Operational Top Speed
		power:                          (9012 + 6759) hp;			
		weight:                         (428 + 294) tons;			
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E4_SERIES),string(AND),string(STR_NAME_400_SERIES),string(LIVERIES_MENU),string(LENGTH85));
		cargo_subtype_text:             sw_e4n400_series_subtype_text;
		can_attach_wagon:				sw_e4n400_series_irl_attach_vehid;
		//start_stop:						sw_e4n400_series_stop_start;
		/* Graphics */
		default:                        sw_e4n400_series_graphics;
		purchase:                       sw_e4n400_series_purchase;
		articulated_part:               sw_e4n400_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e4n400_series_length;
		cargo_capacity:                 39 * CapacityFactor();						// (817 + ~400) / 31 is approx 39
		loading_speed:					39 * CapacityFactor() / param_loading_2D;	// (817 + ~400) / 31 is approx 39
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((295 + 120 * 8 ) + (445 + 125 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (295 + 120 * 8 ) + (445 + 125 * 7 );	
	}
}
# 1 "src/trains/e4&400_series/e4&400_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e4e3_series/e4e3_series.pnml" 1

# 1 "src/trains/e4e3_series/e4e3_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e4e3_series_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(STR_CONCAT_3, string(LV_E4_SERIES_YELLOW),string(AND),string(LV_E3_SERIES_R));
		2: return string(STR_CONCAT_3, string(LV_E4_SERIES_PINK),string(AND),string(LV_E3_SERIES_R));
        3: return string(STR_CONCAT_3, string(LV_E4_SERIES_2CC),string(AND),string(LV_E3_SERIES_R));
        4: return string(STR_CONCAT_3, string(LV_E4_SERIES_YELLOW),string(AND),string(LV_E3_SERIES_1000));
		5: return string(STR_CONCAT_3, string(LV_E4_SERIES_PINK),string(AND),string(LV_E3_SERIES_1000));
        6: return string(STR_CONCAT_3, string(LV_E4_SERIES_2CC),string(AND),string(LV_E3_SERIES_1000));
        7: return string(STR_CONCAT_3, string(LV_E4_SERIES_YELLOW),string(AND),string(LV_E3_SERIES_2000));
		8: return string(STR_CONCAT_3, string(LV_E4_SERIES_PINK),string(AND),string(LV_E3_SERIES_2000));
        9: return string(STR_CONCAT_3, string(LV_E4_SERIES_2CC),string(AND),string(LV_E3_SERIES_2000));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e4e3_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e4e3_series/gfx/e4e3_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e4e3_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e4e3_series_buy;
        }
# 1 "src/trains/e4e3_series/e4e3_series.pnml" 2
# 1 "src/trains/e4e3_series/e4e3_series_formations.pnml" 1

switch(FEAT_TRAINS, SELF, sw_e3_series_e4e3_clogocheck_yeardep, build_year) {0..1998:sw_e3_series_clog2f; sw_e3_series_clogof;}

switch (FEAT_TRAINS, PARENT, sw_e3_series_e4e3_clogocheck, cargo_subtype ) {				
        0: sw_e3_series_e4e3_clogocheck_yeardep;     
        1..3: sw_e3_series_clog2f;
        sw_e3_series_clogof;
	}

switch (FEAT_TRAINS, SELF, sw_e4e3_series_graphics, position_in_consist ) {				
		// E4
        0..2:   sw_e4_series_cab01f;
        3..5:   sw_e4_series_coachf;
        6..8:   sw_e4_series_coachf;
        9..11:  sw_e4_series_pantof;
        12..14: sw_e4_series_coachf;
        15..17: sw_e4_series_pantof;
        18..20: sw_e4_series_coachf;
        21:     sw_e4_series_cab02f_bck_longsprite;
        22:     sw_e4_series_cab02f_mid_stack;
        23:     sw_e4_series_cab02f_frt_longsprite;
        // E3
        24: sw_e3_series_cab01f;
        25: sw_e3_series_e4e3_clogocheck;
        26: sw_e3_series_coachf;
        27: sw_e3_series_pantof;
        28: sw_e3_series_coraif;
        29: sw_e3_series_pantof;
		30: sw_e3_series_cab02f;
	}

switch (FEAT_TRAINS, SELF, sw_e4e3_series_length, position_in_consist ) {				
		// E4
        0..23: sw_length_1_8_1;
        // E3
        24..30: return 8;
	}
# 1 "src/trains/e4e3_series/e4e3_series.pnml" 2
# 1 "src/trains/e4e3_series/e4e3_series_item.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e4e3_series_articulated_part, extra_callback_info1) {
		1 .. 30: return series_e4e3;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e4e3_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e4e3) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E4_E3_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					series_e4;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          240 km/h;					// Top speed of E4
		power:                          (8064 + 12864) hp;
		weight:                         (453 + 306) tons;
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E4_SERIES),string(AND),string(STR_NAME_E3_SERIES),string(LIVERIES_MENU),string(LENGTH98));
		cargo_subtype_text:             sw_e4e3_series_subtype_text;
		can_attach_wagon:				sw_e4e3_series_irl_attach_vehid;
		//start_stop:						sw_e4e3_series_stop_start;
		/* Graphics */
		default:                        sw_e4e3_series_graphics;
		purchase:                       sw_e4e3_series_purchase;
		articulated_part:               sw_e4e3_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e4e3_series_length;
		cargo_capacity:                 39 * CapacityFactor();						// (817 + ~400) / 31 is approx 39
		loading_speed:					39 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((295 + 120 * 8 ) + (445 + 120 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (295 + 120 * 8 ) + (445 + 120 * 7 );	
	}
}
# 1 "src/trains/e4e3_series/e4e3_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

# 1 "src/trains/e2e3_series/e2e3_series.pnml" 1

# 1 "src/trains/e2e3_series/e2e3_series_menu.pnml" 1
/* SUBTYPES */	
    
    switch(FEAT_TRAINS, SELF, sw_e2e3_series_subtype_text, cargo_subtype) {
		0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(STR_CONCAT_3, string(LV_E2_SERIES_RED),string(AND),string(LV_E3_SERIES_R));
		2: return string(STR_CONCAT_3, string(LV_E2_SERIES_PINK),string(AND),string(LV_E3_SERIES_R));
        3: return string(STR_CONCAT_3, string(LV_E2_SERIES_200),string(AND),string(LV_E3_SERIES_R));
        4: return string(STR_CONCAT_3, string(LV_E2_SERIES_2CC),string(AND),string(LV_E3_SERIES_R_2CC));
        5: return string(STR_CONCAT_3, string(LV_E2_SERIES_RED),string(AND),string(LV_E3_SERIES_1000));
		6: return string(STR_CONCAT_3, string(LV_E2_SERIES_PINK),string(AND),string(LV_E3_SERIES_1000));
        7: return string(STR_CONCAT_3, string(LV_E2_SERIES_200),string(AND),string(LV_E3_SERIES_1000));
        8: return string(STR_CONCAT_3, string(LV_E2_SERIES_2CC),string(AND),string(LV_E3_SERIES_1000_2CC));
        9: return string(STR_CONCAT_3, string(LV_E2_SERIES_RED),string(AND),string(LV_E3_SERIES_2000));
		10: return string(STR_CONCAT_3, string(LV_E2_SERIES_PINK),string(AND),string(LV_E3_SERIES_2000));
        11: return string(STR_CONCAT_3, string(LV_E2_SERIES_200),string(AND),string(LV_E3_SERIES_2000));
        12: return string(STR_CONCAT_3, string(LV_E2_SERIES_2CC),string(AND),string(LV_E3_SERIES_2000_2CC));
		return CB_RESULT_NO_TEXT;
		}

/* Purchase Menu */
    spriteset (ss_e2e3_series_buy, ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/trains/e2e3_series/gfx/e2e3_series.png") {template_purchase(233, 1)}

    switch(FEAT_TRAINS, SELF, sw_e2e3_series_purchase, [ 
        STORE_TEMP(CB_FLAG_MORE_SPRITES | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8) ]) { 
            0: logo_jreast; 
            1: ss_e2e3_series_buy;
        }
# 1 "src/trains/e2e3_series/e2e3_series.pnml" 2
# 1 "src/trains/e2e3_series/e2e3_series_formations.pnml" 1


switch (FEAT_TRAINS, PARENT, sw_e3_series_e2e3_clogocheck, cargo_subtype ) {				
        1..4: sw_e3_series_clog2f;
        sw_e3_series_clogof;
	}

switch (FEAT_TRAINS, SELF, sw_e2e3_series_graphics, position_in_consist ) {				
		// E2
        0..2:   sw_e2_series_cab01f;
        3..5:   sw_e2_series_coac2f;
        6..8:   sw_e2_series_coac2f;
        9..11:  sw_e2_series_pantof;
        12..14: sw_e2_series_coac2f;
        15..17: sw_e2_series_pantof;
        18..20: sw_e2_series_coac2f;
        21:     sw_e2_series_cab02f_bck_longsprite;
        22:     sw_e2_series_cab02f_mid_stack;
        23:     sw_e2_series_cab02f_frt_longsprite;
        // E3
        24: sw_e3_series_cab01f;
        25: sw_e3_series_e2e3_clogocheck;
        26: sw_e3_series_coachf;
        27: sw_e3_series_pantof;
        28: sw_e3_series_coraif;
        29: sw_e3_series_pantof;
		30: sw_e3_series_cab02f;
	}

switch (FEAT_TRAINS, SELF, sw_e2e3_series_length, position_in_consist ) {				
		// e2
        0..23: sw_length_1_8_1;
        // E6
        24..30: return 8;
	}
# 1 "src/trains/e2e3_series/e2e3_series.pnml" 2
# 1 "src/trains/e2e3_series/e2e3_series_item.pnml" 1



switch (FEAT_TRAINS, SELF, sw_e2e3_series_articulated_part, extra_callback_info1) {
		1 .. 30: return series_e2e3;									
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e2e3_series_irl_attach_vehid, [vehicle_type_id == series_test_700]) {
 		0: return string(COUPLE_CANT_JOIN);
	}
    
item(FEAT_TRAINS, series_e2e3) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E2_E3_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		variant_group:					1552;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          275 km/h;					
		power:                          (12874 + 8046) hp;			
		weight:                         (453 + 306) tons;					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_CONCAT_3, string(DESC_STD),string(JR_EAST),string(STR_NAME_E2_SERIES),string(AND),string(STR_NAME_E3_SERIES),string(LIVERIES_MENU),string(LENGTH85));
		cargo_subtype_text:             sw_e2e3_series_subtype_text;
		can_attach_wagon:				sw_e2e3_series_irl_attach_vehid;
		//start_stop:						sw_e2e3_series_stop_start;
		/* Graphics */
		default:                        sw_e2e3_series_graphics;
		purchase:                       sw_e2e3_series_purchase;
		articulated_part:               sw_e2e3_series_articulated_part;	
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_e2e3_series_length;
		cargo_capacity:                 33 * CapacityFactor();
		loading_speed:					33 * CapacityFactor() / param_loading_2D;
		cargo_age_period:				param_decay_express;
		cost_factor:                    144;
		running_cost_factor:            ((290 + 120 * 8 ) + (445 + 120 * 7 )) * RunningCostFactor();
		purchase_running_cost_factor:   (290 + 120 * 8 ) + (445 + 120 * 7 );	
	}
}
# 1 "src/trains/e2e3_series/e2e3_series.pnml" 2
# 1 "JPplusShinkansen.pnml" 4

// GRF OVERRIDES
//#include "src/grfoverrides.pnml"
